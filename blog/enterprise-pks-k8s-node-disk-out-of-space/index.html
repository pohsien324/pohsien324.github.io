<!DOCTYPE html>













<html lang="en"
  
>

  <!--
  The Head
-->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  
  <meta name="keywords" content="PKS, Kubernetes, Enterprise PK, disk, out of space">
  
  <!-- Allow having a localized datetime different from the appearance language -->
  

  

    

    

  

  

  

  
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="針對Enterprise PKS環境的K8s Cluster Node硬碟空間不足測試及解法" />
<meta property="og:locale" content="en" />
<meta name="description" content="PKS,kubernetes,Enterprise PKS,disk,out of space" />
<meta property="og:description" content="PKS,kubernetes,Enterprise PKS,disk,out of space" />
<link rel="canonical" href="http://0.0.0.0:4000/blog/enterprise-pks-k8s-node-disk-out-of-space/" />
<meta property="og:url" content="http://0.0.0.0:4000/blog/enterprise-pks-k8s-node-disk-out-of-space/" />
<meta property="og:site_name" content="Po-Hsien Workspace" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-07-02T21:22:24+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="針對Enterprise PKS環境的K8s Cluster Node硬碟空間不足測試及解法" />
<meta name="twitter:site" content="@twitter_username" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2019-07-02T21:22:24+00:00","datePublished":"2019-07-02T21:22:24+00:00","description":"PKS,kubernetes,Enterprise PKS,disk,out of space","headline":"針對Enterprise PKS環境的K8s Cluster Node硬碟空間不足測試及解法","mainEntityOfPage":{"@type":"WebPage","@id":"http://0.0.0.0:4000/blog/enterprise-pks-k8s-node-disk-out-of-space/"},"url":"http://0.0.0.0:4000/blog/enterprise-pks-k8s-node-disk-out-of-space/"}</script>
<!-- End Jekyll SEO tag -->

  

  <title>針對Enterprise PKS環境的K8s Cluster Node硬碟空間不足測試及解法 | Po-Hsien Workspace
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Po-Hsien Workspace">
<meta name="application-name" content="Po-Hsien Workspace">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  

    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin>
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
    

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  

  <!-- GA -->
  

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css">

  <link rel="stylesheet" href="/assets/css/style.css">

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css">
  

  
    <!-- Manific Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css">
  

  <!-- JavaScript -->

  <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>

  
    <!--
  Switch the mode between dark and light.
-->

<script type="text/javascript">
  class ModeToggle {
    static get MODE_KEY() { return "mode"; }
    static get MODE_ATTR() { return "data-mode"; }
    static get DARK_MODE() { return "dark"; }
    static get LIGHT_MODE() { return "light"; }
    static get ID() { return "mode-toggle"; }

    constructor() {
      if (this.hasMode) {
        if (this.isDarkMode) {
          if (!this.isSysDarkPrefer) {
            this.setDark();
          }
        } else {
          if (this.isSysDarkPrefer) {
            this.setLight();
          }
        }
      }

      let self = this;

      /* always follow the system prefers */
      this.sysDarkPrefers.addEventListener("change", () => {
        if (self.hasMode) {
          if (self.isDarkMode) {
            if (!self.isSysDarkPrefer) {
              self.setDark();
            }

          } else {
            if (self.isSysDarkPrefer) {
              self.setLight();
            }
          }

          self.clearMode();
        }

        self.notify();

      });

    } /* constructor() */

    get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); }

    get isSysDarkPrefer() { return this.sysDarkPrefers.matches; }

    get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; }

    get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; }

    get hasMode() { return this.mode != null; }

    get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); }

    /* get the current mode on screen */
    get modeStatus() {
      if (this.isDarkMode
        || (!this.hasMode && this.isSysDarkPrefer)) {
        return ModeToggle.DARK_MODE;
      } else {
        return ModeToggle.LIGHT_MODE;
      }
    }

    setDark() {
      $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
    }

    setLight() {
      $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
    }

    clearMode() {
      $('html').removeAttr(ModeToggle.MODE_ATTR);
      sessionStorage.removeItem(ModeToggle.MODE_KEY);
    }

    /* Notify another plugins that the theme mode has changed */
    notify() {
      window.postMessage({
        direction: ModeToggle.ID,
        message: this.modeStatus
      }, "*");
    }

  } /* ModeToggle */

  const toggle = new ModeToggle();

  function flipMode() {
    if (toggle.hasMode) {
      if (toggle.isSysDarkPrefer) {
        if (toggle.isLightMode) {
          toggle.clearMode();
        } else {
          toggle.setLight();
        }

      } else {
        if (toggle.isDarkMode) {
          toggle.clearMode();
        } else {
          toggle.setDark();
        }
      }

    } else {
      if (toggle.isSysDarkPrefer) {
        toggle.setLight();
      } else {
        toggle.setDark();
      }
    }

    toggle.notify();

  } /* flipMode() */

</script>

  
</head>


  
    <!--
  Switch the mode between dark and light.
-->

<script type="text/javascript">
  class ModeToggle {
    static get MODE_KEY() { return "mode"; }
    static get MODE_ATTR() { return "data-mode"; }
    static get DARK_MODE() { return "dark"; }
    static get LIGHT_MODE() { return "light"; }
    static get ID() { return "mode-toggle"; }

    constructor() {
      if (this.hasMode) {
        if (this.isDarkMode) {
          if (!this.isSysDarkPrefer) {
            this.setDark();
          }
        } else {
          if (this.isSysDarkPrefer) {
            this.setLight();
          }
        }
      }

      let self = this;

      /* always follow the system prefers */
      this.sysDarkPrefers.addEventListener("change", () => {
        if (self.hasMode) {
          if (self.isDarkMode) {
            if (!self.isSysDarkPrefer) {
              self.setDark();
            }

          } else {
            if (self.isSysDarkPrefer) {
              self.setLight();
            }
          }

          self.clearMode();
        }

        self.notify();

      });

    } /* constructor() */

    get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); }

    get isSysDarkPrefer() { return this.sysDarkPrefers.matches; }

    get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; }

    get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; }

    get hasMode() { return this.mode != null; }

    get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); }

    /* get the current mode on screen */
    get modeStatus() {
      if (this.isDarkMode
        || (!this.hasMode && this.isSysDarkPrefer)) {
        return ModeToggle.DARK_MODE;
      } else {
        return ModeToggle.LIGHT_MODE;
      }
    }

    setDark() {
      $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
    }

    setLight() {
      $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
    }

    clearMode() {
      $('html').removeAttr(ModeToggle.MODE_ATTR);
      sessionStorage.removeItem(ModeToggle.MODE_KEY);
    }

    /* Notify another plugins that the theme mode has changed */
    notify() {
      window.postMessage({
        direction: ModeToggle.ID,
        message: this.modeStatus
      }, "*");
    }

  } /* ModeToggle */

  const toggle = new ModeToggle();

  function flipMode() {
    if (toggle.hasMode) {
      if (toggle.isSysDarkPrefer) {
        if (toggle.isLightMode) {
          toggle.clearMode();
        } else {
          toggle.setLight();
        }

      } else {
        if (toggle.isDarkMode) {
          toggle.clearMode();
        } else {
          toggle.setDark();
        }
      }

    } else {
      if (toggle.isSysDarkPrefer) {
        toggle.setLight();
      } else {
        toggle.setDark();
      }
    }

    toggle.notify();

  } /* flipMode() */

</script>

  

  <body data-spy="scroll" data-target="#toc" data-topbar-visible="true">

    <!--
  The Side Bar
-->

<div id="sidebar" class="d-flex flex-column align-items-end">
  <div class="profile-wrapper text-center">
    <div id="avatar">
      <a href="/" alt="avatar" class="mx-auto">
        
          
          <img src="
            
              /assets/images/pohsien.jpg
            
          " alt="avatar" onerror="this.style.display='none'">
        
      </a>
    </div>

    <div class="site-title mt-3">
      <a href="/">Po-Hsien Workspace</a>
    </div>
    <div class="site-subtitle font-italic">Cloud Native, Containerization, Virtualization, Linux Technologies.</div>

  </div><!-- .profile-wrapper -->

  <ul class="w-100">

    <!-- home -->
    <li class="nav-item">
      <a href="/" class="nav-link">
        <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i>
        <span>HOME</span>
      </a>
    </li>
    <!-- the real tabs -->
    
    <li class="nav-item">
      <a href="/categories/" class="nav-link">
        <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>CATEGORIES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/tags/" class="nav-link">
        <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>TAGS</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/archives/" class="nav-link">
        <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>ARCHIVES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/about/" class="nav-link">
        <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>ABOUT</span>
      </a>
    </li> <!-- .nav-item -->
    

  </ul> <!-- ul.nav.flex-column -->

  <div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center">

    
      <button class="mode-toggle btn" aria-label="Switch Mode">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    
      

      
      <a href="https://github.com/pohsien324" aria-label="github"
        target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
      

    
      

      
      <a href="
          javascript:location.href = 'mailto:' + ['pohsien324','gmail.com'].join('@')" aria-label="email"
        >
        <i class="fas fa-envelope"></i>
      </a>
      

    
      

      
      <a href="https://www.linkedin.com/in/po-hsien-shih-23bbb1162/" aria-label="linkedin"
        target="_blank" rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
      

    
      

      
      <a href="/feed.xml" aria-label="rss"
        >
        <i class="fas fa-rss"></i>
      </a>
      

    

  </div> <!-- .sidebar-bottom -->

</div><!-- #sidebar -->


    <!--
  The Top Bar
-->

<div id="topbar-wrapper" class="row justify-content-center">
  <div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between">
    <span id="breadcrumb">

    

    

      

        
          <span>
            <a href="/">
              Home
            </a>
          </span>

        

      

        

      

        

          
            <span>針對Enterprise PKS環境的K8s Cluster Node硬碟空間不足測試及解法</span>
          

        

      

    

    </span><!-- endof #breadcrumb -->

    <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>

    <div id="topbar-title">
      Post
    </div>

    <i id="search-trigger" class="fas fa-search fa-fw"></i>
    <span id="search-wrapper" class="align-items-center">
      <i class="fas fa-search fa-fw"></i>
      <input class="form-control" id="search-input" type="search"
        aria-label="search" autocomplete="off" placeholder="Search...">
    </span>
    <span id="search-cancel" >Cancel</span>
  </div>

</div>


    <div id="main-wrapper">
      <div id="main">

        









<div class="row">

  <!-- core -->
  <div id="core-wrapper" class="col-12 col-lg-11 col-xl-8">
    <div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

    

    
      
      
        <!--
  Refactor the HTML structure.
-->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Add attribute 'hide-bullet' to the checkbox list -->



<!-- images -->




  
  

  
    
      
      
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  
    

    
    
    

    
    

    
    
    

    
      
      

      
      

      

      
    
      
      

      
      

      

      
    

    
      

        <!-- Add CDN URL -->
        

        <!-- Add image path -->
        

        
        

      

      <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

      

    

    <!-- Add SVG placehoder to prevent layout reflow -->

    

    <!-- Bypass the HTML-proofer test -->
    

    

  

  



<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    

    

  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    

    

  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      

    

    

  

  
  

  




<!-- Wrap prompt element of blockquote with the <div> tag -->







  
  

  

    
      
      

    

    
    

    
    
    

    
      
        
        

    

    
    

    

  

    

    
    

    
    
    

    
      
        
        

    

    
    

    

  

    

    
    

    
    
    

    
      
        
        

    

    
    

    

  

    

    
    

    
    
    

    
      
        
        

    

    
    

    

  

    

    
    

    
    
    

    
      
        
        

    

    
    

    

  

    

    
    

    
    
    

    
      
        
        

    

    
    

    

  

  



<!-- return -->







<h1 data-toc-skip>針對Enterprise PKS環境的K8s Cluster Node硬碟空間不足測試及解法</h1>

<div class="post-meta text-muted">

  <!-- author -->
  <div>
    
    

    

    By
    <em>
      
        <a href="https://github.com/username">Po-Hsien Shih</a>
      
    </em>
  </div>

  <div class="d-flex">
    <div>
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/timeago.js
-->

<em class="timeago"
    data-ts="1562102544"
    
      data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll"
    
    >
  2019-07-02
</em>

      </span>

      <!-- lastmod date -->
      

      <!-- read time -->
      <!--
  Calculate the post's reading time, and display the word count in tooltip
 -->



<!-- words per minute  -->










<!-- return element -->
<span class="readtime" data-toggle="tooltip" data-placement="bottom"
  title="2262 words">
  <em>12 min</em> read</span>


      <!-- page views -->
      
    </div>

  </div> <!-- .d-flex -->

</div> <!-- .post-meta -->

<div class="post-content">
  <blockquote class="prompt-warning"><div>
  <p>此篇文章已不再更新，內容可能已過時</p>
</div></blockquote>

<p>這篇主要是測試Enterprise PKS佈出來的<code class="language-plaintext highlighter-rouge">Kubernetes Node</code> 上面的硬碟滿了會造成什麼影響以及要如何解決。其實這個問題應該跟一般<code class="language-plaintext highlighter-rouge">Kubernetes</code>環境差不多，只是目前有一些case緣故還是需要在Enterprise PKS環境下測試一下。因此特別針對這部分做測試。</p>

<!--more-->
<h2 id="kubernetes-node上的disk種類"><span class="mr-2">Kubernetes Node上的disk種類</span><a href="#kubernetes-node上的disk種類" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<p>在<strong>PCF Ops Manager Web GUI &gt; Enterprise PKS Tile &gt; Plan</strong>裡，可以設定Enterprise PKS部署出來的<code class="language-plaintext highlighter-rouge">Kubernetes Cluster</code>資源，其中有一些欄位是設定node VM的硬碟資訊:</p>

<p><img data-src="/assets/images/pks_disk_full_issue/xqutNQH.png" style="width:100%" data-proofer-ignore></p>

<p>預設<code class="language-plaintext highlighter-rouge">BOSH</code>產生出來的node上面會有三顆虛擬硬碟。這裡我們用<code class="language-plaintext highlighter-rouge">sda</code>,<code class="language-plaintext highlighter-rouge">sdb</code>,<code class="language-plaintext highlighter-rouge">sdc</code>來代稱。</p>
<ol>
  <li><code class="language-plaintext highlighter-rouge">sda</code>: Node System Disk，掛載目錄為<code class="language-plaintext highlighter-rouge">/</code>，為node VM作業系統的根目錄，這個大小目前是不能設定的，預設3GB。</li>
  <li><code class="language-plaintext highlighter-rouge">sdb</code>: Agent Package Disk，掛載目錄為<code class="language-plaintext highlighter-rouge">/var/vcap/data...</code>，為存放<code class="language-plaintext highlighter-rouge">pks-system</code>以及<code class="language-plaintext highlighter-rouge">bosh agent</code>這些必要套件的位置，這個就是<code class="language-plaintext highlighter-rouge">PCF Ops Manager</code>上設定的<code class="language-plaintext highlighter-rouge">VM Type</code>裡面的disk大小。</li>
  <li><code class="language-plaintext highlighter-rouge">sdc</code>: Persistent Disk，掛載目錄<code class="language-plaintext highlighter-rouge">/var/vcap/store/...</code>，這個disk在master中是用來存<code class="language-plaintext highlighter-rouge">etcd</code>的，因此只要disk沒有掛掉，不管<code class="language-plaintext highlighter-rouge">BOSH</code>怎麼修復master，<code class="language-plaintext highlighter-rouge">etcd</code>資料都不會消失。如果是worker的話，這個disk是用來存<code class="language-plaintext highlighter-rouge">docker container</code> 以及<code class="language-plaintext highlighter-rouge">docker image</code>。<code class="language-plaintext highlighter-rouge">sdc</code>大小是根據<code class="language-plaintext highlighter-rouge">PCF Ops Manager</code>裡面設定的<code class="language-plaintext highlighter-rouge">Persistent Disk Type</code>來配置。</li>
</ol>

<blockquote class="prompt-info"><div>
  <p>當node發生錯誤而啟動<code class="language-plaintext highlighter-rouge">BOSH</code>自動修復機制時，只有<code class="language-plaintext highlighter-rouge">sdc</code>資料會被保留，其他的都會被清空還原成初始狀態。</p>
</div></blockquote>
<blockquote class="prompt-tip"><div>
  <p>上面disk名稱只是方便識別，並非官方取名。</p>
</div></blockquote>
<p><img data-src="/assets/images/pks_disk_full_issue/EPqrgxu.png" style="width:100%" data-proofer-ignore></p>

<p>由於disk裡的資料可能會隨著時間成長，例如:log, <code class="language-plaintext highlighter-rouge">docker image/containe</code>或是一些暫存檔等等。為了確定清楚硬碟塞爆是否會影響<code class="language-plaintext highlighter-rouge">Kubernetes</code>服務，因此接下來會測試塞爆三種disk並觀察會發生的情況。</p>

<h2 id="使用到的指令"><span class="mr-2">使用到的指令</span><a href="#使用到的指令" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<p><strong>建立任意大小的檔案</strong></p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>fallocate <span class="nt">-l</span> &lt;檔案大小&gt; &lt;檔案名稱&gt;

Example:
<span class="nv">$ </span>fallocate <span class="nt">-l</span> 50G <span class="nb">test</span>
</pre></td></tr></tbody></table></code></div></div>

<p><strong>查看目錄屬於哪顆disk、大小及使用率</strong></p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">df</span> &lt;目錄&gt; <span class="nt">-h</span>

Example:
<span class="nv">$ </span><span class="nb">df</span> /var/vcap/ <span class="nt">-h</span>
</pre></td></tr></tbody></table></code></div></div>
<p><strong>查看目錄或檔案大小</strong></p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">du</span> <span class="nt">-sh</span> &lt;檔案名稱/目錄&gt;

Example:
<span class="nv">$ </span><span class="nb">du</span> <span class="nt">-sh</span> /var/vcap/
</pre></td></tr></tbody></table></code></div></div>
<p><strong>查看<code class="language-plaintext highlighter-rouge">docker</code>根目錄</strong></p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>docker system info
</pre></td></tr></tbody></table></code></div></div>
<p><strong>查看<code class="language-plaintext highlighter-rouge">docker image/container</code>數量/大小資訊</strong></p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>docker system <span class="nb">df</span>
</pre></td></tr></tbody></table></code></div></div>

<h2 id="node-system-disksda"><span class="mr-2">Node System Disk(<code class="language-plaintext highlighter-rouge"><span class="mr-2">sda</code>)</span><a href="#node-system-disksda" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<p><strong>測試環境:</strong></p>
<ul>
  <li>1台master, 2台worker</li>
</ul>

<p><strong>測試結果</strong></p>
<ol>
  <li>Container不會掛掉，正常運行。</li>
  <li><code class="language-plaintext highlighter-rouge">BOSH</code> ssh到worker的時候會顯示<code class="language-plaintext highlighter-rouge">no space left on device</code>錯誤。</li>
  <li>修復方式
    <ul>
      <li>關閉壞掉的node讓<code class="language-plaintext highlighter-rouge">BOSH</code>自動修復，產生新的node VM。</li>
      <li>如果還能登入node，可以清掉一些資料釋出Node System Disk(<code class="language-plaintext highlighter-rouge">sda</code>)空間。</li>
    </ul>
  </li>
</ol>

<p><strong>測試流程</strong></p>
<ol>
  <li>
    <p>使用<code class="language-plaintext highlighter-rouge">kubectl</code>建立deployment到cluster上。
<img data-src="/assets/images/pks_disk_full_issue/4fwqOoO.png" style="width:100%" data-proofer-ignore></p>
  </li>
  <li>連到worker VM裡並塞滿<code class="language-plaintext highlighter-rouge">sda</code>空間
    <div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre> <span class="c"># SSH</span>
 bosh <span class="nt">-d</span> &lt;deployment&gt; ssh &lt;worker&gt;

 <span class="c"># 切換到/dev/sda1掛載目錄</span>
 <span class="nb">cd</span> /var

 <span class="c"># 塞滿空間</span>
 fallocate <span class="nt">-l</span> 10G <span class="nb">test</span>
</pre></td></tr></tbody></table></code></div>    </div>
  </li>
  <li>Container依然正常運行無異常，但是當執行<code class="language-plaintext highlighter-rouge">bosh ssh</code>時出現下圖空間不足錯誤。
<img data-src="/assets/images/pks_disk_full_issue/W40XIom.png" style="width:100%" data-proofer-ignore></li>
</ol>

<h2 id="agent-packages-disksdb"><span class="mr-2">Agent Packages Disk(<code class="language-plaintext highlighter-rouge"><span class="mr-2">sdb</code>)</span><a href="#agent-packages-disksdb" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<p><strong>測試環境:</strong></p>
<ul>
  <li>1台master, 2台worker</li>
</ul>

<p><strong>測試結果</strong></p>
<ol>
  <li>Node會掛掉，無法負荷原本的container，因此原本上面跑的container都會變成<code class="language-plaintext highlighter-rouge">Evicted</code>狀態。(可能會造成服務中斷)</li>
  <li>如果有額外的node可用，master會佈新的container到別台node上。如果沒有，所有container都會變成<code class="language-plaintext highlighter-rouge">Pending</code>狀態。</li>
  <li>修復方式:
    <ul>
      <li>清出Agent Packages Disk空間，然後執行<code class="language-plaintext highlighter-rouge">monit restart all</code>，這樣node就會恢復正常。</li>
    </ul>
  </li>
</ol>

<p><strong>測試流程</strong></p>
<ol>
  <li>
    <p>使用<code class="language-plaintext highlighter-rouge">kubectl</code>建立deployment到cluster上。
<img data-src="/assets/images/pks_disk_full_issue/YLrnyK7.png" style="width:100%" data-proofer-ignore></p>
  </li>
  <li>連到worker VM(<code class="language-plaintext highlighter-rouge">b685858b...</code>)裡並塞滿<code class="language-plaintext highlighter-rouge">sdb</code>空間
    <div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre> <span class="c"># SSH</span>
 bosh <span class="nt">-d</span> &lt;deployment&gt; ssh &lt;worker&gt;

 <span class="c"># 切換到/dev/sdb2掛載目錄</span>
 <span class="nb">cd</span> /var/vcap/data/

 <span class="c"># 塞滿空間</span>
 fallocate <span class="nt">-l</span> 10G <span class="nb">test</span>
</pre></td></tr></tbody></table></code></div>    </div>
  </li>
  <li>
    <p>使用<code class="language-plaintext highlighter-rouge">kubectl</code>查看pods狀態，可以看到剛剛被塞爆的worker(<code class="language-plaintext highlighter-rouge">b685858b...</code>)上的pods都進入<code class="language-plaintext highlighter-rouge">Evicted</code>狀態，且master在其他node產生新的pods。
 <img data-src="/assets/images/pks_disk_full_issue/l1PCEZ3.png" style="width:100%" data-proofer-ignore></p>
  </li>
  <li>使用<code class="language-plaintext highlighter-rouge">kubectl describe pods &lt;pod name&gt;</code>查看<code class="language-plaintext highlighter-rouge">Evicted</code> pod，可以看到是因為node空間不足導致的。
<img data-src="/assets/images/pks_disk_full_issue/gZX51JK.png" style="width:100%" data-proofer-ignore></li>
</ol>

<h2 id="persistent-disksdc"><span class="mr-2">Persistent Disk(<code class="language-plaintext highlighter-rouge"><span class="mr-2">sdc</code>)</span><a href="#persistent-disksdc" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<p><strong>測試環境:</strong></p>
<ul>
  <li>1台master, 2台worker</li>
</ul>

<p><strong>測試結果</strong></p>
<blockquote class="prompt-info"><div>
  <p>與Agent Packages Disk(<code class="language-plaintext highlighter-rouge">sdb</code>)結果相同</p>
</div></blockquote>
<ol>
  <li>Node會掛掉，無法負荷原本的container，因此原本上面跑的container都會變成<code class="language-plaintext highlighter-rouge">Evicted</code>狀態。(可能會造成服務中斷)</li>
  <li>如果有額外的node可用，master會佈新的container到別台node上。如果沒有，所有container都會變成<code class="language-plaintext highlighter-rouge">Pending</code>狀態。</li>
  <li>修復方式:
    <ul>
      <li>清出persistent disk空間，然後在node上執行<code class="language-plaintext highlighter-rouge">monit restart all</code>指令，這樣node就會恢復正常。</li>
    </ul>
  </li>
</ol>

<p><strong>測試流程</strong></p>
<ol>
  <li>
    <p>使用<code class="language-plaintext highlighter-rouge">kubectl</code>建立deployment到cluster上。
<img data-src="/assets/images/pks_disk_full_issue/mlKfE1v.png" style="width:100%" data-proofer-ignore></p>
  </li>
  <li>連到worker VM(<code class="language-plaintext highlighter-rouge">3f28d443...</code>)裡並塞滿<code class="language-plaintext highlighter-rouge">sdb</code>空間
    <div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre> <span class="c"># SSH</span>
 bosh <span class="nt">-d</span> &lt;deployment&gt; ssh &lt;worker&gt;

 <span class="c"># 切換到/dev/sdc1掛載目錄</span>
 <span class="nb">cd</span> /var/vcap/store/docker

 <span class="c"># 塞滿空間</span>
 fallocate <span class="nt">-l</span> 50G <span class="nb">test</span>
</pre></td></tr></tbody></table></code></div>    </div>
  </li>
  <li>使用<code class="language-plaintext highlighter-rouge">kubectl</code>查看pods狀態，可以看到剛剛被塞爆的worker(<code class="language-plaintext highlighter-rouge">3f28d443...</code>)上的pods都進入<code class="language-plaintext highlighter-rouge">Evicted</code>狀態，且master在其他node產生新的pods。
<img data-src="/assets/images/pks_disk_full_issue/a3vEKZ7.png" style="width:100%" data-proofer-ignore></li>
</ol>

<h2 id="擴大node-disk大小"><span class="mr-2">擴大Node Disk大小</span><a href="#擴大node-disk大小" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<p>看到上述測試可以得知disk如果滿了是有可能會影響服務，解決方法除了清掉不必要的檔案釋出空間之外，也可以選擇擴大原有的空間，但目前能擴大的只有<code class="language-plaintext highlighter-rouge">sdb</code>以及<code class="language-plaintext highlighter-rouge">sdc</code>。</p>

<p>官方提供的擴大方式是到<code class="language-plaintext highlighter-rouge">PCF Ops Manager</code>去調原plan設定，例如把disk調大資源調多等等, 然後<code class="language-plaintext highlighter-rouge">apply change</code>的時候勾選<code class="language-plaintext highlighter-rouge">upgrade all cluster</code>, 這樣原有的cluster就會套用新的設定(cpu/memory/persistent disk…)，但只能修改原plan數值, 無法修改成不同plan(例如從plan1改成plan2)。詳情可參考<a href="https://community.pivotal.io/s/question/0D50e00005j9wr2/pks-plan-resizing">連結</a> ，另外此方法的缺點是要改的話，全部同樣使用該plan的cluster都會一併修改。</p>

<p>除了官方解法外，筆者我想到另外一種比較暴力的方法是直接在vCenter把node的硬碟擴大, 但是實際測試這種方式會導致<code class="language-plaintext highlighter-rouge">BOSH</code>那邊不同步引發錯誤，因此目前這是不可行的。</p>

<p>以下是兩種方法的測試流程:</p>

<h3 id="pcf-ops-manager調整plan設定"><span class="mr-2">PCF Ops Manager調整Plan設定</span><a href="#pcf-ops-manager調整plan設定" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3>
<ol>
  <li>
    <p>假設目前worker VM (<code class="language-plaintext highlighter-rouge">91997fd5...</code>) persistent disk已經被塞爆(預設50G)，希望能擴大空間。</p>

    <p><img data-src="/assets/images/pks_disk_full_issue/euMfkss.png" style="width:100%" data-proofer-ignore></p>
  </li>
  <li>
    <p>到<strong>PCF Ops Manager Web GUI &gt; Enterprise PKS Tile &gt; Plan</strong>將worker的persistent disk調整成75G。</p>

    <p><img data-src="/assets/images/pks_disk_full_issue/CQYZMUg.png" style="width:100%" data-proofer-ignore></p>
  </li>
  <li>
    <p>Apply Change</p>

    <p><img data-src="/assets/images/pks_disk_full_issue/75Kg9LL.png" style="width:100%" data-proofer-ignore></p>
  </li>
  <li>
    <p>完成後連到worker VM(<code class="language-plaintext highlighter-rouge">91997fd5...</code>)去看，可以看到空間已經成功擴大。</p>

    <p><img data-src="/assets/images/pks_disk_full_issue/rsK2ejX.png" style="width:100%" data-proofer-ignore></p>

    <p><img data-src="/assets/images/pks_disk_full_issue/LXvruwh.png" style="width:100%" data-proofer-ignore></p>
  </li>
  <li>
    <p>Pod也可以正常的部署在worker VM (<code class="language-plaintext highlighter-rouge">91997fd5...</code>)上了。</p>

    <p><img data-src="/assets/images/pks_disk_full_issue/VSiEQfY.png" style="width:100%" data-proofer-ignore></p>
  </li>
</ol>

<h3 id="從vcenter強制調整node-disk大小"><span class="mr-2">從vCenter強制調整Node Disk大小</span><a href="#從vcenter強制調整node-disk大小" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3>
<blockquote class="prompt-warning"><div>
  <p>注意這種方式會導致<code class="language-plaintext highlighter-rouge">BOSH</code>那邊不同步引發錯誤，因此目前此方法是不可行的，但還是將過程列出來供參考。</p>
</div></blockquote>

<ol>
  <li>
    <p>假設目前worker VM (<code class="language-plaintext highlighter-rouge">3f28d443...</code>) persistent disk已經被塞爆(預設50G)，希望能擴大空間。</p>

    <p><img data-src="/assets/images/pks_disk_full_issue/Tt4VPwq.png" style="width:100%" data-proofer-ignore></p>
  </li>
  <li>
    <p>到vCenter上直接去將worker VM persistent disk調整為80G。</p>

    <p><img data-src="/assets/images/pks_disk_full_issue/Iqi8IWj.png" style="width:100%" data-proofer-ignore></p>

    <p><img data-src="/assets/images/pks_disk_full_issue/6HJdvMp.png" style="width:100%" data-proofer-ignore></p>
  </li>
  <li>接下來為了避免<code class="language-plaintext highlighter-rouge">BOSH</code>將這台worker砍掉，因此要先關閉自動修復機制。
    <div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>bosh <span class="nt">-d</span> &lt;deployment&gt; update-resurrection  off
</pre></td></tr></tbody></table></code></div>    </div>
    <p><img data-src="/assets/images/pks_disk_full_issue/yssRzzr.png" style="width:100%" data-proofer-ignore></p>
  </li>
  <li>
    <p>接下來將worker VM(<code class="language-plaintext highlighter-rouge">3f28d443...</code>)關機。</p>

    <p><img data-src="/assets/images/pks_disk_full_issue/hydxUJn.png" style="width:100%" data-proofer-ignore></p>
  </li>
  <li>
    <p>可以從<code class="language-plaintext highlighter-rouge">bosh vms</code>看到該台worker1 已經變成<code class="language-plaintext highlighter-rouge">unresponsive agent</code>狀態，但是<code class="language-plaintext highlighter-rouge">BOSH</code>不會將它砍掉。</p>

    <p><img data-src="/assets/images/pks_disk_full_issue/j19gZsa.png" style="width:100%" data-proofer-ignore></p>
  </li>
  <li>
    <p>接下來到<strong>vCenter &gt; Datastore &gt; pcf_disks</strong>找到worker VM(<code class="language-plaintext highlighter-rouge">3f28d443...</code>)的persistent disk，並擴大它的空間。</p>

    <p>先找出worker1對應的persistent disk(<code class="language-plaintext highlighter-rouge">Disk CIDs</code>)</p>
    <div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre> <span class="nv">$ </span>bosh instances <span class="nt">-i</span>
</pre></td></tr></tbody></table></code></div>    </div>

    <p><img data-src="/assets/images/pks_disk_full_issue/LCP91iw.png" style="width:100%" data-proofer-ignore></p>

    <p>到<strong>vCenter &gt; Datastore &gt; pcf_disks</strong>找到對應的disk，可以發現disk還是50G。</p>

    <p><img data-src="/assets/images/pks_disk_full_issue/RAIviCX.png" style="width:100%" data-proofer-ignore></p>

    <p>點擊<code class="language-plaintext highlighter-rouge">inflate</code>來擴大硬碟。(這個動作會跑一段時間)</p>

    <p><img data-src="/assets/images/pks_disk_full_issue/oUw5Yi2.png" style="width:100%" data-proofer-ignore></p>

    <p>好了之後可以看到disk已經變80G。</p>

    <p><img data-src="/assets/images/pks_disk_full_issue/dxXNQZy.png" style="width:100%" data-proofer-ignore></p>
  </li>
  <li>
    <p>接下來將worker1開機，但是開好之後還是<code class="language-plaintext highlighter-rouge">unresponsive agent</code>。</p>

    <p><img data-src="/assets/images/pks_disk_full_issue/rxH2FnH.png" style="width:100%" data-proofer-ignore></p>
  </li>
  <li>不得已情況下只好將自動修復開起來，看看<code class="language-plaintext highlighter-rouge">BOSH</code>會不會砍掉建立新的worker，然後將persistent disk掛載上去。
    <div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>bosh <span class="nt">-d</span> &lt;deployment&gt; update-resurrection  on
</pre></td></tr></tbody></table></code></div>    </div>
    <p><img data-src="/assets/images/pks_disk_full_issue/jQ66VyK.png" style="width:100%" data-proofer-ignore></p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">BOSH</code>開始修復，但是修復到最後失敗，硬碟無法掛載，可能是因為disk裡的partition有變動到。到這裡就卡住了，BOSH就無法修復了，也許是某一步做錯或是<code class="language-plaintext highlighter-rouge">BOSH</code>本身不支援這種改法，後續如果有成功再來更新此篇，目前暫不將此方法列入解法。</p>

    <p><img data-src="/assets/images/pks_disk_full_issue/UcRfNFr.png" style="width:100%" data-proofer-ignore></p>
  </li>
</ol>

<h2 id="summary"><span class="mr-2">Summary</span><a href="#summary" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2>
<p>測試下來的感覺好像跟是不是Enterprise PKS環境沒啥關係xD。不過經過此測試也比較清楚Enterprise PKS運行機制以及針對這種情況的處理方式，但對目前的Enterprise PKS來說，擴大硬碟的機制還是很不彈性，這有可能是受到<code class="language-plaintext highlighter-rouge">BOSH</code>的限制，希望未來能夠再加強這部分。</p>

<h4 id="reference"><span class="mr-2">Reference</span><a href="#reference" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4>
<ol>
  <li>PKS Plan Resizing - <a href="https://community.pivotal.io/s/question/0D50e00005j9wr2/pks-plan-resizing">https://community.pivotal.io/s/question/0D50e00005j9wr2/pks-plan-resizing</a></li>
  <li>Changing the thick or thin provisioning of a virtual disk - <a href="https://kb.vmware.com/s/article/2014832">https://kb.vmware.com/s/article/2014832</a></li>
</ol>

<blockquote class="prompt-info"><div>
  <p>文章內容的轉載、重製、發佈，請註明出處: <a href="https://pohsienshih.github.io">https://pohsienshih.github.io</a></p>
</div></blockquote>


</div>

<div class="post-tail-wrapper text-muted">

  <!-- categories -->
  
  <div class="post-meta mb-3">
    <i class="far fa-folder-open fa-fw mr-1"></i>
    
      <a href='/categories/pivotal/'>Pivotal</a>,
      <a href='/categories/container/'>Container</a>,
      <a href='/categories/service/'>Service</a>
  </div>
  

  <!-- tags -->
  
  <div class="post-tags">
    <i class="fa fa-tags fa-fw mr-1"></i>
      
      <a href="/tags/pks/"
          class="post-tag no-text-decoration" >pks</a>
      
      <a href="/tags/kubernetes/"
          class="post-tag no-text-decoration" >kubernetes</a>
      
  </div>
  

  <div class="post-tail-bottom
    d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
    <div class="license-wrapper">

      

        

        This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.

      
    </div>

    <!--
 Post sharing snippet
-->

<div class="share-wrapper">
  <span class="share-label text-muted mr-1">Share</span>
  <span class="share-icons">
    
    

    
      
        <a href="https://twitter.com/intent/tweet?text=針對Enterprise PKS環境的K8s Cluster Node硬碟空間不足測試及解法 - Po-Hsien Workspace&amp;url=http://0.0.0.0:4000/blog/enterprise-pks-k8s-node-disk-out-of-space/" data-toggle="tooltip" data-placement="top"
          title="Twitter" target="_blank" rel="noopener" aria-label="Twitter">
          <i class="fa-fw fab fa-twitter"></i>
        </a>
    
      
        <a href="https://www.facebook.com/sharer/sharer.php?title=針對Enterprise PKS環境的K8s Cluster Node硬碟空間不足測試及解法 - Po-Hsien Workspace&amp;u=http://0.0.0.0:4000/blog/enterprise-pks-k8s-node-disk-out-of-space/" data-toggle="tooltip" data-placement="top"
          title="Facebook" target="_blank" rel="noopener" aria-label="Facebook">
          <i class="fa-fw fab fa-facebook-square"></i>
        </a>
    
      
        <a href="https://t.me/share/url?url=http://0.0.0.0:4000/blog/enterprise-pks-k8s-node-disk-out-of-space/&amp;text=針對Enterprise PKS環境的K8s Cluster Node硬碟空間不足測試及解法 - Po-Hsien Workspace" data-toggle="tooltip" data-placement="top"
          title="Telegram" target="_blank" rel="noopener" aria-label="Telegram">
          <i class="fa-fw fab fa-telegram"></i>
        </a>
    

    <i id="copy-link" class="fa-fw fas fa-link small"
        data-toggle="tooltip" data-placement="top"
        title="Copy link"
        data-title-succeed="Link copied successfully!">
    </i>

  </span>
</div>


  </div><!-- .post-tail-bottom -->

</div><!-- div.post-tail-wrapper -->


      
    
    

    </div>
  </div> <!-- #core-wrapper -->

  <!-- pannel -->
  <div id="panel-wrapper" class="col-xl-3 pl-2 text-muted">

    <div class="access">
      















  <div id="access-lastmod" class="post">
    <div class="panel-heading">Recently Updated</div>
    <ul class="post-content pl-0 pb-1 ml-1 mt-2">
      
        
        
        
      <li><a href="/blog/activemq5-shared-file-system-master-slave/">ActiveMQ 5 Shared File System Master Slave</a></li>
      
        
        
        
      <li><a href="/blog/mariadb-master-slave-replication-with-maxscale/">MariaDB Master-Slave Replication with MaxScale</a></li>
      
    </ul>
  </div> <!-- #access-lastmod -->



      















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <div id="access-tags">
    <div class="panel-heading">Trending Tags</div>
    <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

    
      
      <a class="post-tag" href="/tags/kubernetes/">kubernetes</a>
    
      
      <a class="post-tag" href="/tags/conference/">conference</a>
    
      
      <a class="post-tag" href="/tags/personal/">Personal</a>
    
      
      <a class="post-tag" href="/tags/high-availability/">high availability</a>
    
      
      <a class="post-tag" href="/tags/pks/">pks</a>
    
      
      <a class="post-tag" href="/tags/testing/">testing</a>
    
      
      <a class="post-tag" href="/tags/activemq/">activemq</a>
    
      
      <a class="post-tag" href="/tags/elk/">ELK</a>
    
      
      <a class="post-tag" href="/tags/log/">log</a>
    
      
      <a class="post-tag" href="/tags/mariadb/">mariadb</a>
    

    </div>
  </div>


    </div>

    
      
      



<!-- BS-toc.js will be loaded at medium priority -->
<script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script>

<div id="toc-wrapper" class="pl-0 pr-4 mb-5">
  <div class="panel-heading pl-3 pt-2 mb-2">Contents</div>
  <nav id="toc" data-toggle="toc"></nav>
</div>


    
  </div>

</div>

<!-- tail -->

<div class="row">
  <div class="col-12 col-lg-11 col-xl-8">
    <div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">
      
        
        <!--
 Recommend the other 3 posts according to the tags and categories of the current post,
 if the number is not enough, use the other latest posts to supplement.
-->

<!-- The total size of related posts  -->


<!-- An random integer that bigger than 0  -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy}  -->








  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  
    
  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  








<!-- Fill with the other newlest posts  -->






  <div id="related-posts" class="mt-5 mb-2 mb-sm-4">
    <h3 class="pt-2 mt-1 mb-4 ml-1"
      data-toc-skip>Further Reading</h3>
    <div class="card-deck mb-4">
    
      
      
      <div class="card">
        <a href="/blog/enterprise-pks-introduction/">
          <div class="card-body">
            <!--
  Date format snippet
  See: ${JS_ROOT}/utils/timeago.js
-->

<em class="timeago small"
    data-ts="1561680417"
    
    >
  2019-06-28
</em>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Enterprise PKS介紹</h3>
            <div class="text-muted small">
              <p>
                





                
  此篇文章已不再更新，內容可能已過時


PKS全名是Pivotal Container Service，顧名思義是由Pivotal這間公司開發的。Pivotal是VMware的子公司，也許比較少人知道這間公司，不過相信大家應該都聽過tomcat或是redis，這兩個知名的專案就是由Pivotal開發的，由此可知Pivotal也是一家技術非常扎實強大的公司。

PKS介紹
PKS是用來管...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/blog/e2e-testing-for-kubernetes-part-i/">
          <div class="card-body">
            <!--
  Date format snippet
  See: ${JS_ROOT}/utils/timeago.js
-->

<em class="timeago small"
    data-ts="1572023779"
    
    >
  2019-10-25
</em>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>End-to-End Testing for Kubernetes (Part I) - kubetest</h3>
            <div class="text-muted small">
              <p>
                





                現今 Kubernetes Cluster 部署方式越來越多種，部署門檻也越來越低，但是在部署完之後要如何確認自己的 Cluster 真的是正常可用的？ 大多數的人(包含筆者以前)都是簡單部署一些 Deployment 或是 Service 看是否有 running 就認為 Cluster 是正常的，或是部署時沒有看到什麼錯誤訊息就覺得沒事，但是這樣是不太足夠的，因為有可能壞掉的是一些不常使...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/blog/e2e-testing-for-kubernetes-part-ii/">
          <div class="card-body">
            <!--
  Date format snippet
  See: ${JS_ROOT}/utils/timeago.js
-->

<em class="timeago small"
    data-ts="1572121034"
    
    >
  2019-10-26
</em>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>End-to-End Testing for Kubernetes (Part II) - Conformance Testing</h3>
            <div class="text-muted small">
              <p>
                





                此系列文為 E2E Testing for Kubernetes 的介紹，如尚未看過前一篇文章，可以參考底下連結:

  End-to-End Testing for Kubernetes (Part I) - kubetest
  End-to-End Testing for Kubernetes (Part II) - Conformance Testing


Conformance ...
              </p>
            </div>
          </div>
        </a>
      </div>
    
    </div> <!-- .card-deck -->
  </div> <!-- #related-posts -->


      
        
        <!--
  Navigation buttons at the bottom of the post.
-->

<div class="post-navigation d-flex justify-content-between">
  
  <a href="/blog/enterprise-pks-introduction/" class="btn btn-outline-primary"
    prompt="Older">
    <p>Enterprise PKS介紹</p>
  </a>
  

  
  <a href="/blog/2019-ithome-kubernetes-summit-notes/" class="btn btn-outline-primary"
    prompt="Newer">
    <p>iThome Kubernetes Summit 2019 心得</p>
  </a>
  

</div>

      
        
        <!--  The comments switcher -->


      
    </div>
  </div>
</div> <!-- .row -->



        <!--
  The Footer
-->

<footer class="d-flex w-100 justify-content-center">
  <div class="d-flex justify-content-between align-items-center text-muted">
    <div class="footer-left">
      <p class="mb-0">
        © 2022
        <a href="https://github.com/username">Po-Hsien Shih</a>.
        
        <span data-toggle="tooltip" data-placement="top"
          title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span>
        
      </p>
    </div>

    <div class="footer-right">
      <p class="mb-0">
        

        

        Powered by 
          <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>
         with 
          <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a>
         theme.

      </p>
    </div>

  </div> <!-- div.d-flex -->
</footer>


      </div>

      <!--
  The Search results
-->
<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-12 col-sm-11 post-content">
    <div id="search-hints">
      















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <div id="access-tags">
    <div class="panel-heading">Trending Tags</div>
    <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

    
      
      <a class="post-tag" href="/tags/kubernetes/">kubernetes</a>
    
      
      <a class="post-tag" href="/tags/conference/">conference</a>
    
      
      <a class="post-tag" href="/tags/personal/">Personal</a>
    
      
      <a class="post-tag" href="/tags/high-availability/">high availability</a>
    
      
      <a class="post-tag" href="/tags/pks/">pks</a>
    
      
      <a class="post-tag" href="/tags/testing/">testing</a>
    
      
      <a class="post-tag" href="/tags/activemq/">activemq</a>
    
      
      <a class="post-tag" href="/tags/elk/">ELK</a>
    
      
      <a class="post-tag" href="/tags/log/">log</a>
    
      
      <a class="post-tag" href="/tags/mariadb/">mariadb</a>
    

    </div>
  </div>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>


    </div> <!-- #main-wrapper -->

    

    <div id="mask"></div>

    <a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button">
      <i class="fas fa-angle-up"></i>
    </a>

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script>

<script>
SimpleJekyllSearch({
  searchInput: document.getElementById('search-input'),
  resultsContainer: document.getElementById('search-results'),
  json: '/assets/js/data/search.json',
  searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0">  <a href="{url}">{title}</a>  <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">    {categories}    {tags}  </div>  <p>{snippet}</p></div>',
  noResultsText: '<p class="mt-5">Oops! No result founds.</p>',
  templateMiddleware: function(prop, value, template) {
    if (prop === 'categories') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
      }
    }

    if (prop === 'tags') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
      }
    }
  }
});
</script>


    <!--
  JS selector for site.
-->

<!-- layout specified -->


  



  <!-- image lazy-loading & popup & clipboard -->
  

  







  
    

    

  



  
    

    

  



  
    

    

  




  <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script>







  

  

  







  
    

    

  



  
    

    

  



  
    

    

  



  
    

    

  




  <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script>








<script defer src="/assets/js/dist/post.min.js"></script>



<!-- commons -->

<script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script>




  </body>

</html>

