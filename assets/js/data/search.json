[
  
  {
    "title": "ActiveMQ 5 Shared File System Master Slave",
    "url": "/blog/activemq5-shared-file-system-master-slave/",
    "categories": "Others",
    "tags": "activemq, master-slave, high availability",
    "date": "2022-04-21 23:14:58 +0000",
    





    "snippet": "ActiveMQ 5 åœ¨ High Availability (HA) ä¸Šåˆ†æˆå…©ç¨®è§’è‰²: master å’Œ slave ï¼Œé¡ä¼¼ Active-Standby modeã€‚åœ¨ä¸€èˆ¬æƒ…æ³åªæœƒæœ‰ master è™•ç† Requestï¼Œslave å¾…å‘½ï¼Œåªæœ‰ç•¶ master ç•°å¸¸æ™‚ï¼Œslave æ‰æœƒæ¥æ‰‹é€™äº›å‹•ä½œã€‚ä¸€èˆ¬ ActiveMQ éƒ½æ˜¯æŠŠè³‡æ–™å­˜åœ¨è¨˜æ†¶é«”è£¡é¢ï¼Œä½†æ˜¯ç•¶ Broker æ›æ‰å¾Œï¼Œè¨˜æ†¶é«”è£¡å­˜æ”¾çš„ Message æœƒæ¶ˆå¤±ï¼Œå› æ­¤åœ¨ HA çš„æ¦‚å¿µå°±æ˜¯è¦æƒ³è¾¦æ³•æŠŠ Message è®Šæˆ Persistent Data å­˜åœ¨ Diskï¼Œç„¶å¾Œç•¶ Broker æ¢å¾©æ™‚æˆ–æ˜¯å…¶ä»– Broker æ¥æ‰‹æ™‚ï¼Œå¯ä»¥ç›´æ¥å­˜å–é€™å€‹ Persistent Data ä¾†æ¥æ‰‹è™•ç† Messageã€‚ActiveMQ 5 HA åˆ†æˆå…©ç¨®æ–¹å¼:  Shared File System Master Slave (Share Filesystem)  JDBC Master Slave (Share Database)æœ¬ç¯‡æ–‡ç« ä¸»è¦æœƒæ¢è¨çš„æ˜¯ ActiveMQ 5 çš„ Shared File System Master Slave æ¨¡å¼ã€‚Shared File System Master Slave Introductioné€™å€‹æ¨¡å¼æ˜¯æœƒå°‡ ActiveMQ çš„ Persistent Data (Status æˆ– Message) å„²å­˜åœ¨ Shared File System (å¦‚ NFS æˆ–æ˜¯ SAN)ï¼Œå†è®“å…¶ä»– ActiveMQ æ›è¼‰ Shared File Systemï¼Œè®“å…¨éƒ¨ ActiveMQ ç¯€é»å…±åŒæ“æœ‰é€™äº›è³‡æ–™ã€‚åœ¨é–‹å§‹å¯¦ä½œå‰ï¼Œå…ˆä»‹ç´¹ä¸€ä¸‹é‹ä½œæ©Ÿåˆ¶ã€‚ActiveMQ å¯ä»¥åœ¨ activemq.xml çš„ persistenceAdapter å•Ÿç”¨ Local Database - KahaDB ä¾†å„²å­˜ Persistent Dataï¼ŒActiveMQ æœƒæŠŠ Message å­˜æˆ Log æª”å­˜æ”¾åœ¨ Broker Local çš„  KahaDB ç›®éŒ„è£¡ï¼Œé è¨­éƒ½ä¸æ”¹è¨­å®šçš„è©± KahaDB ä½ç½®ç‚º ${activemq.data}/kahadb ä¹Ÿå°±æ˜¯ ActiveMQ ç›®éŒ„åº•ä¸‹çš„ data/kahadbã€‚        &amp;lt;persistenceAdapter&amp;gt;            &amp;lt;kahaDB directory=&quot;${activemq.data}/kahadb&quot;/&amp;gt;        &amp;lt;/persistenceAdapter&amp;gt;è€Œåœ¨ Shared File System Master Slave æ¨¡å¼ä¸‹ï¼ŒæœƒæŠŠ Shared File System Volume æ›è¼‰åˆ° KahaDB ç›®éŒ„è£¡ï¼Œå¦‚æ­¤ä¸€ä¾† Master è·Ÿæ‰€æœ‰ Slave ActiveMQ ç¯€é»éƒ½æœƒå–å¾—åŒä¸€å€‹ KahaDB è³‡æ–™ï¼Œä¸”é€™ç¨®æ–¹å¼æœƒæ•´åˆ Lock æ©Ÿåˆ¶ï¼Œå…ˆæ¶åˆ°å­˜å–æ¬Šçš„ç¯€é»å°‡æœƒè®Šæˆ Masterï¼Œè€Œå…¶ä»–çµé»å°±æœƒè®Šæˆ Slaveï¼Œ Slave ç‹€æ…‹çš„ç¯€é»å¤§éƒ¨åˆ†æœå‹™éƒ½ä¸æœƒå•Ÿå‹•ï¼Œåªæœƒå•Ÿå‹•ä¸€å€‹å¾ˆç°¡å–®çš„ Java æª”ï¼Œå®šæœŸæª¢æŸ¥ KahaDB æ˜¯å¦å·²ç¶“è¢« Releaseï¼Œå¦‚æœ‰è¢« Releaseï¼Œå°±æœƒå•Ÿå‹•å…¨éƒ¨æœå‹™æ¶å…ˆè®Šæˆ Masterã€‚      å•Ÿç”¨æ™‚ï¼Œåªæœƒæœ‰ä¸€å° Master å­˜åœ¨ï¼Œå…¶ä»–æ¶è¼¸çš„ç‚º Slave (åœ¨æ­¤ Database1 ç‚º KahaDB)        ç•¶ Master ç•°å¸¸ä¸¦ Release KahaDB å¾Œï¼Œå…¶ä»– Slave æœƒçˆ­å¥ªè®Šæˆæ–°çš„ Masterï¼Œæ¥æ‰‹åŸæœ¬çš„å·¥ä½œ  åœ–ç‰‡ä¾†æº: ActiveMQ - The Failover Transport  åœ¨é€™ç¨®æ¨¡å¼ä¸‹åªèƒ½æœ‰ä¸€å€‹ Masterï¼Œä½†å¯ä»¥æœ‰å¤šå€‹ Slave (1~N)ã€‚Implementä»¥ä¸‹ç‚ºç’°å¢ƒè³‡è¨Š:  Broker A Node          192.168.89.131:61616      ActiveMQ 5.16.4      Ubuntu 20.04 LTS      JMS Protocol        Broker B Node          192.168.89.132:61616      ActiveMQ 5.16.4      Ubuntu 20.04 LTS      JMS Protocol        Broker C Node          192.168.89.133:61616      ActiveMQ 5.16.4      Ubuntu 20.04 LTS      JMS Protocol        NFS Server (192.168.89.134)  å¦‚æœè¦ç”¨ NFS è¦ç”¨ NFSv4 ä¸è¦ç”¨ NFSv3 æœƒæœ‰å•é¡Œï¼Œå¯æŸ¥çœ‹ Official - Shared File System Master Slave  NFS Server å»ºç½®æ–¹å¼æœ‰ç›¸ç•¶å¤šç¨®ï¼Œå¯ä»¥åƒè€ƒ Ubuntu 20.04 ä¸­é…ç½®NFSæœå‹™ ï¼Œåœ¨æ­¤ä¸ç‰¹åˆ¥é—¡è¿°  ä¸‹è¼‰ ActiveMQ 5.16.4    $ wget https://archive.apache.org/dist/activemq/5.16.4/apache-activemq-5.16.4-bin.tar.gz$ tar zxvf apache-activemq-5.16.4-bin.tar.gz$ cd apache-activemq-5.16.4        ä¸‰å° Broker Node éƒ½å»ºç«‹ä¸€å€‹ /mnt/KahaDB ç›®éŒ„ä¸¦æ›è¼‰ NFS Volumeï¼Œé€™å€‹ç›®éŒ„å°±æ˜¯ç”¨ä¾†å­˜æ”¾ KahaDB Dataã€‚    $ mmkdir -p /mnt/kahaDB$ mount -t nfs4 -o proto=tcp,port=2049 192.168.89.134:/nfs /mnt/kahaDB/        æ¥è‘—ä¿®æ”¹ä¸‰å° activemq.xmlï¼Œè¨­å®š kahaDB ç›®éŒ„ä½ç½®ã€‚    $ vim apache-activemq-5.16.4/conf/activemq.xml        å°‡ persistenceAdapter æ”¹æˆå¦‚ä¸‹         &amp;lt;persistenceAdapter&amp;gt;         &amp;lt;kahaDB directory=&quot;/mnt/kahaDB&quot;/&amp;gt;     &amp;lt;/persistenceAdapter&amp;gt;        æ¥è‘—å°±å¯ä»¥å•Ÿå‹•ä¸‰å° ActiveMQ Brokerã€‚    $ cd apache-activemq-5.16.4/bin/$ ./activemq start            å•Ÿå‹•å¾Œå¯ä»¥ç™¼ç¾åªæœ‰ Broker C çœŸæ­£æœ‰å•Ÿå‹•æœå‹™ (8161 port, 61616 port)ï¼ŒBroker A è·Ÿ Broker B éƒ½åªæœ‰å•Ÿå‹•ä¸€éš» java ç¨‹å¼è€Œå·²ï¼Œè¡¨ç¤º Broker C ç‚º Masterï¼Œå…¶ä»–å…©å°ç‚º Slaveã€‚Broker ABroker BBroker C    æŸ¥çœ‹ Broker A è·Ÿ Broker B Log (apache-activemq-5.16.3/data/acrivemq.log)ï¼Œå¯ä»¥ç™¼ç¾è©²å° Broker ç‚º Slave Modeã€‚    2022-01-10 08:34:29,383 | INFO  | Refreshing org.apache.activemq.xbean.XBeanBrokerFactory$1@7cc0cdad: startup date [Mon Jan 10 08:34:29 UTC 2022]; root of context hierarchy | org.apache.activemq.xbean.XBeanBrokerFactory$1 | main2022-01-10 08:34:31,638 | INFO  | Using Persistence Adapter: KahaDBPersistenceAdapter[/mnt/kahaDB] | org.apache.activemq.broker.BrokerService | main2022-01-10 08:34:31,667 | INFO  | Database /mnt/kahaDB/lock is locked by another server. This broker is now in slave mode waiting a lock to be acquired | org.apache.activemq.store.SharedFileLocker | main        æ¥è‘—åœ¨ Producer åŠ Consumer è¨­å®š Failover Transportï¼Œé€™æ¨£ Producer/Consumer å°±æœƒè‡ªå‹•é€£ä¸Šå¯ä»¥ä½¿ç”¨çš„ ActiveMQï¼Œä¸¦ä¸”åœ¨ ActiveMQ ç•°å¸¸æ™‚ï¼Œè‡ªå‹• Failover åˆ‡æ›é€£ç·šåˆ°å…¶ä»–å°ã€‚åœ¨æ­¤ HA æ¨¡å¼ä¸‹ï¼Œç”±æ–¼åªæœ‰ Broker C ç›®å‰æ˜¯æœ‰å•Ÿç”¨ 61616 port çš„ï¼Œå› æ­¤åªæœƒé€£åˆ° Broker Cã€‚    ... ActiveMQConnectionFactory factory = new ActiveMQConnectionFactory(&quot;failover:(tcp://192.168.89.131:61616,tcp://192.168.89.132:61616,tcp://192.168.89.133:61616)&quot;);...              Client ç¨‹å¼ç¯„ä¾‹å¯ä»¥åƒè€ƒ Cross Language Clientsã€‚        å®Œæˆå¾Œè¨­å®šå¾Œï¼Œå¯ä»¥æ¸¬è©¦åŸ·è¡Œ apache-activemq-5.16.4/examples/openwire/java ç›®éŒ„è£¡çš„ç¯„ä¾‹ç¨‹å¼å‚³é€  Message (1000 ç­†)ï¼Œé€™æ™‚ Client æœƒé€£åˆ° Broker Cã€‚    $ java -cp target/openwire-example-0.1-SNAPSHOT.jar example.Publisher        å¯ä»¥çœ‹åˆ° Broker C è£¡é¢æœ‰ 1000 ç­† Message    æ¥è‘—åŸ·è¡Œ Consumer ç¨‹å¼ï¼Œæœƒé€£åˆ° Broker Cï¼Œç„¶å¾Œé–‹å§‹å–è³‡æ–™    $ java -cp target/openwire-example-0.1-SNAPSHOT.jar example.Listener            å–åˆ°ä¸€åŠæŠŠ Broker C é—œé–‰æ‰ï¼Œæ¨¡æ“¬ç•°å¸¸    ./activemq stop              å¦‚æœ Consumer æ¥æ”¶ Message éå¿«çš„è©±ï¼Œå¯ä»¥è©¦è‘—åœ¨ç¨‹å¼åŠ  sleep æ©Ÿåˆ¶ï¼Œè®“ä»–æ”¾æ…¢é€Ÿåº¦ï¼Œæ¯”è¼ƒå¥½æ¸¬è©¦            å¤§ç´„ç­‰å¹¾ç§’å¯ä»¥çœ‹åˆ° Broker B æœå‹™å•Ÿå‹•äº†ä¸¦æ¥æ‰‹äº†å·¥ä½œï¼Œè®Šæˆ Masterï¼Œç„¶å¾Œ Consumer æœƒæ”¹æˆé€£è‡³ Broker Bï¼Œç„¶å¾Œç¹¼çºŒå¾ Queue å–æ²’å–å®Œçš„ Messageã€‚     å®Œæˆã€‚Referemce  ActiveMQ - The Failover Transport  ActiveMQ - Shared File System Master Slave  ActiveMQ - Clustering  Cross Language Clients  æ–‡ç« å…§å®¹çš„è½‰è¼‰ã€é‡è£½ã€ç™¼ä½ˆï¼Œè«‹è¨»æ˜å‡ºè™•: https://pohsienshih.github.io"
  },
  
  {
    "title": "MariaDB Master-Slave Replication with MaxScale",
    "url": "/blog/mariadb-master-slave-replication-with-maxscale/",
    "categories": "Database",
    "tags": "mariadb, high availability",
    "date": "2022-03-05 12:24:21 +0000",
    





    "snippet": "æœ€è¿‘å› å·¥ä½œé—œä¿‚å‰›å¥½ç ”ç©¶åˆ° MariaDB High Availability (HA) æ©Ÿåˆ¶ï¼Œå› æ­¤æœ¬ç¯‡æ•´ç†ä¸€ä¸‹ MariaDB Master-Slave Replication çš„ç›¸é—œç­†è¨˜ã€‚åœ¨ä¸€å€‹ç³»çµ±ç’°å¢ƒè£¡ï¼Œè³‡æ–™åº«é€šå¸¸æ‰®æ¼”è‘—å¾ˆé‡è¦çš„è§’è‰²ï¼Œä¸»è¦è² è²¬å­˜æ”¾ç³»çµ±çš„ä¸€äº›ç´€éŒ„æˆ–æ˜¯ä½¿ç”¨è€…çš„è³‡æ–™ï¼Œå› æ­¤è³‡æ–™åº«çš„å‚™æ´/é«˜å¯ç”¨æ€§ (High Availability)ä»¥åŠè² è¼‰å¹³è¡¡ (Load Balancing) å°±è®Šå¾—ç›¸ç•¶é‡è¦ã€‚ç›®å‰ MariaDB é‡å° High Availability æœ‰ä»¥ä¸‹å¸¸è¦‹çš„å¹¾ç¨®æ–¹å¼:  Master-Slave Replication         (A-S Mode)  Master-Master Replication       (A-A Mode)  Galera Cluster Master-Master (A-A Mode)  Galera Cluster Master-Slave    (A-S Mode)æœ¬ç¯‡æ–‡ç« ä¸»è¦æœƒæ¢è¨çš„æ˜¯æœ€å‚³çµ±çš„æ–¹å¼ Master-Slave Replication ã€‚Master-Slave ReplicationMaster-Slave Replication ä¸»è¦æ˜¯å°‡å¤šå° MariaDB çµ„æˆ Clusterï¼Œè€Œé€™å€‹ Cluster è£¡ï¼Œæœƒæœ‰ä¸€å° MariaDB æ‰®æ¼” Master çš„è§’è‰²ï¼Œè€Œå…¶ä»– 1~n å°æœƒæ‰®æ¼”è‘— Slave çš„è§’è‰²ï¼ŒMaster  ä¸»è¦è² è²¬çš„å‹•ä½œç‚ºRead-Writeï¼›Slave å‰‡è² è²¬ Read ä»¥åŠåŒæ­¥ Master çš„æ‰€æœ‰æ“ä½œã€‚ä»¥ä¸‹ç‚ºæœ€å¸¸è¦‹çš„æ¶æ§‹ï¼Œé€šå¸¸ Master åªæœƒæœ‰ä¸€å°ï¼Œç„¶å¾Œæœƒæœ‰å¤šå° Slave ä¸æ–·åŒæ­¥ Master çš„å·¥ä½œï¼Œç•¶ Master æ›æ‰æ™‚ï¼Œç®¡ç†è€…å¯ä»¥å°‡ Slave è½‰æ›æˆ Master å–ä»£ Master å‹•ä½œã€‚åœ–ç‰‡ä¾†æº: Replication Overviewå› æ­¤åœ¨é€™ç¨® Master-Slave Replication æ¶æ§‹ä¸‹:  åªèƒ½æœ‰ä¸€å° Master å­˜åœ¨ï¼ŒMaster å¯ä»¥è™•ç† Read-Write å·¥ä½œ  å¯ä»¥æœ‰å¤šå° Slave å­˜åœ¨ï¼ŒSlave å¯ä»¥è™•ç† Read å·¥ä½œæˆ–æ˜¯å–®ç´” Standby  Slave æœƒä¸æ–·è·Ÿ Master åŒæ­¥è³‡æ–™  æ”¯æ´ Read HA + LoadBalancing  æ”¯æ´ Write HA ä½†ä¸æ”¯æ´ Load Balancing  ğŸ’¡ å¦‚æœè¦è€ƒé‡ Write Load Balancingï¼Œå°±å¿…é ˆè¦æœ‰å¤šå° Master åŒæ™‚é‹ä½œçš„æƒ…å¢ƒï¼Œé€™ç¨®æƒ…å¢ƒå°±è¦æ”¹ä½¿ç”¨ Master-Master Replication æˆ–æ˜¯ MariaDB Galera Clusterã€‚åŒæ­¥æ©Ÿåˆ¶åœ–ç‰‡ä¾†æº: HA for MySQL and MariaDB - Comparing Master-Master Replication to Galera ClusterMariaDB Replication ä¸»è¦é€é Binary Log ä»¥åŠ Relay Log çš„æ–¹å¼é€²è¡ŒåŒæ­¥ã€‚  Master æœƒå°‡ CREATEã€ ALTERã€ INSERTã€ UPDATE é‚„æœ‰ DELETE  é€™äº›æ“ä½œçš„æ­¥é©Ÿè¨˜éŒ„åœ¨ BInary Log è£¡é¢ã€‚  Slave æœƒå®šæœŸ Polling Master Binary Log (ä½¿ç”¨ MySQL API, é€™é–“éš”è¶¨è¿‘ Real-Time)ï¼Œä¸¦å°‡ Binary Log è³‡è¨Šä»¥åŠåŒæ­¥ç´€éŒ„å¯«åœ¨è‡ªå·±çš„ Relay Log è£¡é¢ã€‚  Slave æœ€å¾Œæ ¹æ“š Relay Log è³‡è¨Šä¾†å¥—ç”¨ SQL åˆ° Slave MariaDB ä¸Šã€‚  å®ŒæˆåŒæ­¥ã€‚è¨­å®šæ­¥é©Ÿæ­¤æ–‡ç« æ¡ç”¨ç‰ˆæœ¬è³‡è¨Šå¦‚ä¸‹:  MariaDB 10.3.32  Ubuntu 20.04 LTSç’°å¢ƒ:  Master MariaDB 192.168.89.131  Slave MariaDB 192.168.89.132  ä»¥ä¸‹æ­¥é©Ÿé–‹å§‹åœ¨ Master MariaDB ä¸Šæ“ä½œ      è¨­å®š my.cnf æª”ï¼Œå•Ÿç”¨ Binary Log      mkdir /root/configtouch /root/config/my.cnf            my.cnf (åœ¨ Master-Slave Replication Cluster è£¡ï¼Œæ¯å° MariaDB server_id éœ€è¦ä¸ä¸€æ¨£)[mariadb]log-binserver_id=1log-basename=master1binlog-format=mixed  éƒ¨ç½² Master MariaDB```bashexport IP=192.168.89.131docker run â€“name mariadb-master -p $IP:3306:3306 -v /root/config:/etc/mysql/conf.d -e MARIADB_ROOT_PASSWORD=123456 -d mariadb:10.3.32&amp;gt; æ­¤æŒ‡ä»¤ç‚ºæ¸¬è©¦ç”¨ï¼Œè‹¥æ˜¯åœ¨ Productionï¼Œè«‹è¨˜å¾—è¨­å®šåŠ ä¸Š Persistent Data å­˜æ”¾ç›®éŒ„ä»¥åŠç›¸é—œå¸³è™Ÿè¨­å®šï¼Œä¸è¦ä½¿ç”¨ Rootã€‚&amp;gt; 3. å»ºç«‹ Replication ç”¨çš„å¸³è™Ÿ```bashdocker exec -it mariadb-master bash$ mysql -u root -p123456MariaDB [(none)]&amp;gt; GRANT REPLICATION SLAVE ON *.* to replicator@&#39;%&#39; IDENTIFIED BY &#39;secret&#39;;MariaDB [(none)]&amp;gt; FLUSH PRIVILEGES;MariaDB [(none)]&amp;gt; FLUSH TABLES WITH READ LOCK;  æŸ¥çœ‹ Master è³‡è¨Šï¼Œéœ€è¨˜ä¸‹ Binary Log åç¨±    MariaDB [(none)]&amp;gt; SHOW MASTER STATUS;+ â€” â€” â€” â€” â€” â€” â€” â€” â€” + â€” â€” â€” â€” â€” + â€” â€” â€” â€” â€” â€” â€” + â€” â€” â€” â€” â€” â€” â€” â€” â€” +| File | Position | Binlog_Do_DB | Binlog_Ignore_DB |+ â€” â€” â€” â€” â€” â€” â€” â€” â€” + â€” â€” â€” â€” â€” + â€” â€” â€” â€” â€” â€” â€” + â€” â€” â€” â€” â€” â€” â€” â€” â€” +| master1-bin.000003 | 466 | | |+ â€” â€” â€” â€” â€” â€” â€” â€” â€” + â€” â€” â€” â€” â€” + â€” â€” â€” â€” â€” â€” â€” + â€” â€” â€” â€” â€” â€” â€” â€” â€” +1 row in set (0.00 sec)        ä»¥ä¸‹æ­¥é©Ÿé–‹å§‹åœ¨ Slave MariaDB ä¸Šæ“ä½œ  è¨­å®š my.cnf æª”ï¼Œå•Ÿç”¨ Binary Log    mkdir /root/configtouch /root/config/my.cnf      my.cnf (åœ¨ Master-Slave Replication Cluster è£¡ï¼Œæ¯å° MariaDB server_id éœ€è¦ä¸ä¸€æ¨£)[mariadb]server_id=2  éƒ¨ç½² Slave  MariaDB```bashexport IP=docker run â€“name mariadb-slave -p $IP:3306:3306 -v /root/config:/etc/mysql/conf.d -e MARIADB_ROOT_PASSWORD=123456 -d mariadb:10.3.32&amp;gt; æ­¤æŒ‡ä»¤ç‚ºæ¸¬è©¦ç”¨ï¼Œè‹¥æ˜¯åœ¨ Productionï¼Œè«‹è¨˜å¾—è¨­å®šåŠ ä¸Š Persistent Data å­˜æ”¾ç›®éŒ„ä»¥åŠç›¸é—œå¸³è™Ÿè¨­å®šï¼Œä¸è¦ä½¿ç”¨ Rootã€‚&amp;gt; 7. è¨­å®šé€£åˆ° Master MariaDBï¼Œä¸¦å•Ÿç”¨ Slave æœå‹™ï¼Œ `CHANGE MASTER` æ ¹æ“š Master è³‡è¨Šå¡«å¯«```bashdocker exec -it mariadb-slave bash$ mysql -u root -p123456MariaDB [(none)]&amp;gt; CHANGE MASTER TO MASTER_HOST=&#39;192.168.89.131&#39;, MASTER_USER=&#39;replicator&#39;, MASTER_PASSWORD=&#39;secret&#39;, MASTER_LOG_FILE=&#39;master1-bin.000003&#39;, MASTER_LOG_POS=466;MariaDB [(none)]&amp;gt; START SLAVE;  MASTER_LOG_FILE ä»£è¡¨è¦å»è®€ Master çš„ Binary Log åç¨±MASTER_LOG_POS ä»£è¡¨è¦å¾ Binary Log å“ªä¸€å€‹ä½ç½®é–‹å§‹åŒæ­¥ï¼Œéœ€è·Ÿ SHOW MASTER STATUS; çš„ Position  å€¼ä¸€æ¨£ã€‚      æŸ¥çœ‹ Slave è³‡è¨Š (éœ€ç¢ºèª Slave_IO_Running ä»¥åŠ Slave_SQL_Running æ˜¯å¦ç‚º Yes)      MariaDB [(none)]&amp;gt; SHOW SLAVE STATUS;              ä»¥ä¸‹æ­¥é©Ÿé–‹å§‹åœ¨ Master MariaDB ä¸Šæ“ä½œ  UNLOCK Master MariaDB Tableã€‚    MariaDB [(none)]&amp;gt; UNLOCK TABLE ;        é€™æ¨£å°±å®Œæˆï¼Œå¯ä»¥å˜—è©¦çœ‹çœ‹é€é Master é€²è¡Œå¯«å…¥å‹•ä½œï¼ŒSlave é‚£é‚Šæ˜¯å¦æœƒåŒæ­¥ã€‚```bashMariaDB [(none)]&amp;gt; CREATE DATABASE hello;MariaDB [(none)]&amp;gt; USE hello;MariaDB [hello]&amp;gt;  CREATE TABLE hellotable (id int, name varchar(10) ) ;MariaDB [hello]&amp;gt; INSERT INTO hellotable (id,name) VALUES (â€˜1â€™,â€™pohsienâ€™) ;MariaDB [hello]&amp;gt; SELECT * FROM hellotable;+â€”â€”+â€”â€”â€”+| id   | name    |+â€”â€”+â€”â€”â€”+|    1 | pohsien |+â€”â€”+â€”â€”â€”+1 row in set (0.000 sec)&amp;gt; ä»¥ä¸‹æ­¥é©Ÿé–‹å§‹åœ¨ Slave MariaDB ä¸Šæ“ä½œ11. åœ¨ Slave å¯ä»¥é¦¬ä¸Šçœ‹åˆ°å‰›å‰›åœ¨ Master å»ºç«‹çš„ DBã€Table ä»¥åŠ Recordã€‚```bashMariaDB [(none)]&amp;gt; USE hello;MariaDB [hello]&amp;gt; SELECT * FROM hellotable;+------+---------+| id   | name    |+------+---------+|    1 | pohsien |+------+---------+1 row in set (0.000 sec)  å¾ŒçºŒå¯ä»¥æ­é… HA Proxy ä»¥åŠç¨‹å¼ç«¯è¨­å®šè®€å¯«åˆ†é›¢ï¼Œè®“ç¨‹å¼å¯«å…¥è³‡æ–™æ™‚åˆ° Master ä¸Šå»å¯«ï¼Œè¦è®€çš„æ™‚å€™ï¼Œå°±é€é HA Proxy Load Balancing åˆ°ä»»ä¸€å° Slave å»è®€ï¼Œå¯ä»¥æé«˜æ•ˆç‡ä»¥åŠå¢åŠ é«˜å¯ç”¨æ€§ã€‚  ğŸ’¡ è«‹æ³¨æ„ï¼Œåœ¨ Master-Slave Replication ä¸­åŒæ­¥æ˜¯å–®å‘çš„ï¼Œä¹Ÿå°±æ˜¯åªèƒ½ Master åŒæ­¥çµ¦ Slaveï¼Œä¸¦ä¸èƒ½ Slave åŒæ­¥çµ¦ Masterï¼Œå¦‚æœä¸å°å¿ƒåœ¨ Slave å¯«å…¥è³‡æ–™ï¼Œæœƒé€ æˆ split-brain çš„åš´é‡æƒ…æ³ï¼ŒCluster åŒæ­¥æœƒå‡ºå•é¡Œã€‚Auto-FailoverMariaDB Master-Slave Replication é è¨­ä¸æ”¯æ´å‹•æ…‹ Failoverï¼Œå¦‚æœé‡åˆ°  Master æ•…éšœï¼Œéœ€è¦æ‰‹å‹•é€²è¡Œåˆ‡æ›ï¼Œå°‡ Slave å•Ÿç”¨ binlogï¼Œè®“ä»–è®Šæˆ Masterï¼Œç„¶å¾Œå‰©ä¸‹çš„ Slave å¿…é ˆè¨­å®š CHANGE MASTER ä¾†å°‡ä»–æŒ‡åˆ°æ–°çš„ Masterï¼Œçš†éœ€è¦ç®¡ç†è€…æ‰‹å‹•è¨­å®šã€‚å¦å¤–åœ¨ Load Balancer ç«¯ï¼Œåƒ HA Proxy é€™é¡å‹çš„ Load Balancerï¼Œä¹Ÿå¾ˆé›£è‡ªå‹•æ ¹æ“š MariaDB Master æˆ– Slave è§’è‰²è®Šæ›èª¿æ•´ Server Poolï¼Œæ­¥é©Ÿç›¸ç•¶ç¹ç‘£ã€‚å› æ­¤ MariaDB å®˜æ–¹é‡‹å‡ºä¸€å€‹å·¥å…· MaxScaleï¼Œä»–è£¡é¢åŒ…å«äº†è¨±å¤šæ¨¡çµ„ï¼Œä¾‹å¦‚ Monitor æ¨¡çµ„ï¼Œå¯ä»¥ç›£çœ‹ MariaDB Cluster ç‹€æ…‹ï¼Œä¸¦å¯¦ç¾ auto-failover ä»¥åŠ auto-rejoin (æ›æ‰çš„ Node æ¢å¾©å¾Œä¸»å‹•åŠ å› Cluster)ã€‚ Service æ¨¡çµ„ï¼Œå¯ä»¥å¯¦ç¾è·¯ç”±ï¼Œå°‡æµé‡å°åˆ°æ­£ç¢ºèº«ä»½çš„ MariaDB èº«ä¸Šï¼Œç•¶æœ‰ Failover ç™¼ç”Ÿå¾Œï¼Œä¹Ÿå¯ä»¥è‡ªå‹•è½‰æ›æµé‡å°å‘ï¼Œéå¸¸æ–¹ä¾¿ã€‚MaxScale è¨­å®šæ­¥é©Ÿ  æ­¤æ–‡ç« æ¡ç”¨ç‰ˆæœ¬è³‡è¨Šå¦‚ä¸‹:      MariaDB 10.3.32    Ubuntu 20.04 LTS    MaxScale 6.2.1  ç’°å¢ƒ(ç¸½å…±æœ‰å››å° VM):  Master MariaDB 192.168.89.131 (server_id: 1)  Slave MariaDB-1 192.168.89.132 (server_id: 2)  Slave MariaDB-2 192.168.89.133 (server_id: 3)  MaxScale 192.168.89.134  åƒè€ƒ MariaDB MaxScale Installation Guide å®‰è£ MaxScale ä»¥åŠè¨­å®šå®Œ MariaDB Master-Slave Clusterã€‚  åœ¨ MaxScale VM ç·¨è¼¯ MaxScale è¨­å®šæª”    $ vim /etc/maxscale.cnf        å»ºç«‹ä¸‰å° MariaDB è³‡è¨Šï¼Œ [] åç¨±å¯ä»¥ä»»æ„å–åï¼Œé€™é‚Šè¨­å®šå¾ˆåƒè¨­å®š Load Balancer çš„ Server Pool (Backend) ä¸€æ¨£ã€‚```bashâ€¦[server1]type=serveraddress=192.168.89.131port=3306protocol=MariaDBBackend[server2]type=serveraddress=192.168.89.132port=3306protocol=MariaDBBackend[server3]type=serveraddress=192.168.89.133port=3306protocol=MariaDBBackendâ€¦4. è¨­å®š Monitorï¼Œç›£æ§ MariaDB çš„ç‹€æ…‹ï¼Œå…¶ä¸­é€™è£¡ä¹Ÿå¯ä»¥è¨­å®š `auto_failover` ä»¥åŠ `auto_rejoin` ä¾†å¯¦ç¾ Master èº«ä»½è‡ªå‹•è½‰ç§»ä»¥åŠè‡ªå‹•å°‡æ’é™¤ç•°å¸¸çš„ Node é‡æ–°åŠ å› Clusterã€‚```bash...[MariaDB-Monitor]type=monitormodule=mariadbmonservers=server1,server2,server3user=rootpassword=123456monitor_interval=2000# å•Ÿç”¨è‡ªå‹• Failoverauto_failover=true# å•Ÿç”¨è‡ªå‹• rejoinauto_rejoin=true...      è¨­å®š Service (è·¯ç”±)ï¼Œé è¨­æ˜¯è®€å¯«åˆ†é–‹ï¼Œé€™é‚Šå¯ä»¥è¨­å®š Listener ä»¥åŠ Backendï¼Œå¯ä»¥å°‡è®€å¯«åˆ‡åˆ†æˆä¸åŒçš„ Listenerï¼Œä¸¦å°æ‡‰åˆ°ä¸åŒçš„ Backendã€‚    åœ¨æ­¤æˆ‘å€‘å°‡ Write çš„å‹•ä½œéƒ½å°å‘åˆ° Master MariaDB èº«ä¸Šï¼ŒRead çš„å‹•ä½œå‰‡å°å‘åˆ° Slave MariaDB èº«ä¸Šï¼ŒMaxScale æœƒè‡ªå·±åˆ¤æ–·èº«ä»½ï¼Œæ‰€ä»¥åªè¦å°‡å…¨éƒ¨ MariaDB éƒ½åŠ é€² Service å°±å¥½ã€‚    ğŸ’¡ è‹¥è¦è®€å¯«åˆ†é–‹ä¹Ÿå¿…é ˆçœ‹è‡ªå·±çš„ Application æ˜¯å¦æœ‰æ”¯æ´é€™æ¨£è¨­è¨ˆ...#--------- Services (LoadBalancr å¾Œç«¯çš„ Server Pool) ----------## çµ¦ Reqd-Only ä½¿ç”¨[Read-Only-Service]type=servicerouter=readconnroute# é€™é‚Šè¨­å®šè¦ç•¶ä½œ Backend çš„ Serverservers=server1,server2,server3user=maxscalepassword=123456# è¨­å®šè¦ä½œç‚º Backend çš„ç¨®é¡ï¼Œé€™è£¡è¡¨ç¤ºæœƒå¾ servers Group è£¡é¢æŒ‘å‡º Slave ä¾†åš LoadBalancingrouter_options=slave## çµ¦ Read-Write ä½¿ç”¨ [Read-Write-Service]type=servicerouter=readconnroute# é€™é‚Šè¨­å®šè¦ç•¶ä½œ Backend çš„ Serverservers=server1,server2,server3user=maxscalepassword=123456# è¨­å®šè¦ä½œç‚º Backend çš„ç¨®é¡ï¼Œé€™è£¡è¡¨ç¤ºæœƒå¾ servers Group è£¡é¢æŒ‘å‡º Master ä¾†åš LoadBalancingrouter_options=master#----------- Listeners (LoadBalancr å‰ç«¯çš„çª—å£) --------------[Read-Only-Listener]type=listenerservice=Read-Only-Serviceprotocol=MariaDBClientaddress=192.168.89.134port=4008[Read-Write-Listener]type=listenerservice=Read-Write-Serviceprotocol=MariaDBClientport=4006address=192.168.89.134...  ğŸ’¡ é€™é‚Šçš„ user password æ˜¯çµ¦ MaxScale ä½¿ç”¨çš„ï¼Œå› ç‚º MaxScale ä¸»è¦æ¥æ”¶ Client é€£ç·šçš„çª—å£ï¼Œæ‰€ä»¥ä»–æœƒéœ€è¦æ¬Šé™èƒ½å¤ è®€ MariaDB çš„ User è³‡è¨Šä»¥åŠé€£åˆ° MariaDB å»åšä¸€äº›æ“ä½œï¼Œä¾‹å¦‚ä¿®æ”¹ Master-Slave è¨­å®šï¼Œå¯æŸ¥çœ‹ Creating a user account for MaxScale ã€‚  å®Œæˆå¾Œé‡å•Ÿ MaxScaleï¼Œé€™æ¨£è¨­å®šå®Œä¹‹å¾Œï¼Œé€£ç·šè³‡è¨Šå¦‚ä¸‹:          Read ä½¿ç”¨çš„é€£ç·šè³‡è¨Š:  192.168.89.134:4008      Write ä½¿ç”¨çš„é€£ç·šè³‡è¨Š: 192.168.89.134.4006        systemctl restart maxscale.service                      åœ¨ MaxScale VM æŸ¥çœ‹ Monitor è³‡è¨Šï¼Œå¦‚æœæŠŠ Master é—œæ©Ÿï¼Œå¯ä»¥çœ‹åˆ° State åˆ‡æ›ï¼Œä¹Ÿå¯ä»¥åƒè€ƒ Manual Failover æ‰‹å‹•åˆ‡æ›è§’è‰² maxctrl call command mariadbmon failover Monitor ã€‚    $ maxctrl list serversâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ Server  â”‚ Address        â”‚ Port â”‚ Connections â”‚ State           â”‚ GTID     â”‚â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚ server1 â”‚ 192.168.89.131 â”‚ 3306 â”‚ 0           â”‚ Master, Running â”‚ 0-3-7224 â”‚â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚ server2 â”‚ 192.168.89.132 â”‚ 3306 â”‚ 0           â”‚ Slave, Running  â”‚ 0-3-7224 â”‚â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚ server3 â”‚ 192.168.89.133 â”‚ 3306 â”‚ 0           â”‚ Slave, Running  â”‚ 0-3-7224 â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        é€é MaxScale å­˜å– MariaDB æ¸¬è©¦ LoadBalancing æ˜¯å¦æ­£ç¢ºã€‚    $ msql -h 192.168.89.134 -P 4006 -u myuser -p$ msql -h 192.168.89.134 -P 4008 -u myuser -p        ğŸ’¡ é€™é‚Šçš„ä½¿ç”¨è€…æ˜¯çµ¦ application é€£ç·šç”¨çš„ï¼Œé€™å€‹éœ€è¦æ³¨æ„ï¼Œå› ç‚ºé€£ç·šæ–¹å¼æ˜¯: client â†’ maxscale  â†’ mariadb ï¼Œæ‰€ä»¥éœ€è¦è¨­å®šé€™å€‹ä½¿ç”¨è€…èƒ½å¾ client ç«¯ä»¥åŠ maxscale é€£åˆ° MariaDBï¼Œå¯åƒè€ƒ Creating client user accounts  è‹¥é€é 4006 port æˆåŠŸé€£åˆ° MariaDBï¼ŒæŸ¥çœ‹é€£åˆ°çš„ DB Server idï¼Œæ‡‰è©²ä¸ç®¡åœ¨å“ªè£¡é€£éƒ½æœƒæ˜¯ Master é‚£å° Nodeã€‚    MariaDB [(none)]&amp;gt; SELECT @@server_id ;+-------------+| @@server_id |+-------------+|           1 |+-------------+        è‹¥é€é 4008 port æˆåŠŸé€£åˆ° MariaDBï¼ŒæŸ¥çœ‹é€£åˆ°çš„ DB Server idï¼Œæ‡‰è©²æœƒæ˜¯ä»»ä¸€å° Slave ã€‚    MariaDB [(none)]&amp;gt; SELECT @@server_id ;+-------------+| @@server_id |+-------------+|           3 |+-------------+      MaxScale with Keepalivedç”±æ–¼ MaxScale æœƒä¸æ–·åµæ¸¬ MariaDB ç•°å¸¸ä»¥åŠæä¾› Load Balancingï¼Œå¦‚æœ MaxScale æœ¬èº«ç•°å¸¸çš„è©±ï¼Œæœƒå°è‡´é€™äº›æ©Ÿåˆ¶åœæ‰ï¼Œå› æ­¤åœ¨ Production ç’°å¢ƒ é€šå¸¸éœ€è¦å¤šå°ä¾†é”åˆ° HAã€‚MariaDB å®˜æ–¹æ¡ç”¨ Keepalived ä¾†å¯¦ç¾ MaxScale HAï¼Œå¯ä»¥åƒè€ƒ MaxScale HA setup using Keepalived and MaxCtrl ã€‚åœ–ç‰‡ä¾†æº: MaxScale HA setup using Keepalived and MaxCtrlåƒè€ƒè³‡æ–™Introduction  HA for MySQL and MariaDB - Comparing Master-Master Replication to Galera Cluster  Replication OverviewSetup Replication  Setting Up Replication  MariaDB Load Balancing with HAProxy on Centos 7  MariaDB Replication: 2 Easy Methods  How to Configure MariaDB Master-Master/Slave Replication?MaxScale  MariaDB MaxScale  MariaDB MaxScale Installation Guide  Automatic Failover With MariaDB Monitor  Connection Routing with MariaDB MaxScale  Setting up MariaDB MaxScale  MariaDB MaxScale Configuration Guide  MariaDB Load Balancing with HAProxy on Centos 7  MaxScale HA setup using Keepalived and MaxCtrl  æ–‡ç« å…§å®¹çš„è½‰è¼‰ã€é‡è£½ã€ç™¼ä½ˆï¼Œè«‹è¨»æ˜å‡ºè™•: https://pohsienshih.github.io"
  },
  
  {
    "title": "2021 å€‹äººå¹´åº¦å›é¡§",
    "url": "/blog/2021-review/",
    "categories": "Others",
    "tags": "Personal",
    "date": "2021-12-31 22:02:55 +0000",
    





    "snippet": "ä¸çŸ¥ä¸è¦ºä¸€å¹´åˆéäº†ï¼Œåˆåˆ°äº†å¹´åº•å›é¡§åŠå¯©æ€çš„æ™‚é–“ã€‚2021 ç®—æ˜¯å€‹äººæ¯”è¼ƒæ··äº‚çš„ä¸€å¹´ï¼Œä¸ç®¡æ˜¯å·¥ä½œé‚„æ˜¯å€‹äººä¸Šï¼Œè¦ºå¾—ä»Šå¹´æ•´é«”éƒ½è »æ··äº‚ï¼Œå·¥ä½œä¸Šçš„å•é¡Œæ¯”è¼ƒå¤šï¼Œå°è‡´æ²’è¾¦æ³•åˆ‡å‰²æ‹¿æç”Ÿæ´»è·Ÿå·¥ä½œï¼Œæ‰€ä»¥ä»Šå¹´éƒ½æ¯”è¼ƒå°é–‰ä¸€é»ï¼Œé€£éƒ¨è½æ ¼éƒ½åœæ“ºã€‚ä¸éé‚„å¥½åˆ°å¹´åº•æ…¢æ…¢ç©©å®šä¸‹ä¾†ï¼Œä¸”æœ‰æ©Ÿæœƒå¥½å¥½ä¼‘æ¯ï¼Œèƒ½å¤ åœä¸‹è…³æ­¥å¥½å¥½å¯©è¦–ä»Šå¹´ï¼Œä¸¦ç‚º 2022 åšæº–å‚™ã€‚ä¸éä¸ç®¡å¦‚ä½•ï¼Œ2021 å¹´éƒ½é †åˆ©çµæŸï¼Œæ˜å¹´ç¹¼çºŒåŠ æ²¹ã€‚2021 å›é¡§ä¼‘é–’åŠå…¶ä»–  å¹´åˆå› ç‚ºä¸€äº›ç§äººäº‹æƒ…é™·å…¥äº†å®Œå…¨ä½æ½®ï¼Œå¾ˆè¬è¬å‘¨é­æœ‹å‹é¼“å‹µè·Ÿæ‰“æ°£ï¼Œæ‰èƒ½å¿«é€ŸæŒ¯ä½œã€‚  æŒçºŒåƒåŠ å¥èº«èª²ï¼Œé‡è¨“ + TRX + æœ‰æ°§ï¼Œä¸éå¾Œä¾†ä¸­é–“ç–«æƒ…ä¸­æ–·ï¼Œæœ‰é»å¾©èƒ–å›ä¾†ã€‚  è²·äº†å°ˆæ¥­è­‰ç…§èª²ï¼Œæº–å‚™äº†ä¸€å…©å€‹æœˆï¼Œå®Œå…¨æ²’æ™‚é–“è€ƒï¼Œæµªè²»äº†è€ƒè©¦å·çš„éŒ¢ï¼Œæ˜å¹´è¦ç¹¼çºŒåŠªåŠ›è€ƒåˆ°ï¼  ä»Šå¹´åœ¨ç¤¾ç¾¤ä¸Šæ¯”è¼ƒæ²’æœ‰ç‰¹åˆ¥ç²¾åŠ›åƒèˆ‡ï¼Œå¸Œæœ›è‡ªå·±èƒ½æ•´é “ä¸€ä¸‹ï¼Œç„¶å¾Œå¥½å¥½å›æ­¸å”åŠ©å¤¥ä¼´ç›¸é—œäº‹å‹™ï¼å·¥ä½œæ–¹é¢  æˆåŠŸå¸¶å®Œ 6 å€‹å¯¦ç¿’ç”Ÿ(ä¸€å¹´)ï¼Œé‚„æ”¶åˆ°äº†å­¸ç”Ÿçš„æ„Ÿè¬å¡è·Ÿç¦®ç‰©ï¼Œä¸€å€‹çª©å¿ƒã€‚  ä»Šå¹´åº•é–‹å§‹å¸¶æ–°çš„å¯¦ç¿’ç”Ÿï¼Œè·Ÿå¯¦ç¿’ç”Ÿä¸€èµ·è¨è«–äº¤æµæŠ€è¡“ï¼Œæ¯æ¬¡å¸¶å¯¦ç¿’ç”Ÿéƒ½è¦ºå¾—è‡ªå·±å¥½åƒä¹Ÿå›åˆ°å­¸ç”Ÿæ™‚æœŸã€‚  å·¥ä½œè·å‹™å„ç¨®è®Šå‹•ï¼Œé¢è‡¨æ–°çš„æŒ‘æˆ°ï¼Œé›–ç„¶å‰›å¥½è—‰æ­¤æ©Ÿæœƒè·Ÿå„ç¨®ä¸åŒå°ˆæ¥­çš„äººåˆä½œï¼Œä½†ä¹Ÿå› ç‚ºè®Šå‹•é—œä¿‚ï¼Œå¿ƒæ…‹ä¸Šå¾ˆæ··äº‚ï¼Œä¸€ç›´ä¸æ–·å†èª¿æ•´ã€‚  å®Œæˆäº†å¹¾å€‹æ¡ˆå­ï¼Œé›–ç„¶éƒ½å¾ˆé©šéšªï¼Œä½†é‚„å¥½éƒ½é †åˆ©çµæŸï¼Œä¸”å…¶ä¸­ä¸€å€‹æ‡‰è©²æ˜¯ç›®å‰ç¢°éæ¯”è¼ƒè¤‡é›œçš„æ¡ˆå­ï¼Œé›–ç„¶éç¨‹éå¸¸ç—›è‹¦ï¼Œä½†é™¤äº†æå‡å°ˆæ¥­åŠç²å¾—ç¶“é©—ä»¥å¤–ï¼Œä¹Ÿé”æˆäº†æˆå°±ã€‚  å·¥ä½œä¸ŠåŒæ¨£æ˜¯å”åŠ© Cloud Native ç›¸é—œäº‹å‹™ï¼Œæ¯”èµ·å»å¹´åƒèˆ‡äº†æ›´å¤šå›°é›£çš„å°ˆæ¡ˆè·Ÿäº‹å‹™ï¼Œå› æ­¤ä»Šå¹´é€éå·¥ä½œï¼Œå¢åŠ è »å¤šå¯¦æˆ°ç¶“é©—è·Ÿå°ˆæ¥­çŸ¥è­˜ï¼Œæ„Ÿè¦ºè·Ÿå»å¹´æ¯”é€²æ­¥è¨±å¤šï¼Œä»é ˆç¹¼çºŒåŠªåŠ›ã€‚  æ‹äº†äººç”Ÿç¬¬ä¸€éš» MVï¼Œé‚„æ“”ä»»ä¸€æ—¥é¼“æ‰‹ xDã€‚  ç¬¬ä¸€æ¬¡åˆ°æ”å½±æ£šéŒ„è£½æ•™è‚²è¨“ç·´ï¼Œå¾ˆæ–°é®®ã€‚  ç¬¬ä¸€æ¬¡åƒèˆ‡äº†å…¬å¸è¨˜è€…æœƒï¼Œé›–ç„¶æ˜¯ç•¶å·¥ä½œäººå“¡ï¼Œä½†æ˜¯é‚„æ˜¯è¦‹è­˜åˆ°å¾ˆå¤§çš„é™£ä»—ã€‚2022 å±•æœ›  åŠ å¼·å°ˆæ¥­æŠ€è¡“ä»¥åŠè‹±æ–‡èƒ½åŠ›ï¼Œå˜—è©¦æ›´å¤šæŒ‘æˆ°èˆ‡æ©Ÿæœƒã€‚  æ›´æ–°åœæ“ºå·²ä¹…çš„éƒ¨è½æ ¼ï¼Œå¼·è¿«è‡ªå·±å¤šæ’°å¯«æ–‡ç« ã€‚  é¤Šæˆé–±è®€ç¿’æ…£ï¼Œå¼·è¿«è‡ªå·±å­¸ç¿’ã€‚  å˜—è©¦å¹³è¡¡å·¥ä½œè·Ÿç”Ÿæ´»ï¼Œ åŠ å¼·æ™‚é–“ç®¡ç†è·Ÿåˆ†é…ï¼Œç•™çµ¦æ›´å¤šçš„æ™‚é–“åšè‡ªå·±æƒ³åšçš„äº‹ä»¥åŠä¼‘é–’ã€‚  æŒçºŒç¶­æŒé‹å‹•è·Ÿæ§åˆ¶é£²é£Ÿï¼Œå¸Œæœ›èƒ½æå‡è‚Œè‚‰é‡ï¼Œç„¶å¾Œå˜—è©¦æ›´å¤šç¨®é‹å‹•è·Ÿæ´»å‹•ã€‚  æ–‡ç« å…§å®¹çš„è½‰è¼‰ã€é‡è£½ã€ç™¼ä½ˆï¼Œè«‹è¨»æ˜å‡ºè™•: https://pohsienshih.github.io"
  },
  
  {
    "title": "2020 å€‹äººå¹´åº¦å›é¡§",
    "url": "/blog/2020-review/",
    "categories": "Others",
    "tags": "Personal",
    "date": "2020-12-31 16:25:20 +0000",
    





    "snippet": "2020 å›é¡§2020 å¹´çœŸçš„æ˜¯è®“äººå°è±¡æ·±åˆ»çš„ä¸€å¹´ï¼Œå› ç‚ºæ–°å† è‚ºç‚å½±éŸ¿é—œä¿‚ï¼Œè¨±å¤šè¨ˆç•«éƒ½è¢«å½±éŸ¿ï¼Œä½†å°±æ•´é«”ä¸Šä¾†çœ‹ï¼Œä»Šå¹´å°æˆ‘å€‹äººä¾†èªªä»ç„¶ç®—æ˜¯ä¸€å€‹è »æœ‰æ”¶ç©«çš„ä¸€å¹´ï¼Œåšäº†è¨±å¤šå˜—è©¦ä»¥åŠé”å„ç¨®æˆå°±ã€‚å·¥ä½œæ–¹é¢ä»Šå¹´åˆæ›äº†æ–°å…¬å¸ï¼Œç®—æ˜¯ä¸€å€‹æ–°çš„é–‹å§‹ï¼Œé›–ç„¶å¿™åˆ°ç‚¸è£‚ï¼Œé€²å»é‚„æ²’éè©¦ç”¨æœŸï¼Œå°±å¿™åˆ°å¥½åƒéäº†å¥½å¹¾å¹´ä¸€æ¨£ï¼Œä½†å»æ˜¯å¿™å¾—æœ‰æ„ç¾©ï¼Œéå¸¸å……å¯¦ã€‚  æ–°å…¬å¸: æ›äº†æ–°å…¬å¸ï¼Œä¸€å€‹æ–°çš„é–‹å§‹ã€‚  Work From Home åˆé«”é©—: ç”±æ–¼éƒ¨é–€è¼ƒå½ˆæ€§åŠ ä¸Šç–«æƒ…é—œä¿‚ï¼Œå› æ­¤å¯ä»¥åœ¨å®¶ä¸Šç­ï¼Œç®—æ˜¯ä¸€å€‹æ–°çš„é«”é©—ï¼Œä¸éé›–ç„¶ Work From Home å¾ˆè‡ªç”±ï¼Œä½†æ˜¯ä¹Ÿæœ‰ç›¸å°çš„ç¼ºé»ï¼Œä¾‹å¦‚åŒäº‹æºé€šè¨è«–å›°é›£ã€æ²’æœ‰ä¸‹ç­çš„æ„Ÿè¦ºæˆ–é‚Šç·£åŒ– QQ ä¹‹é¡çš„ã€‚  å¸¶å¯¦ç¿’ç”Ÿ: ä¸€æ¬¡å¸¶äº† 8 å€‹å¯¦ç¿’ç”Ÿ(å¤§å­¸ç”Ÿ)ï¼Œé›–ç„¶å·¥ä½œé‡å¢åŠ äº†ï¼Œä½†æ˜¯è·Ÿé€™ç¾¤å¹´è¼•å¤§å­¸ç”Ÿä¸€èµ· co-work ä¹Ÿç‚ºå·¥ä½œæ°›åœå¸¶ä¾†äº†å¹¾åˆ†æ¨‚è¶£ã€‚  åŠå¤œç³»çµ±å‡ç‰ˆ: ç¬¬ä¸€æ¬¡é«”é©—åŠå¤œåˆ°å®¢æˆ¶é‚£é‚Šå‡ Patchï¼Œè·Ÿå®¢æˆ¶å¾¹å¤œé•·è«‡(?)ï¼Œç„¶å¾Œä¸€åŒå¥®æˆ°æ•‘ç³»çµ±åˆ°æ—©ä¸Šã€‚  å”åŠ©å…¬å¸å„ç¨®å¤§å¤§å°å°çš„æ•™è‚²è¨“ç·´ï¼Œè¨“ç·´è³‡æ–™æ•´ç†ã€å£æ¢è·Ÿå°é¢¨çš„å¥½æ©Ÿæœƒã€‚  å°ˆæ¥­éƒ¨åˆ†: ç›®å‰åœ¨å…¬å¸é‚„æ˜¯è² è²¬ Kubernetes ç›¸é—œæ¥­å‹™ï¼Œå„ç¨®ç ”ç©¶ Kubernetesï¼Œæ„Ÿè¦ºæ¯”å»å¹´é‚„æ›´åŠ ç†Ÿæ‚‰ç›¸é—œé‹ä½œï¼Œä½†ä»éœ€è¦ç¹¼çºŒå­¸ç¿’ç²¾é€²ã€‚  æˆåŠŸç²å¾— Red Hat EX280 OpenShift è­‰ç…§ã€‚ç¤¾ç¾¤æ–¹é¢ (Cloud Native Taiwan User Group)ä»Šå¹´ç®—æ˜¯æ¯”è¼ƒå®Œæ•´çš„åƒèˆ‡äº†ä¸€æ•´å¹´çš„ç¤¾ç¾¤æ´»å‹•ï¼Œå¾æ¯å€‹æœˆçš„ Meetupã€æ“ºæ”¤ã€COSCUP åˆ°å¹´æœ«æ™šæœƒï¼Œå„ç¨®å®Œæ•´åƒèˆ‡ã€‚  ç¬¬ä¸€æ¬¡æ“”ä»» COSCUP CNTUG ç¤¾ç¾¤è² è²¬äºº: æ“”ä»» COISCUP 2020 CNTUG ç¤¾ç¾¤è² è²¬äººï¼Œè² è²¬æ¥æ´½è·Ÿè™•ç†ä¸€äº› COSCUP äº‹å‹™ã€‚é€™éƒ¨åˆ†çœŸçš„è »è¾›è‹¦çš„ï¼ŒåŠ ä¸Šåˆå¡åˆ°å¾ˆå¤šå…¶ä»–äº‹æƒ…ï¼Œä¸éé‚„å¥½æœ‰ Phil Huang å°é£›æ©Ÿ ä»¥åŠå…¶ä»–ç¤¾ç¾¤å¤¥ä¼´å”åŠ©ï¼Œä¸ç„¶æˆ‘å¯èƒ½ç›´æ¥æ­»å»ã€‚  ç¬¬ä¸€æ¬¡åƒèˆ‡å¹´æœ«æ™šæœƒ: ç¬¬ä¸€æ¬¡ä»¥å·¥ä½œäººå“¡èº«ä»½å”åŒèˆ‰è¾¦äº†ç¤¾ç¾¤å¹´æœ«æ™šæœƒï¼Œé›–ç„¶é€™éƒ¨åˆ†æˆ‘æ¯”è¼ƒæ²’å¹«ä¸Šä»€éº¼å¿™ï¼Œä½†æ˜¯ç¤¾ç¾¤èƒ½å¤ é †åˆ©èˆ‰è¾¦å¹´æœ«æ™šæœƒï¼Œæœ‰ä¸€ç¨® 2020 Happy Ending çš„æ„Ÿè¦ºã€‚  Meetup Talk (GitOps: Flux Introduction): ä»Šå¹´åªæœ‰åœ¨å¹´åˆæ™‚ï¼Œè¬›äº†ä¸€å ´ Meetup Talkï¼Œå¾Œé¢å°±å› ç‚ºæ›å…¬å¸ï¼Œå„ç¨®ç†Ÿæ‚‰è·Ÿè™•ç†å…¬å¸äº‹ï¼Œæ¯”è¼ƒæ²’ä»€éº¼æ™‚é–“ç ”ç©¶è·Ÿåˆ†äº«ã€‚  å”åŠ©æ“ºæ”¤: ä»Šå¹´åŒæ¨£å”åŠ©äº†ç¤¾ç¾¤åœ¨ Kubernetes Summit æ“ºæ”¤ï¼Œèªè­˜äº†ä¸å°‘äººä»¥åŠäº¤æ›äº†è¨±å¤šè²¼ç´™ã€‚  SRE è®€æ›¸æœƒ: ä»Šå¹´æœ‰å¹¸åƒèˆ‡ SRE è®€æ›¸æœƒï¼Œé›–ç„¶æœ‰æ™‚å€™å¤ªå¿™é€²åº¦è½å¾Œï¼Œä½†æ˜¯æ¯æ¬¡åƒèˆ‡éƒ½å­¸ç¿’åˆ°è¨±å¤šå¯¶è²´çš„ç¶­é‹ç¶“é©—ã€‚ä¼‘é–’åŠå…¶ä»–ä»Šå¹´é«”é©—å„ç¨®æ–°æ´»å‹•ï¼Œé”æˆè¨±å¤šäººç”Ÿæˆå°±ã€‚  æ”€å²©(æŠ±çŸ³) é¦–æ¬¡çªç ´ LV2 ç­‰ç´š xDã€‚  å–å¾—äººç”Ÿä¸­ç¬¬ä¸€å¼µæ°´è‚ºæ½›æ°´è­‰ç…§ï¼Œæ½›æ°´èœé³¥ä¸€æšã€‚  è²·äº†äººç”Ÿä¸­ç¬¬ä¸€å°æ”å½±æ©Ÿ (DJI Osmo Ppocket)ï¼Œvlog éŒ„èµ·ä¾†ï¼  å¹´åº•åƒèˆ‡å°å—é‡é¤ï¼Œèªè­˜è¨±å¤šå°å—çš„æœ‹å‹ï¼Œå¤§å®¶ä¸€èµ·ã„ã„§ã„¤ xD  å ±åäº†å¥èº«æˆ¿åœ˜èª²(TRX åŠå„ç¨®æœ‰æ°§)ï¼Œåˆé«”é©—ã€‚  æŠŠç©ºæ‹æ©Ÿå¼„åˆ°ç‚¸æ©Ÿï¼Œæ‰åˆ°å±±è£¡æ¶ˆå¤±ã€‚  æˆåŠŸå®Œæˆ VoiceTube Hero åŠå¹´é›¶å…ƒæŒ‘æˆ°ï¼Œé‚„æ¨å‘è¨±å¤šäººå»åƒåŠ ã€‚  è²·äº†äººç”Ÿä¸­ç¬¬ä¸€å° MacBook Proï¼Œå¸Œæœ›å¯ä»¥æˆ° 10 å¹´ã€‚  æˆåŠŸå°‡å®¶è£¡æ”¹é€ æˆè¾¦å…¬ç’°å¢ƒï¼Œç­†é›» + é›™è¢å¹• + è¢å¹•æ¶ + äººé«”å·¥å­¸æ¤…ã€‚2021 å±•æœ›  å¢å¼·å°ˆæ¥­èƒ½åŠ›éƒ¨åˆ†ï¼Œæå‡å„æ–¹é¢ä¸è¶³é»ã€‚  å¤šæ’°å¯«æ–‡ç« ï¼Œè¨˜éŒ„ç”Ÿæ´»ç‘£äº‹è·Ÿå°ˆæ¥­ç­†è¨˜ã€‚  å¤šå‡ºä¾† Conference æˆ–æ˜¯ Meetup åˆ†äº«ï¼Œæå‡èƒ½è¦‹åº¦åŠæ“´å±•æ›´å¤šäººè„ˆã€‚  å¤šè²¢ç»é–‹æºå°ˆæ¡ˆï¼Œç·´ç¿’åƒèˆ‡é€²å»ã€‚  å¢å¼·è‹±æ–‡èƒ½åŠ›ï¼Œè®“å£èªªèƒ½å†æ›´é †ä¸€é»ã€‚  å˜—è©¦å„ç¨®æ–°çš„æ´»å‹•ï¼Œé”æˆæ›´å¤šäººç”Ÿæˆå°±ã€‚  æŒçºŒç¶­æŒé‹å‹•è·Ÿæ§åˆ¶é£²é£Ÿã€‚çµèªç”±æ–¼ä»Šå¹´æ›å·¥ä½œé—œä¿‚ï¼Œæ•´é«”è®Šå¾—å¾ˆå¿™ç¢Œï¼Œæ™‚é–“ä¸€ä¸‹å°±éäº†ï¼Œæ¯å¤©éƒ½éå¾—å¾ˆå……å¯¦ï¼Œå·¥ä½œéƒ¨åˆ†è‡ªå·±èªç‚ºä¹Ÿè¡¨ç¾å¾—é‚„ä¸éŒ¯ï¼Œå„æ–¹é¢éƒ½æˆé•·ä¸å°‘ï¼Œä¹Ÿåœ¨å·¥ä½œä¸Šèªè­˜è¨±å¤šè²´äººã€‚æ¯”è¼ƒéœ€è¦æ”¹é€²çš„åœ°æ–¹æ˜¯ï¼ŒèŠ±å¤ªå¤šæ™‚é–“åœ¨å·¥ä½œä¸Šï¼Œå°è‡´é‚„æœ‰æ›´å¤šæƒ³åšçš„äº‹éƒ½æ²’è¾¦æ³•åšï¼Œå¸Œæœ›æ˜å¹´èƒ½å¤ å†åŠ å¼·æ™‚é–“ç®¡ç†ï¼Œä¸¦åŒæ™‚å…¼é¡§äº‹æ¥­åŠç”Ÿæ´»ã€‚ä»Šå¹´å¾ˆå¹¸é‹çµè­˜è¨±å¤šé‡è¦çš„æœ‹å‹åŠè²´äººï¼Œæˆ‘è¦ºå¾—å°æ–¼æˆ‘äººç”ŸåŠç”Ÿæ´»æ…‹åº¦æœ‰è »å¤§çš„å½±éŸ¿ï¼Œé€™æ‡‰è©²æ˜¯ä»Šå¹´æœ€å¤§çš„æ”¶ç©«ã€‚æœ€å¾Œï¼Œ2020 å¹´é †åˆ©çµæŸï¼Œæ˜å¹´ç¹¼çºŒåŠ æ²¹ã€‚  æ–‡ç« å…§å®¹çš„è½‰è¼‰ã€é‡è£½ã€ç™¼ä½ˆï¼Œè«‹è¨»æ˜å‡ºè™•: https://pohsienshih.github.io"
  },
  
  {
    "title": "2020 VoiceTube Hero é›¶å…ƒæŒ‘æˆ°å¿ƒå¾—",
    "url": "/blog/2020-voicetube-hero/",
    "categories": "Others",
    "tags": "Personal",
    "date": "2020-08-11 00:00:00 +0000",
    





    "snippet": "ä»Šå¹´äºŒæœˆçš„æ™‚å€™ï¼Œæƒ³èªªåŠ å¼·è‹±æ–‡ï¼Œå ±åäº† VoiceTube Hero æŒ‘æˆ°ï¼Œç„¶å¾Œé‚„ç›´æ¥å ±åç•¶æ™‚ç¬¬å…«å±†æœ€é•·çš„ 6 å€‹æœˆ 90 å ‚èª²æŒ‘æˆ°ã€‚ç„¶å¾Œå› ç‚ºæ€•æ²’å‹•åŠ›æ‰€ä»¥æŠ“äº†å…¶ä»–æœ‹å‹ä¸€èµ·æŒ‘æˆ°ï¼Œé‚„å‰µå€‹ç¾¤çµ„å¤§å®¶æ¯å¤©äº’ç›¸æé†’è¦ä¸Šèª²ã€‚é€™å€‹æŒ‘æˆ°ä¸»è¦æ˜¯åœ¨æœŸé™å…§(6å€‹æœˆå…§)ï¼Œç¬¦åˆä»¥ä¸‹æ¢ä»¶ï¼Œå°±å¯ä»¥å…¨é¡é€€è²»ï¼š  ä¸Šå®Œ 90 å ‚èª²  æ¯å ‚èª²è¤‡ç¿’ 2 æ¬¡ï¼Œä¹Ÿå°±æ˜¯åŠå¹´è¦ä¸Š 90 * 3 = 270 æ¬¡  æ¯é€±è‡³å°‘è¦ä¸Š 12 å ‚èª²ï¼Œåªè¦ä¸€é€±å¤±æ•—ï¼Œç›´æ¥æŒ‘æˆ°å¤±æ•—ä¸€å ‚èª²æœƒæä¾›å½±ç‰‡ï¼Œå½±ç‰‡çœ‹å®Œä¹‹å¾Œï¼Œåšé¸æ“‡é¡Œ/å…‹æ¼å­—/æ–‡æ³•/å£èªª/å–®å­—æ¸¬é©—ï¼Œå¹³å‡ä¸€å ‚èª²ç´„ 30-40 åˆ†é˜å·¦å³ï¼Œæœ‰æ™‚å€™é‡åˆ°å¾ˆé›£çš„æœƒæ›´ä¹…ã€‚VoiceTube æœ‰æä¾› Web è·Ÿ Appï¼Œæ‰€ä»¥å¯ä»¥æ ¹æ“šè‡ªå·±æ–¹ä¾¿æ±ºå®šè¦ä½¿ç”¨å“ªä¸€å€‹å¹³å°ä¸Šèª²ã€‚ä¸€é–‹å§‹æƒ³èªªä¸€å¤© 2 å ‚èª²é‚„å¥½ï¼Œæ¯å¤©èŠ±å€‹ 1~2 å°æ™‚ä¸Šï¼Œå¼·è¿«è‡ªå·±å­¸ç¿’ï¼Œä½†æ˜¯æœ‰æ™‚å€™ç•¶é€±å¾ˆå¿™å°±æœƒéå¸¸ç´¯ï¼Œä¾‹å¦‚åŠ ç­åˆ°æ™šä¸Šå›å®¶é‚„è¦è£œä¸Šè‹±æ–‡ï¼Œæˆ–æ˜¯å¯èƒ½ç•¶é€±å‡ºéŠé‚„è¦æ“”å¿ƒè‹±æ–‡æ²’ä¸Šå®Œï¼Œç„¶å¾Œåœ¨é£¯åº—ç”¨æ‰‹æ©Ÿä¸Šèª²ã€‚æ‰€ä»¥åˆ°æœ€å¾Œè »é•·è®Šæˆç©åˆ°å…­æ—¥åœ¨åšï¼Œé›–ç„¶é€™æ¨£ä¸å¤ªå¥½ xDé€™åŠå¹´å‰›å¥½å¡åˆ°ç¤¾ç¾¤æ´»å‹•éå¸¸å¿™ï¼Œæ•´å€‹æ™‚é–“å¡åœ¨ä¸€èµ·ï¼Œé›–ç„¶ç—›è‹¦ï¼Œä¸éå‰›å¥½è¶é€™æ©Ÿæœƒå¼·è¿«è‡ªå·±ç·´è‹±æ–‡ï¼Œçµ‚æ–¼åœ¨ 08/09 é€šéæŒ‘æˆ°ï¼ŒçµæŸé€™åŠå¹´çš„æŒ‘æˆ°ã€‚å¿ƒå¾—æ•´é«”ä¾†èªªæŒ‘æˆ°ä¸éŒ¯ï¼Œèª²ç¨‹è¦åŠƒè·Ÿç³»çµ±ä¹Ÿæ„Ÿè¦ºå¾—å‡ºå¾ˆç”¨å¿ƒï¼Œèª²ç¨‹ä¹Ÿéƒ½æ˜¯æ¡ç”¨å¾ˆæœ‰æ„ç¾©çš„å½±ç‰‡ï¼Œä¾‹å¦‚ï¼šç¢³äº¤æ˜“ã€ä»‹ç´¹åœ‹å®¶æ—…éŠã€è‚¡ç¥¨ä»‹ç´¹æˆ–æ˜¯ä¸€äº›å†·çŸ¥è­˜ï¼Œé™¤äº†å­¸è‹±æ–‡ä¹Ÿå­¸åˆ°è¨±å¤šçŸ¥è­˜ï¼Œå¯æƒœçš„æ˜¯èª²ç¨‹ä¸»è¦æ˜¯è¨“ç·´å–®å­—è·Ÿè½åŠ›å±…å¤šï¼Œé‡å°å¯«ä½œæˆ–æ˜¯å…¶ä»–æ–‡æ³•éƒ¨åˆ†æ¯”è¼ƒè–„å¼±ä¸€é»(æœ€è¿‘æœ‰æ–°ç‰ˆæœ¬çš„ç³»çµ±ï¼Œä¸çŸ¥é“æœƒä¸æœƒä¸ä¸€æ¨£)ï¼Œä¸éå…¶ä»–éƒ¨åˆ†éƒ½é‚„åšå¾—ä¸éŒ¯ï¼Œå¾ˆç”¨å¿ƒï¼Œè€Œä¸”ä¸Šå®Œèª²ä¹‹å¾Œï¼Œé‚„æœƒæŠŠç­†è¨˜ã€èª²ç¨‹è³‡æ–™ã€å–®å­—æœ¬ã€æ–‡æ³•æœ¬éƒ½å®Œæ•´æ‰“åŒ…å¥½çµ¦ä½ ä¸‹è¼‰ï¼Œè®“ä½ ä¹‹å¾Œèª²ç¨‹çµæŸå¾Œéƒ½å¯ä»¥è¤‡ç¿’ï¼Œå¾ˆè²¼å¿ƒã€‚ç•¶åˆåƒåŠ æŒ‘æˆ°ä¸»è¦æ˜¯å¼·è¿«è‡ªå·±è®€ä¸€ä¸‹è‹±æ–‡ï¼Œä¸éåœ¨å¾ˆå¿™çš„æ™‚å€™çœŸçš„æœƒè »è¾›è‹¦çš„ï¼Œæœƒæ“”å¿ƒè‹±æ–‡ä¸Šä¸å®Œï¼Œæ‰€ä»¥å°±è®Šæˆä¸ç®¡å†ç´¯éƒ½è¦åœ¨ç¦®æ‹œæ—¥ 23:59 åˆ†ä»¥å‰åšå®Œ 12 å ‚èª²ï¼Œé€™ä¹Ÿæ„è­˜åˆ°æ™‚é–“è¦åŠƒçš„é‡è¦æ€§ï¼å¦‚æœè®€è€…æœ‰èˆˆè¶£ä¹Ÿå¯ä»¥æŒ‘æˆ°çœ‹çœ‹ï¼Œå¯ä»¥è©¦åšçœ‹çœ‹å®˜ç¶²çš„é¡Œç›®ï¼ŒæŒ‘æˆ°å®Œä¹‹å¾Œé™¤äº†èƒ½åŠ å¼·è‹±æ–‡é‚„èƒ½é€€è²»ï¼Œè »ä¸éŒ¯çš„ï¼æœ€å¾Œï¼Œé›–ç„¶é€šéäº†æŒ‘æˆ°ï¼Œä½†è¦ºå¾—è‡ªå·±è‹±æ–‡èƒ½åŠ›é‚„éœ€è¦å†åŠ å¼·ï¼Œé‚„ä¸å¤ªå¤ ï¼Œç¹¼çºŒæŒçºŒå­¸ç¿’ï¼Œå¦å¤–è¬è¬ä¸€èµ·æŒ‘æˆ°çš„æˆ°å‹ï¼Œé€™é™£å­çš„äº’ç›¸å‹¸é€€ï¼Œé‚„å¥½æœ€å¾Œå¤§å®¶éƒ½ä¸€èµ·é€šéæŒ‘æˆ°ï¼  æ–‡ç« å…§å®¹çš„è½‰è¼‰ã€é‡è£½ã€ç™¼ä½ˆï¼Œè«‹è¨»æ˜å‡ºè™•: https://pohsienshih.github.io"
  },
  
  {
    "title": "End-to-End Testing for Kubernetes (Part II) - Conformance Testing",
    "url": "/blog/e2e-testing-for-kubernetes-part-ii/",
    "categories": "Kubernetes",
    "tags": "kubernetes, testing",
    "date": "2019-10-26 20:17:14 +0000",
    





    "snippet": "æ­¤ç³»åˆ—æ–‡ç‚º E2E Testing for Kubernetes çš„ä»‹ç´¹ï¼Œå¦‚å°šæœªçœ‹éå‰ä¸€ç¯‡æ–‡ç« ï¼Œå¯ä»¥åƒè€ƒåº•ä¸‹é€£çµ:  End-to-End Testing for Kubernetes (Part I) - kubetest  End-to-End Testing for Kubernetes (Part II) - Conformance TestingConformance Testingåœ¨å‰ä¸€ç¯‡æ–‡ç« è£¡ï¼Œæˆ‘å€‘ä»‹ç´¹åˆ°å¦‚ä½•ä½¿ç”¨ kubetest åŸ·è¡Œ Kubernetes E2E Test ï¼Œ kubetest æœƒä½¿ç”¨ Kubernetes Binary é–‹å•Ÿæ–°çš„ä¹¾æ·¨ Cluster å»åšæ¸¬è©¦ã€‚åœ¨é€™ä¸€ç¯‡æ–‡ç« è£¡æˆ‘å€‘æœƒä»‹ç´¹å¦‚ä½•å°è‡ªå·±éƒ¨ç½²çš„ Cluster åš E2E Testã€‚Conformance Testing ï¼Œä¸€è‡´æ€§æ¸¬è©¦ï¼Œé€™å€‹æ¸¬è©¦æ˜¯ E2E Testing åº•ä¸‹çš„ä¸€å€‹å­é›†åˆï¼Œå…¶ä¸»è¦æ˜¯é©—è­‰ Kubernetes æ ¸å¿ƒçš„åŠŸèƒ½æˆ–æ˜¯ GA ç‰ˆæœ¬çš„ API ï¼Œä¹Ÿå°±æ˜¯ä¸ç®¡ä»»ä½•ç‰ˆæœ¬çš„ Cluster éƒ½æ‡‰è©²è¦èƒ½ä½¿ç”¨çš„åŸºæœ¬åŠŸèƒ½ã€‚é€™å€‹æ¸¬è©¦ä¹Ÿå¯ä»¥è§£è®€æˆ: ã€Œä¸ç®¡ä»»ä½•ç‰ˆæœ¬æˆ–å¹³å°çš„ Cluster åœ¨ç¶“é Conformance Test ä¹‹å¾Œçš„çµæœéƒ½è¦æ˜¯ä¸€è‡´çš„ã€ã€‚ç”±æ–¼ Conformance Test æ¯”è¼ƒä¸é™å®šæ–¼ Cluster ç‰ˆæœ¬æˆ–æ˜¯å¹³å°ï¼Œå› æ­¤å¯ä»¥ç”¨ä¾†æ¸¬è©¦è‡ªå·±éƒ¨ç½²çš„ Cluster æ˜¯å¦æ˜¯æ­£å¸¸çš„ã€‚å¦å¤– Conformance Test ä¹Ÿæ˜¯éç ´å£æ€§çš„æ¸¬è©¦ï¼Œä¸æœƒåŒ…å« [Disruptive] çš„æ¸¬é …ï¼Œå› æ­¤ä¸¦ä¸æœƒå½±éŸ¿åˆ° Cluster ä¸Šé¢é‹è¡Œçš„å…¶ä»–æœå‹™ã€‚  åœ¨å‰ä¸€ç¯‡æ–‡ç« æœ‰æåˆ° Kind of Test ï¼Œå…¶ä¸­ä¸€å€‹ Label æ˜¯ [Conformance] ï¼Œé€™å€‹å°±æ˜¯ä»£è¡¨ Conformance Test çš„æ¸¬é …ã€‚Conformance Test RequirementsKubernetes æœ‰åˆ—å‡º Conformance Test éœ€è¦æ»¿è¶³çš„æ¢ä»¶ï¼Œæœ‰éå¸¸å¤šé …ï¼Œå…¶ä¸­åŒ…å«åªæ¸¬è©¦ GA ç‰ˆæœ¬çš„ API ã€å¿…é ˆå¯ä»¥ä½¿ç”¨åœ¨ä»»ä½• Provider ä¸Šã€ä¸éœ€è¦é€£æ¥åˆ° Public Network ã€ä¸éœ€è¦ Privileged æ¬Šé™æˆ–æ˜¯ä¸èƒ½åŒ…å«å…·æœ‰é—œæ–¼ Node æˆ–æ˜¯å¹³å°ç›¸ä¾æ€§çš„æ¸¬è©¦ï¼Œå¦‚ç¡¬é«”è¦æ ¼é™åˆ¶ç­‰ç­‰ã€‚ä¸éé€™ä»½æ–‡ä»¶ä¹Ÿæœ‰æåˆ°å¦‚æœå°‡ä¾†æœ‰è¶³å¤ çš„æ¸¬é …èƒ½æ¸¬è©¦ Cluster ä¹‹å¾Œï¼Œæœƒæ…¢æ…¢çš„æ”¾å¯¬é€™äº›æ¢ä»¶ï¼ŒåŠ å…¥æ›´å¤šçš„æ¸¬é …é€²ä¾†ã€‚  it tests only GA, non-optional features or APIs (e.g., no alpha or beta endpoints, no feature flags required, no deprecated features)  it does not require direct access to kubeletâ€™s API to pass (nor does it require indirect access via the API server node proxy endpoint); it MAY use the kubelet API for debugging purposes upon failure  it works for all providers (e.g., no SkipIfProviderIs/SkipUnlessProviderIs calls)  it is non-privileged (e.g., does not require root on nodes, access to raw network interfaces, or Cluster admin permissions)  it works without access to the public internet (short of whatever is required to pre-pull images for conformance tests)â€¦å¦‚æœæƒ³äº†è§£æ›´ç´°éƒ¨çš„éœ€æ±‚æ¢ä»¶å¯ä»¥åƒè€ƒ Conformance Test Requirementsã€‚Exexcutionæˆ‘å€‘åŒæ¨£å¯ä»¥ä½¿ç”¨ kubetest ä¾†åŸ·è¡Œ Conformance Test ï¼ŒåŸ·è¡Œæ­¥é©Ÿéå¸¸ç°¡å–®ï¼Œåªéœ€è¦é™å®šåªåŸ·è¡Œ [Conformance] Label çš„æ¸¬é …å³å¯ã€‚  å‰ç½®ä½œæ¥­# Checking your kubernetes server version$ kubectl get versionServer Version: version.Info{Major:&quot;1&quot;, Minor:&quot;15&quot;, GitVersion:&quot;v1.15.3&quot;, GitCommit:&quot;2d3c76f9091b6bec110a5e63777c332469e0cba2&quot;, GitTreeState:&quot;clean&quot;, BuildDate:&quot;2019-08-19T11:05:50Z&quot;, GoVersion:&quot;go1.12.9&quot;, Compiler:&quot;gc&quot;, Platform:&quot;linux/amd64&quot;}# Change Kubernetes repository to the specific version$ cd $GOPATH/src/k8s.io/kubernetes$ git checkout v1.15.3# Build e2e.test, ginkgo and kubectl# é€™é‚Šä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨ã€€kubetest --build ï¼Œåªæ˜¯ Conformance Testing ä¸éœ€è¦ # build é€™éº¼å¤šæ±è¥¿ã€‚$ make WHAT=&quot;test/e2e/e2e.test vendor/github.com/onsi/ginkgo/ginkgo cmd/kubectl&quot;é€™é‚Šéœ€è¦æ³¨æ„çš„æ˜¯: kubetest æœƒç›´æ¥æŠ“ Kubernetes ç›®éŒ„ Build å‡ºä¾†çš„ kubectl ç•¶ä½œ Client å»åšæ¸¬è©¦ï¼Œ å¦‚æœ kubectl çš„ç‰ˆæœ¬ ( GitVersion ) èˆ‡ Server ç‰ˆæœ¬ä¸ä¸€è‡´ï¼Œ kubetest æœƒå ±éŒ¯ï¼Œå› æ­¤æœ€å¥½å…ˆå°‡ Kubernetes åˆ‡æ›åˆ°å°æ‡‰ç‰ˆæœ¬çš„ branch/tag ï¼Œå† build e2e.test è·Ÿ kubectl æ¯”è¼ƒå¥½ã€‚å¦‚æœçœŸçš„æƒ³è¦ç”¨ä¸åŒç‰ˆæœ¬çš„ Client (kubectl) åšæ¸¬è©¦ï¼Œå¯ä»¥åœ¨ kubetest å¾Œé¢åŠ ä¸Š --check-version-skew=false flagï¼Œä½†æ˜¯ä¸å»ºè­°é€™æ¨£åšï¼Œå› ç‚ºå¯èƒ½æœƒå½±éŸ¿æ¸¬è©¦çš„æº–ç¢ºåº¦ã€‚2.åŸ·è¡Œæ¸¬è©¦# Setup for conformance tests$ export KUBECONFIG=/path/to/kubeconfig$ export KUBERNETES_CONFORMANCE_TEST=y# Run testing$ kubetest --provider=skeleton --test --test_args=&quot;--ginkgo.focus=\\[Conformance\\]&quot;# Run testing with different version of client$ kubetest --provider=skeleton --test --test_args=&quot;--ginkgo.focus=\\[Conformance\\]&quot; --check-version-skew=falseç•¶è¨­å®š KUBERNETES_CONFORMANCE_TEST=y æ™‚ï¼Œ kubernetes/hack/ginkgo-e2e.sh å°±æœƒå¾ KUBECONFIG ä¾†å–å¾— Master ä½ç½®ï¼Œå› æ­¤ä¸å†éœ€è¦ä½¿ç”¨ --deployment flag å»å‘Šè¨´ kubetest (Ginkgo) Cluster è³‡è¨Šã€‚--provider=skeleton: é€™é‚Šçš„ skeleton ç­†è€…ä¹Ÿä¸ç¢ºå®šå¦‚ä½•è§£é‡‹ï¼Œé¡ä¼¼æ–¼åªæœ‰éª¨æ¶ï¼Œè¡¨ç¤ºä½ çš„ Cluster åªæœ‰æä¾› API ä»‹é¢(ç›´æ¥æä¾›kubeconfigå°±å¯ä»¥å­˜å–åˆ° Cluster )ï¼Œè€Œçœ‹ä¸åˆ°æ•´å€‹æ•´é«”çš„ Cluster ï¼Œé€™é‚Šå¦‚æœè®€è€…æœ‰æ›´å¥½çš„è§£é‡‹çš„è©±ï¼Œå†éº»ç…©å¹«æˆ‘ä¿®æ­£ä¸€ä¸‹ï¼Œè¬è¬ã€‚  ç­†è€…å¯¦éš›åŸ·è¡Œ Conformance Test å¤§æ¦‚èŠ±äº† 3~4 å°æ™‚å·¦å³ï¼Œä¸éåŒæ¨£å¯èƒ½è·Ÿç­†è€… Homelab ç¡¬é«”è³‡æºæœ‰é—œï¼Œå¯¦éš›ä¸Šæ‡‰è©²ä¸éœ€è¦é€™å¤šæ™‚é–“ã€‚Test Listsç”±æ–¼ Conformance Testing æ˜¯ E2E Testing çš„å­é›†åˆï¼Œå› æ­¤å…¶æ¸¬é …ä¸€æ¨£ä½æ–¼ kubernetes/test/e2e/ è£¡ï¼Œä¸é Kubernetes æœ‰ç‰¹åˆ¥å°‡ Conformance Testing çš„æ¸¬è©¦é …ç›®æ¸…å–®è¨˜éŒ„åœ¨ conformance.txt åº•ä¸‹ï¼Œå¦‚æœè¦ç´°çœ‹æ¯ä¸€å€‹æ¸¬é …å…§å®¹çš„è©±ä¹Ÿå¯ä»¥åƒè€ƒ Kubernetes Conformance Test Suite - v1.9ã€‚kubernetes/test/conformance/testdata/conformance.txtæŸ¥çœ‹å…¶ä¸­ä¸€å€‹ spec ï¼Œæœƒç™¼ç¾ Conformance Test æ˜¯ä½¿ç”¨ framework.ConformanceIt() ï¼Œè€Œä¸æ˜¯åƒ E2E Test ä½¿ç”¨ Ginkgo.It() ã€‚kubernetes/test/e2e/common/pods.go   ...   /*      Release : v1.9      Testname: Pods, assigned hostip      Description: Create a Pod. Pod status MUST return successfully and contains a valid IP address.   */   framework.ConformanceIt(&quot;should get a host IP [NodeConformance]&quot;, func() {      name := &quot;pod-hostip-&quot; + string(uuid.NewUUID())      testHostIP(podClient, &amp;amp;v1.Pod{         ObjectMeta: metav1.ObjectMeta{            Name: name,         },         Spec: v1.PodSpec{            Containers: []v1.Container{               {                  Name:  &quot;test&quot;,                  Image: imageutils.GetPauseImageName(),               },            },         },      })   })   ...å¯¦éš›å»çœ‹ framework.ConformanceIt()  å…§å®¹ (ä½æ–¼ kubernetes/test/e2e/framework/framework.go) ï¼Œæœƒç™¼ç¾ ConformanceIt() çš„åŠŸèƒ½ç‚ºè²¼ [Conformance] Label ï¼Œè‡³æ–¼ç‚ºä»€éº¼è¦ç‰¹åˆ¥é¡å¤–ç”¨ä¸€å€‹ function ä¾†è²¼ Label ï¼Œé€™é‚Šå®˜æ–¹è¨»è§£æ˜¯æ–¹ä¾¿éœæ…‹åˆ†æç”¨ï¼Œä¸éç­†è€…èªç‚ºé€™æ¨£ä¹Ÿå¯ä»¥æ–¹ä¾¿ä¹‹å¾Œé‡å° Conformance Test ä½œä¿®æ”¹ï¼Œä¾‹å¦‚å°æ‰€æœ‰çš„ Conformance Test åŠ ä¸Šé¡å¤–çš„ Label æˆ–æ˜¯å¢åŠ ä»€éº¼å…§å®¹ï¼Œç›´æ¥é€é ConformanceIt() å°±å¯ä»¥çµ±ä¸€ä¿®æ”¹äº†ã€‚kubernetes/test/e2e/framework/framework.go   ...   // ConformanceIt is wrapper function for ginkgo It.  Adds &quot;[Conformance]&quot; tag and makes static analysis easier.   func ConformanceIt(text string, body interface{}, timeout ...float64) bool {      return ginkgo.It(text+&quot; [Conformance]&quot;, body, timeout...)   }   ...Write Your Own Testæ¥ä¸‹ä¾†ä»‹ç´¹å¦‚ä½•æ’°å¯«è‡ªå·±çš„æ¸¬é … ï¼ŒåŸºæœ¬ä¸Šéƒ½è·Ÿ E2E Test å·®ä¸å¤šï¼Œä¸éä¸ç¢ºå®šæ˜¯ä¸æ˜¯å› ç‚ºä¸€èˆ¬ä½¿ç”¨è€…æ¯”è¼ƒå¸¸ä½¿ç”¨åˆ° Conformance Test ï¼Œ é€™éƒ¨åˆ†æ–‡ä»¶æ¯” E2E Test å®Œæ•´è¨±å¤šã€‚æˆ‘å€‘å°‡æ’°å¯«æ¸¬è©¦åˆ†æˆä¸‰å€‹æ­¥é©Ÿï¼š  æ’°å¯«æ¸¬è©¦ã€‚  ç¢ºä¿ä½ çš„æ¸¬è©¦æœ‰ç¬¦åˆ [Conformance Test Requirements](#Conformance-Test-Requirementsï¼‰ã€‚  ç™¼é€ PR ã€‚ç´°éƒ¨æµç¨‹å¯åƒè€ƒ Promoting Tests to Conformance ã€‚1. æ’°å¯«æ¸¬è©¦åœ¨æ’°å¯« Conformance Test æ™‚å¿…é ˆéµå®ˆå…©å€‹çš„æ ¼å¼ï¼Œä¸€å€‹æ˜¯ä¸€å®šè¦ä½¿ç”¨ framework.ConformanceIt() ï¼Œä¸è¦ä½¿ç”¨ Ginkgo.It ã€‚ å¦ä¸€å€‹æ˜¯ä¸€å®šè¦æ’°å¯« metadata ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š/*  Release : v1.15.3  Testname: Kubelet: log output  Description: By default the stdout and stderr from the process being  executed in a pod MUST be sent to the pod&#39;s logs.*/framework.ConformanceIt(&quot;it should print the output to logs&quot;, func() {  ...})æ¸¬è©¦æ”¾ç½®ä½ç½®ä»¥åŠ Import ä½ç½®éƒ½èˆ‡æˆ‘å€‘ä¹‹å‰æ’°å¯«çš„ E2E Test ç›¸åŒï¼Œå› æ­¤é€™é‚Šåªç°¡å–®åˆ—å‡ºæµç¨‹ï¼Œç´°ç¯€éƒ¨åˆ†å¯ä»¥åƒè€ƒå‰ä¸€ç¯‡æ–‡ç« ã€‚1. åœ¨ kubernets/test/e2e å»ºç«‹è³‡æ–™å¤¾ä¾†æ”¾ç½®ä½ çš„æ¸¬è©¦æª”ã€‚2. åœ¨ kubernets/test/e2e/e2e_test.go ä»¥åŠ kubernets/test/e2e/BUILD import ä½ çš„æ¸¬è©¦ã€‚3. åœ¨ kubernets/test/e2e/&amp;lt;yourfolder&amp;gt;/ ä¸‹æ–°å¢ä½ çš„ BUILD æª”ã€‚4. æ›´æ–° conformance.txt5. ä½¿ç”¨ kubetest --build é‡æ–° build e2e.testæ¯”è¼ƒéœ€è¦æ³¨æ„æ˜¯ç¬¬å››æ­¥å¿…é ˆåŸ·è¡Œä»¥ä¸‹æŒ‡ä»¤ä¾†æ›´æ–° conformance.txt :$ go run test/conformance/walk.go test/e2e &amp;gt; test/conformance/testdata/conformance.txt  è«‹è¨˜å¾—åœ¨æ’°å¯«è‡ªå·±çš„æ¸¬è©¦æ™‚ä¸€å®šè¦åŠ ä¸Šå°æ‡‰ Label ï¼Œå¦‚ [Slow] ã€ [Serial] ã€ [Disruptive] ç­‰ç­‰ï¼Œé€™æ¨£å¯ä»¥è®“æ¸¬è©¦äººå“¡æ›´åŠ äº†è§£ä½ çš„æ¸¬é …çš„ç‰¹æ€§ï¼Œå¦‚æœä¸ç¢ºå®šè¦åŠ ä¸Šå“ªäº› Label å¯ä»¥åœ¨ slack æˆ–æ˜¯ ç™¼ä½ˆ Issue / PR æ™‚ï¼Œæ¨™è¨» #kinds-of-tests  ä¾†è©¢å•ã€‚2. ç¢ºä¿ä½ çš„æ¸¬è©¦æœ‰ç¬¦åˆ [Conformance Test Requirements]é€™éƒ¨åˆ†å¯ä»¥åƒè€ƒ Conformance Test Requirementsã€‚3. ç™¼é€ PR1. PR Title:  &quot;Promote xxx e2e test to Conformance&quot;2. æ’°å¯«æ¸¬é …çš„è³‡è¨Šä»¥åŠ metadataï¼Œä¸¦åŠ ä¸Š PR Label ä»¥åŠæ¨™è¨»è² è²¬çš„ SIGã€‚     - /area conformance     - @kubernetes/sig-architecture-pr-reviews @kubernetes/sig-xxx-pr-reviews        @kubernetes/cncf-conformance-wg    - Any necessary information (e.g.  ä¾‹å¦‚è§£é‡‹ç‚ºä»€éº¼æ¸¬é …ç„¡æ³•åœ¨ Windows åŸ·è¡Œ)3. å°‡ PR åŠ åˆ° SIG Architecture&#39;s Conformance Test Review board çš„ To Triage æ¬„ä½ã€‚4. ä½¿ç”¨ /test pull-kubernetes-e2e-aks-engine-azure-windows ä¾†æ¸¬è©¦é …ç›®èƒ½å¦æ­£å¸¸è·‘åœ¨ Windows Node ä¸Š  Conformance Test Review boardFor WindowsComforance Testing ä¸¦æ²’æœ‰å¼·åˆ¶è¦æ±‚æ¸¬é …ä¸€å®šè¦æ”¯æ´ Windows Node ï¼Œä½†æ˜¯æ—¢ç„¶ Kubernetes æœ‰æ”¯æ´ Windows ï¼Œé‚£é‚„æ˜¯å¿…é ˆè¦èƒ½å¤ å° Windows Node åš Conformance Test ã€‚åœ¨ç¾æœ‰çš„æ¸¬é …ä¸­ï¼Œå¤§éƒ¨åˆ†çš„æ¸¬é …éƒ½æ˜¯å¯ä»¥åœ¨ Windows Node åŸ·è¡Œçš„ï¼Œåªæœ‰å°‘éƒ¨åˆ†è²¼ä¸Š [LinuxOnly] çš„æ¸¬é …æ˜¯ä¸èƒ½è·‘åœ¨ Windows ä¸Šçš„ã€‚åœ¨æ’°å¯«è‡ªå·±çš„æ¸¬è©¦æ™‚ï¼Œå¦‚æœä¸ç¢ºå®š Linux Node å’Œ Windows Node åœ¨æ¸¬è©¦åŸ·è¡Œä¸Šçš„å·®ç•°æˆ–æ˜¯ä¸ç¢ºå®šä½ å¯«çš„æ¸¬é …æ˜¯å¦å¯ä»¥é‹è¡Œåœ¨ Windows çš„è©±ï¼Œå¯ä»¥åƒè€ƒ Windows &amp;amp; Linux Considerations ã€‚å¦‚æœæ’°å¯«çš„æ¸¬è©¦ä¸æ”¯æ´ Windows ï¼Œä¸€å®šè¦æ¨™è¨» [LinuxOnly] Labelï¼Œä¸”åœ¨é€PRæ™‚å¯«æ¸…æ¥šç‚ºä½•ä¸èƒ½è·‘åœ¨ Windows Node ä¸Šï¼Œè®“ Reviewer çŸ¥é“ã€‚VMware Tanzu (Heptio) Sonobuoyå¦å¤–ä¸€å€‹å¸¸è¦‹çš„ Kubernetes Conformance Testing Tool æ˜¯ç”± VMware Tanzu (Heptio) é–‹ç™¼çš„ Sonobuoy ã€‚ Sonobuoy æä¾›æ¯” kubetest æ›´æ–¹ä¾¿çš„ä»‹é¢ä¾†åš Conformance Test ï¼Œåªéœ€è¦ç°¡å–®å¹¾è¡ŒæŒ‡ä»¤å°±å¯ä»¥åŸ·è¡Œæ¸¬è©¦ï¼Œæ¸¬è©¦é …ç›®ä¹Ÿèˆ‡ kubetest ä½¿ç”¨çš„ ( kubernetes/test/e2e/... ) æ˜¯å®Œå…¨ä¸€æ¨£çš„ï¼Œå·®åˆ¥åœ¨æ–¼ Sonobuoy æ˜¯é å…ˆå°‡æ¸¬é …å…¨éƒ¨æ”¾åˆ° Docker Image è£¡é¢ï¼Œå› æ­¤ä¸éœ€è¦åƒ kubetest éœ€è¦ç‰¹åˆ¥ Build e2e.testï¼Œä¸ééœ€è¦æ³¨æ„çš„æ˜¯ Sonobuoy åªæ”¯æ´å‰ä¸‰æ–°çš„ Kubernetes ç‰ˆæœ¬ã€‚Sonobuoy WebsiteCertified KubernetesSonobuoy åŒæ™‚ä¹Ÿæ˜¯ CNCF å®˜æ–¹ç”¨ä¾†èªè­‰ Kubernetes Cluster çš„ Conformance Testing Toolï¼Œä¼æ¥­å¯ä»¥ä½¿ç”¨ Sonobuoy ä¾†é©—è­‰è‡ªå·±é–‹ç™¼çš„ Kubernetes éƒ¨ç½²å·¥å…·ä½ˆå‡ºä¾†çš„ Cluster ï¼Œå¦‚æœé€šéæ¸¬è©¦å¯ä»¥å°‡çµæœæäº¤åˆ° GitHub ï¼Œè©²éƒ¨ç½²å·¥å…·å°±å¯ä»¥ç²å¾— CNCF çš„èªè­‰æ¨™ç« ï¼Œä¸¦é¡¯ç¤ºåœ¨ CNCF å®˜ç¶²ä¸Šï¼Œè©³ç´°é©—è­‰æµç¨‹å¯ä»¥åƒè€ƒ Certified Kubernetes ã€‚ExecutionSonobuoy åŸ·è¡Œæ–¹å¼ä¹Ÿå¾ˆç°¡å–®ï¼Œåªéœ€è¦è¨­å®š KUBECONFIG ç„¶å¾ŒåŸ·è¡Œ sonobuoy run å°±å¯ä»¥è·‘ Conformance Test äº†ã€‚$ export KUBECONFIG=/path/to/kubeconfig$ go get -u -v github.com/heptio/sonobuoy# Start testing and wait until they are finished run:$ sonobuoy run --wait# Get the result$ results=$(sonobuoy retrieve)$ sonobuoy e2e $results# Delete the objects deployed by sonobuoy$ sonobuoy deleteResultSonobuoy åŸ·è¡Œçµæœå ±å‘Šå¤§è‡´æ¶æ§‹å¦‚ä¸‹( Sonobuoy Snapshot Layout )ï¼šservergroups.json: ç´€éŒ„ Kubernetes API è³‡è¨Šserverversion.json: ç´€éŒ„ Kubernetes Cluster ç‰ˆæœ¬è³‡è¨Šhostsæ”¾ç½®æ¯å€‹ Node çš„ Configuration ( configz.json )è·Ÿå¥åº·ç‹€æ…‹ ( healthz.json )meta  config.json: æ”¾ç½® Sonobuoy çš„è¨­å®šæª”ã€‚  query-time.json: Sonobuoy åœ¨è™•ç†å„ç¨® Resource çš„åæ‡‰æ™‚é–“ï¼Œé¡ä¼¼ Performenace Testing ã€‚  run.log: SonobuoyåŸ·è¡Œçš„ log ï¼Œæ³¨æ„é€™ä¸æ˜¯ Kubernetes Logã€‚pluginsæ”¾ç½® Plugins çš„è©³ç´°è³‡è¨Šã€‚podlogsæ”¾ç½® Pod çš„ Log ï¼Œæ³¨æ„é€™è£¡é è¨­åªæœƒæœ‰ Sonobuoy ç”¢ç”Ÿçš„ Pod çš„ Logã€‚resourcesæ”¾ç½® Kubernetes Cluster çš„ Resource è³‡è¨Šã€‚Cluster: æ”¾æ‰€æœ‰ä¸å±¬æ–¼ä»»ä½• Namespaces çš„ Resourcesï¼Œå¦‚ RoleBinding ã€ Namespaces ç­‰ç­‰ã€‚ns: æ”¾å„å€‹ä¸åŒ Namespaces çš„ Resourcesã€‚é€™é‚Šæ˜¯ä¾ç…§ Resource ç¨®é¡å»ä½œåˆ†é¡ï¼Œä¸€å€‹ç¨®é¡å°±æ˜¯ä¸€å€‹ JSON æª”ï¼Œä¾‹å¦‚ pohsien namespace è£¡é¢æœ‰100å€‹ Pod ï¼Œ Sonobuoy å°±æœƒåœ¨ resources/ns/pohsien/pods.json æ”¾100å€‹ Pod è³‡è¨Šï¼Œä¸¦ä¸æœƒæœ‰100å€‹ JSON æª”ã€‚Sonobuoy vs kubetestSonobuoy æä¾›äº†æ¯” kubetest æ›´åŠ ç°¡å–®çš„æ–¹å¼åŸ·è¡Œ Conformance Testï¼Œå…¶ä¸éœ€è¦ Build Kubernetes Binary ï¼Œä¹Ÿä¸éœ€è¦æ¯”è¼ƒéº»ç…©çš„æ­¥é©ŸåŸ·è¡Œæ¸¬è©¦ã€‚è¼¸å‡ºçµæœéƒ¨åˆ†ï¼ŒSonobuoy ä¹Ÿæä¾›å¾ˆå®Œå–„çš„ Output æ©Ÿåˆ¶ï¼Œæ–¹ä¾¿æ¸¬è©¦äººå“¡å»æŸ¥çœ‹æ¸¬è©¦çµæœã€‚å› ç‚ºä¸Šè¿°çš„å„ªé»ï¼Œæ‰€ä»¥ Sonobuoy æˆç‚ºäº†ç›®å‰ä¸»æµçš„ Kubernetes Conformance Testing Tool ã€‚ä½†æ˜¯ç”±æ–¼ Sonobuoy ç•¢ç«Ÿæ˜¯ç¬¬ä¸‰æ–¹çš„å·¥å…·ï¼Œå®ƒæœƒå¾ Kubernetes å®˜æ–¹ç›®éŒ„å–å¾—æ¸¬é …ä»¥åŠéœ€è¦çš„è³‡æ–™ä¸¦æ”¾ç½®åœ¨ Sonobuoy Docker Image ï¼Œé€™æå‡äº†ä½¿ç”¨ä¸Šæ–¹ä¾¿æ€§ï¼Œä½†ä¹Ÿå°è‡´å…¶å¯èƒ½æœƒæ²’è¾¦æ³•å–å¾—æœ€æ–°çš„æ¸¬è©¦é …ç›®ã€‚ä¸»è¦å› ç‚º Kubernetes æ›´æ–°é€Ÿåº¦éå¸¸å¿«ï¼Œåœ¨æ¯ä¸€æ¬¡çš„æ›´æ–°ä¹‹å¾Œï¼Œ Sonobuoy éƒ½æœƒéœ€è¦å»æ›´æ–° Imageï¼Œè€Œåœ¨ç­‰å¾… Sonobuoy æ›´æ–°é€™æ®µæ™‚é–“æ¸¬é …å°±æœƒå‡ºç¾è½å·®ã€‚ä¸éç­†è€…èªç‚ºå¦‚æœæ²’æœ‰è¦æ¸¬è©¦æœ€æ–°ç‰ˆæœ¬çš„ Cluster ï¼Œå°±æ¯”è¼ƒä¸éœ€è¦æ“”å¿ƒé€™å€‹å•é¡Œï¼Œæˆ–è‘—æ˜¯å¯ä»¥è¨­å®šæ’ç¨‹ä¸€æ®µæ™‚é–“æ›´æ–° Sonobuoy ï¼Œç„¶å¾Œå†æ¬¡åšæ¸¬è©¦ã€‚Summaryåœ¨é€™ç³»åˆ—æ–‡æˆ‘å€‘ä»‹ç´¹äº† Kubernets End to End Testing ï¼ŒåŒ…æ‹¬æ€ä½¿ç”¨ kubetest åŸ·è¡Œ E2E Test ä»¥åŠ Conformance Test ï¼Œä¹Ÿç°¡å–®ä»‹ç´¹äº†å¦‚ä½•æ’°å¯«è‡ªå·±çš„æ¸¬é …ï¼Œæœ€å¾Œä¹Ÿä»‹ç´¹å¦‚ä½•ä½¿ç”¨ CNCF å®˜æ–¹çš„ Comformance Testing Tool - Sonobuoy ã€‚E2E Testing æ˜¯åœ¨ä¼æ¥­å°å…¥ Kubernetes æµç¨‹ä¸­æ˜¯ç›¸ç•¶é‡è¦çš„ä¸€æ­¥ï¼Œç„¡è«–æ˜¯ä½¿ç”¨ä»€éº¼å·¥å…·éƒ¨ç½²ï¼Œå»ºè­°éƒ½ä½¿ç”¨ E2E Testing ä¾†é©—è­‰ Cluster æ˜¯å¦æ­£å¸¸ï¼Œé€™æ¨£ç•¶ç™¼ç”Ÿä»»ä½•å•é¡Œæ™‚ï¼Œæ¯”è¼ƒå¯ä»¥æ’é™¤æ‰ Cluster æœ¬èº«çš„å•é¡Œï¼Œæ¸›å°‘å•é¡Œå®šä½çš„æˆæœ¬ã€‚å¦å¤–ä¹Ÿå¯ä»¥å®šæœŸçš„åŸ·è¡Œ E2E Testing / Conformance Testing æˆ–æ˜¯ç›´æ¥å°‡æ¸¬è©¦æ•´åˆé€² CI/CD æµç¨‹è£¡ï¼Œä¸éæœ€å¥½æ ¹æ“šè‡ªå·±çš„ç’°å¢ƒç‹€æ³ä¾†è©•ä¼°ï¼Œé›–ç„¶ Conformance Testing æ˜¯ç„¡ç ´å£æ€§çš„æ¸¬è©¦ï¼Œä½†æ˜¯ç›´æ¥å°æ–¼ Production ç’°å¢ƒå»åšæ¸¬è©¦å…¶å¯¦é‚„æ˜¯æœƒæœ‰ä¸€äº›é¢¨éšª (ä¾‹å¦‚å½±éŸ¿æ•ˆèƒ½æˆ–æ˜¯éé æœŸå…§éŒ¯èª¤ç­‰ç­‰) ï¼Œå› æ­¤é‚„æ˜¯éœ€è¦ç‰¹åˆ¥æ³¨æ„ï¼Œæˆ–è‘—æ˜¯ä¹Ÿå¯ä»¥åœ¨æ¸¬è©¦å‰ï¼Œå…ˆå°‡é‡è¦æœå‹™è½‰ç§»å‡ºå»ï¼Œå¾…æ¸¬è©¦å®Œæˆå¾Œå†è½‰ç§»å›ä¾†ï¼Œä¹Ÿæ˜¯ä¸€å€‹æ–¹æ³•ï¼Œå¯¦éš›åŸ·è¡Œæ–¹å¼å¯ä»¥æ ¹æ“šè‡ªå·±çš„ç’°å¢ƒå»åšè©•ä¼°ã€‚References  Conformance Testing in Kubernetes  Kubernetes Conformance Test Suite - v1.9  Conformance.txt  Sonobuoy  CNCF - Certified Kubernetes  æ–‡ç« å…§å®¹çš„è½‰è¼‰ã€é‡è£½ã€ç™¼ä½ˆï¼Œè«‹è¨»æ˜å‡ºè™•: https://pohsienshih.github.io"
  },
  
  {
    "title": "End-to-End Testing for Kubernetes (Part I) - kubetest",
    "url": "/blog/e2e-testing-for-kubernetes-part-i/",
    "categories": "Kubernetes",
    "tags": "kubernetes, testing",
    "date": "2019-10-25 17:16:19 +0000",
    





    "snippet": "ç¾ä»Š Kubernetes Cluster éƒ¨ç½²æ–¹å¼è¶Šä¾†è¶Šå¤šç¨®ï¼Œéƒ¨ç½²é–€æª»ä¹Ÿè¶Šä¾†è¶Šä½ï¼Œä½†æ˜¯åœ¨éƒ¨ç½²å®Œä¹‹å¾Œè¦å¦‚ä½•ç¢ºèªè‡ªå·±çš„ Cluster çœŸçš„æ˜¯æ­£å¸¸å¯ç”¨çš„ï¼Ÿ å¤§å¤šæ•¸çš„äºº(åŒ…å«ç­†è€…ä»¥å‰)éƒ½æ˜¯ç°¡å–®éƒ¨ç½²ä¸€äº› Deployment æˆ–æ˜¯ Service çœ‹æ˜¯å¦æœ‰ running å°±èªç‚º Cluster æ˜¯æ­£å¸¸çš„ï¼Œæˆ–æ˜¯éƒ¨ç½²æ™‚æ²’æœ‰çœ‹åˆ°ä»€éº¼éŒ¯èª¤è¨Šæ¯å°±è¦ºå¾—æ²’äº‹ï¼Œä½†æ˜¯é€™æ¨£æ˜¯ä¸å¤ªè¶³å¤ çš„ï¼Œå› ç‚ºæœ‰å¯èƒ½å£æ‰çš„æ˜¯ä¸€äº›ä¸å¸¸ä½¿ç”¨çš„åŠŸèƒ½æˆ–æ˜¯äººå·¥æ¯”è¼ƒé›£å·²ç™¼ç¾çš„å•é¡Œï¼Œé€™æ¨£ä¹‹å¾Œå¦‚æœä½¿ç”¨è€…éƒ¨ç½²æ‡‰ç”¨æ™‚å‰›å¥½ä½¿ç”¨åˆ°ç›¸é—œåŠŸèƒ½ï¼Œç™¼ç”Ÿå•é¡Œå°‡æœƒå¾ˆé›£æŸ¥æ‰¾ã€‚ç‚ºäº†ç¢ºèª Cluster åŠŸèƒ½æ˜¯å¦æ­£å¸¸ï¼Œæˆ‘å€‘å¯ä»¥é‡å° Cluster åšå®Œæ•´çš„æ¸¬è©¦ï¼Œæ¸¬è©¦å„å€‹APIæ˜¯å¦æ­£å¸¸ï¼Œä½†æ˜¯ç­†è€…æŸ¥äº†ä¸€ä¸‹ç™¼ç¾ç¶²è·¯ä¸Šæ¯”è¼ƒå°‘é—œæ–¼ Kubernetes æ¸¬è©¦çš„è©³ç´°è³‡è¨Šï¼Œå› æ­¤èŠ±äº†ä¸€é»æ™‚é–“ç ”ç©¶ä¸¦ç´€éŒ„åœ¨æ­¤ç³»åˆ—æ–‡ç« ã€‚  æ³¨æ„ï¼Œ Kubernetes çš„æ¸¬è©¦æœ‰éå¸¸å¤šç¨®å±¤é¢ï¼Œä¾‹å¦‚ï¼š Unit Testing ã€ Integration Testing ã€ E2E Testing ã€ Performance/Benchmark Testing ã€ Load Testing ã€ Stress Testing æˆ–æ˜¯ Security Testingï¼Œä½†æ˜¯åœ¨æ­¤ç³»åˆ—æ–‡ä¸­ï¼Œå¼·èª¿çš„æ˜¯æ¸¬è©¦ Cluster çš„åŠŸèƒ½æ˜¯å¦æ­£å¸¸ï¼Œå› æ­¤é‡é»æœƒæ”¾åœ¨ E2E Testing ä¸Šã€‚E2E Testing for Kubernetes:  End-to-End Testing for Kubernetes (Part I) - kubetest  End-to-End Testing for Kubernetes (Part II) - Conformance Testingå¦å¤–ç­†è€…åœ¨ Cloud Native Taiwan User Group (CNTUG) Meetup #20 ä¹Ÿæœ‰ä¸€å ´ talk æ˜¯åœ¨ä»‹ç´¹é€™å€‹ä¸»é¡Œï¼Œå¤§å®¶å¯ä»¥åƒè€ƒä»¥ä¸‹çš„ç°¡å ±ï¼šSoftware Testingä¸€èˆ¬ Software Testing å¯åˆ†æˆä¸‰ç¨®æ¯”è¼ƒå¸¸è¦‹çš„æ¸¬è©¦æ–¹å¼:Unit Testingå–®å…ƒæ¸¬è©¦ï¼Œæ¸¬è©¦å–®ä¸€åŠŸèƒ½æˆ–æ˜¯æŸå€‹å‡½æ•¸ï¼Œä¾‹å¦‚æ¸¬è©¦ç™»å…¥åŠŸèƒ½æ˜¯å¦æ­£å¸¸ã€‚é€™ç¨®æ¸¬è©¦ç¶­åº¦æ¯”è¼ƒå°ï¼Œæ¸¬è©¦ç¨‹å¼çš„æ’°å¯«ä¹Ÿæ¯”è¼ƒå–®ç´”ä¸€é»ã€‚Integration Testingæ•´åˆæ¸¬è©¦ï¼Œé€™ç¨®é€šå¸¸æ˜¯æ¸¬è©¦å¤šå€‹å…·æœ‰é—œè¯æˆ–ç›¸ä¾æ€§çš„åŠŸèƒ½(æˆ–å‡½æ•¸)æ•´åˆä¹‹å¾Œæ˜¯å¦æ­£å¸¸ï¼Œç¶­åº¦æ¯”å–®å…ƒæ¸¬è©¦é‚„è¦å¤§ä¸€é»ã€‚End to End (E2E) Testingå‰é¢å–®å…ƒæ¸¬è©¦è·Ÿæ•´åˆæ¸¬è©¦å…©å€‹éƒ½æ˜¯æ¯”è¼ƒåå‘ Developer é©—è­‰ CodeÂ æˆ–æ˜¯å‡½æ•¸æ˜¯å¦æ­£å¸¸ï¼Œè€Œ E2E æ¸¬è©¦æ¯”è¼ƒåå‘ä»¥ä½¿ç”¨è€…è§’åº¦å»æ“ä½œç³»çµ±ï¼Œæ¸¬è©¦äººå“¡æŠŠè‡ªå·±ç•¶æˆä¸€èˆ¬ä½¿ç”¨è€…å»å°æ•´å€‹ç³»çµ±åšæ“ä½œï¼Œæ¸¬è©¦æ¯å€‹åŠŸèƒ½æ˜¯å¦æ­£å¸¸ã€‚ç”±æ–¼æˆ‘å€‘åªæ˜¯è¦ç¢ºèª Kubernetes Cluster åŠŸèƒ½æ˜¯å¦æ­£å¸¸ï¼Œä¸¦ä¸æ˜¯è¦é–‹ç™¼ï¼Œå› æ­¤æ­¤ç³»åˆ—æ–‡æœƒè‘—é‡åœ¨ Kubernetes E2E Testingã€‚SIG-TestingSpecial Interest Group (SIG) æ˜¯ç”±ä¸€ç¾¤å¿—åŒé“åˆä¾†è‡ªå„å…¬å¸å„é ˜åŸŸçš„äººçµ„æˆçš„çµ„ç¹”æˆ–æ˜¯åœ˜é«”ï¼Œä¸»è¦æ˜¯ä¸€èµ·å­¸ç¿’æŸå€‹æŠ€è¡“ã€å°æŸå€‹æŠ€è¡“é€²è¡Œæ¢è¨æˆ–æ˜¯ä¸€èµ·ç¶­è­·æŸå€‹å°ˆæ¡ˆï¼Œé¡ä¼¼ç¤¾ç¾¤çš„æ¦‚å¿µï¼Œé€™äº› SIG å¯èƒ½ä¹Ÿæœƒå®šæœŸçš„èˆ‰è¾¦ Meetup æˆ–æ˜¯ ConferenceÂ ç­‰ã€‚ Kubernetes Community æ˜¯ç”±è¨±å¤šä¸åŒçš„ SIG çµ„æˆï¼Œä¾‹å¦‚: sig-network æ˜¯è² è²¬ Kubernetes ä¸­ç¶²è·¯éƒ¨åˆ†ã€ sig-docs æ˜¯è² è²¬æ–‡ä»¶ã€è€Œ sig-storage æ˜¯è² è²¬å„²å­˜éƒ¨åˆ†ç­‰ç­‰ã€‚æ¯å€‹ SIG éƒ½æœ‰è‡ªå·±è² è²¬çš„ Subproject ï¼Œé€™äº› Subproject å¯èƒ½æ˜¯æ–‡ä»¶æ’°å¯«ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯ Code æ’°å¯«ã€‚é™¤äº† SIG ä¹‹å¤–ï¼ŒKubnernetes Communityé‚„æœ‰å…¶ä»–çš„ Subgroups å¦‚ Committees ã€Working Groups è·Ÿ User Groups ç­‰ç­‰ï¼Œå¦‚æœå°æ–¼ Kubernetes Community çµ„æˆæœ‰èˆˆè¶£ï¼Œå¯ä»¥åƒè€ƒ: Kubernetes Community Governance Model ã€‚å¦‚æœæƒ³äº†è§£ Kubernetes ä¸­å„å€‹ SIGï¼Œå¯ä»¥åƒè€ƒ: Kubernetes SIGs and Working Groupsã€‚å¦‚æœæƒ³äº†è§£å„å€‹ SIG è² è²¬çš„ Subproject ï¼Œå¯ä»¥åƒè€ƒ: Subprojects of each SIGsã€‚åœ¨çœ¾å¤š SIG ç•¶ä¸­ï¼Œè² è²¬ Kubernetes æ¸¬è©¦çš„æ˜¯ sig-testing ï¼Œ sig-testing è² è²¬è¨±å¤šçŸ¥åçš„ subprojects ï¼Œå¦‚ç®¡ç†      Kubernetes project çš„ CI/CD ç³»çµ± - prow ï¼Œä»¥åŠéƒ¨ç½² K8s in docker çš„ kind ç­‰ç­‰ã€‚åœ¨é€™è£¡æˆ‘å€‘ä¸»è¦æœƒæåˆ°çš„æ˜¯ - test-infra ã€‚ test-infra æä¾›äº†è¨±å¤šä¾› Kubernetes æ¸¬è©¦çš„å·¥å…·ï¼Œè£¡é¢åŒ…å«äº†æˆ‘å€‘è¦ä»‹ç´¹çš„ Kubernetes E2E Testing Tool - kubetestã€‚Cluster E2E TestingKubernetes E2E Testing ä¸»è¦æ˜¯é©—è­‰æ‰€æœ‰çš„åŠŸèƒ½ (åŒ…å« API Server ä»¥åŠ Controller ) æ˜¯å¦æ˜¯æ­£å¸¸å¯ç”¨çš„ï¼Œä¸” API è¡Œç‚ºå¿…é ˆè·Ÿ Spec ä¸Šä¸€æ¨£ã€‚é€éé€™ç¨®æ¸¬è©¦èƒ½å¤ æ‰¾å‡ºä¸€äº› Unit Test ã€ Integration Test æˆ–æ˜¯äººå·¥é›£ä»¥æ‰¾å‡ºçš„å•é¡Œã€‚Kubetest Usagetest-infra é‡‹å‡ºäº†å¯ä»¥å° Kubernetes Cluster åš E2E Test çš„å·¥å…· - kubetest ï¼Œä¸é kubetest å…¶å¯¦æ˜¯ä¸€å€‹æ•´åˆçš„ä»‹é¢ï¼Œä»–ä¸åªå¯ä»¥åšä¸€èˆ¬çš„ E2E Test ï¼Œé‚„æ•´åˆäº†å¦‚ Conformance Test, Node E2E Test ä»¥åŠ Performance Test ç­‰ç­‰çš„æ¸¬è©¦ï¼Œå¾ŒçºŒæˆ‘å€‘æœƒå†ç´°éƒ¨ä»‹ç´¹ kubetest çš„é‹ä½œæµç¨‹ã€‚é€™é‚Šéœ€è¦æ³¨æ„çš„æ˜¯: kubetest åœ¨åŸ·è¡Œ E2E Test æ™‚ï¼Œæœƒé–‹å•Ÿä¸€å€‹ä¹¾æ·¨çš„ Cluster ä¾†åšæ¸¬è©¦ï¼Œé€™æ¨£çš„ç”¨æ„æ˜¯å› ç‚º  Kubernetes æ˜¯æƒ³è¦é‡å°æ•´å€‹ Kubernetes Source Code åš E2E Test ï¼Œé€™æ¨£æ‰å¯ä»¥ç¢ºä¿ç•¶å‰ Release å‡ºä¾†çš„ Kubernetes ç‰ˆæœ¬æ˜¯æ­£å¸¸å¯ç”¨çš„ã€‚ å› æ­¤ kubetest åœ¨åŸ·è¡Œæ™‚æœƒå»å°‹æ‰¾ Kubernetes Repository ï¼Œæ‰¾åˆ°å¾Œå† Build Source Code ï¼Œæ¥è‘—é–‹å•Ÿæ–°çš„ Cluster æ¸¬è©¦ã€‚  kubetest å…¶å¯¦ä¹Ÿæœ‰è¢«æ•´åˆåˆ° prow è£¡é¢ï¼Œä»»ä½• Pull Requet åœ¨è¢« Merge å‰ï¼Œä¹Ÿéƒ½æœƒé€é kubetest é€²è¡Œæ¸¬è©¦ã€‚Execution:$ kubetest --build --provider &amp;lt;yourprovider&amp;gt; --deployment &amp;lt;yourdeployer&amp;gt; --up --test --test_args=&quot;--ginkgo.skip(focus)=xxx&quot; --dump &amp;lt;folder&amp;gt; --down  Flag:--build:       Build binaries (e2e.test, e2e_node.test) for testing.--provider:    Specify an alternative provider (gce, local, gke, aks, etc.) for E2E testing, default value is gce. --deployment:  Deployment strategies of Kubernetes cluster.  (gce, local, gke, aks, etc.)--up:          Turn up a new cluster.     --test:        Run E2E testing.--test_args:   Test matching for ginkgo.--down:        Shutdown and delete the cluster.--dump:        Export the result. ( junit xml format )é€™é‚Šæ¯”è¼ƒå®¹æ˜“ææ··çš„æ˜¯ --provider ä»¥åŠ --deployment ï¼Œå®˜æ–¹æ–‡ä»¶å°é€™å…©å€‹ flag ä¸¦æ²’æœ‰å¤ªå¤šçš„è§£é‡‹ï¼Œç¶“éç­†è€…ç ”ç©¶äº†ä¹‹å¾Œï¼Œæ•´ç†å‡ºä¾†çµè«–æ˜¯: --provider æ¯”è¼ƒåƒæ˜¯å‘Šè¨´ kubetest è¦åœ¨å“ªå€‹å¹³å°ä¸Šåšæ¸¬è©¦æˆ–è‘—æ˜¯å‘Šè¨´ kubetest æº–å‚™å“ªä¸€å€‹å¹³å°ä½¿ç”¨çš„ Test Listsï¼Œè€Œ --deployment æ¯”è¼ƒåƒæ˜¯å‘Šè¨´ kubetest ä½ çš„ Cluster ä½ç½®ï¼Œè®“ kubetest å¯ä»¥å­˜å–åˆ° Cluster ã€‚èˆ‰ä¾‹ä¾†èªªå¦‚æœä½ è¨­å®š --deployment gke ï¼Œ kubetest å°±æœƒçŸ¥é“ä½ çš„ Cluster æ˜¯ç”¨ gke ä½ˆå‡ºä¾†çš„ï¼Œæ¥ä¸‹ä¾†å°±æœƒç­‰ä½ å†æä¾›ä¸€äº› gke ç›¸é—œåƒæ•¸(ä¾‹å¦‚æä¾› kubeconfig æˆ–æ˜¯ä¸€äº› token ä¹‹é¡çš„)ï¼Œè®“ kubetest èƒ½å¤ å­˜å–å¾—åˆ°ä½ çš„ Cluster ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ --provider è·Ÿ --deployment å…©å€‹å¹³å°å¿…é ˆä¸€è‡´ï¼Œå¦å‰‡ kubetest æœƒç„¡æ³•æ¸¬è©¦ä¸¦ä¸”å ±éŒ¯ï¼Œä¾‹å¦‚ --provider local é…ä¸Š --deployment gke æˆ–æ˜¯ --provider gke é… --deployment local é€™ç¨®æƒ…æ³æ˜¯ä¸è¡Œçš„ã€‚  ç­†è€…å¯¦éš›åŸ·è¡Œå®Œæ•´çš„ E2E Test å¤§æ¦‚èŠ±äº†ä¸€å¤©å·¦å³ï¼Œä¸éå¯èƒ½è·Ÿç­†è€… Homelab ç¡¬é«”è³‡æºæœ‰é—œï¼Œå¯¦éš›ä¸Šæ‡‰è©²ä¸éœ€è¦é€™å¤šæ™‚é–“ã€‚ä½¿ç”¨ --dump flag æœƒå°‡æ¸¬è©¦çµæœå­˜æˆ JUnit æ ¼å¼ï¼Œè£¡é¢æœƒå¯«æ‰€æœ‰åŸ·è¡Œçš„æ¸¬é …ä»¥åŠæ¸¬è©¦çµæœ (åŒ…æ‹¬å¤±æ•—è¨Šæ¯):Kubetest Workflowæ¥ä¸‹ä¾†è§£é‡‹ä¸€ä¸‹ kubetest é‹ä½œæµç¨‹ï¼Œåˆ°åº•åŸ·è¡Œ kubetest ä¹‹å¾Œå®ƒåšå“ªäº›äº‹æƒ…å‘¢ï¼Ÿä¸Šåœ–ç‚º kubetest ç°¡å–®çš„åŸ·è¡Œæµç¨‹åœ–ï¼ŒåŸºæœ¬ä¸Šå¤§è‡´æµç¨‹æ˜¯ kubernetes/hack/e2e.go -&amp;gt; test-infra/kubetest -&amp;gt; kubernetes/hack/ginkgo-e2e.sh -&amp;gt; kubernetes/test/e2e/e2e_test.go -&amp;gt; kubernetes/test/e2e/framework/framework.go -&amp;gt; Start E2E testing ã€‚Stage 1: kubernetes/hack/e2e.go -&amp;gt; test-infra/kubetestkubernetes/hack/e2e.goåœ¨ä»¥å¾€é‚„æ²’æœ‰ kubetest çš„æ™‚å€™ï¼Œ Kubernetes æ¸¬è©¦éƒ½æ˜¯å„è‡ªåˆ†é–‹çš„ä»‹é¢ï¼Œè€Œå…¶ä¸­ E2E Testing éƒ¨åˆ†å°±æ˜¯ kubernetes/hack/e2e.go è² è²¬ï¼Œä½†æ˜¯ sig-testing å¯èƒ½æ˜¯ç‚ºäº†æ•´åˆé€™äº›ä»‹é¢ï¼Œå› æ­¤é–‹ç™¼äº† kubetest ï¼Œä¾†è®“æ¸¬è©¦äººå“¡èƒ½å¤ ç›´æ¥ä½¿ç”¨å–®ä¸€ä»‹é¢ä¾†åšåˆ°å„å¼å„æ¨£çš„æ¸¬è©¦( Cluster E2E Test ã€ Node E2E Test æˆ– Performance Test ç­‰ç­‰)ã€‚å¦‚æœä½ ç›´æ¥å»çœ‹ kubernetes/hack/e2e.go çš„ Source Codeï¼Œä½ æœƒç™¼ç¾å…¶å¯¦å®ƒä¹Ÿæ˜¯æœƒå»æŠ“ kubetest ä¸¦ä¸”åŸ·è¡Œ kubetest ï¼Œæ‰€ä»¥ä½ å¯èƒ½æœƒçœ‹åˆ°ç¶²è·¯ä¸Šä¸€äº›æ–‡ç« ä»‹ç´¹ E2E Testing çš„æ™‚å€™æ˜¯åŸ·è¡Œ hack/e2e.go --provider xxx ... è€Œä¸æ˜¯ kubetest --provider ... ï¼Œé€™å…©å€‹å…¶å¯¦æ˜¯ä¸€æ¨£çš„ã€‚å¦‚æœä½ å»çœ‹ kubernetes/hack/e2e.go çš„ history ï¼Œå¯ä»¥çœ‹åˆ°ä»–åœ¨2017å¹´çš„æ™‚å€™æŠŠ Code æ•´å€‹æ”¹æˆ kubetest ä»‹é¢ï¼Œç”±æ­¤å¯ä»¥å¾—çŸ¥æ˜¯å¾é‚£å€‹æ™‚å€™é–‹å§‹æ•´åˆé€²å»çš„ã€‚Stage 2: test-infra/kubetest -&amp;gt; kubernetes/hack/ginkgo-e2e.shGinkgo &amp;amp; GomegaKubernetes E2E Testing æ‰€æœ‰æ¸¬é …å…¶å¯¦éƒ½æ˜¯ç”¨ Ginkgo ä»¥åŠ Gomega æ’°å¯«çš„ï¼Œ Ginkgo æ˜¯ Golang çš„ Behavior-Driven Development (BDD) Testing Framework ï¼Œè€Œ Gomaga æ˜¯ Golang çš„ Matcher Libraryï¼Œ ç”¨åœ¨æ¸¬é …çµæœæ¯”å°ã€‚é€™é‚Šç°¡å–®è§£é‡‹ä¸€ä¸‹ BDD ç‚ºä½•ï¼Œä¸€èˆ¬åœ¨åš Software Testing æ™‚ï¼Œ RD æˆ–æ˜¯ QA å¯èƒ½æœƒä¾ç…§è¦æ ¼æ›¸æ’°å¯«å‡ºå°æ‡‰çš„æ¸¬è©¦ Code ï¼Œä½†æ˜¯é€™äº› Code å¯èƒ½åªæœ‰æŠ€è¡“äººå“¡çœ‹å¾—æ‡‚ï¼Œé€™æ¨£æœƒå°è‡´æŠ€è¡“èˆ‡éæŠ€è¡“äººå“¡å¾ˆé›£å”åŒä½œæ¥­æˆ–è¨è«–ï¼Œå› æ­¤å¾ˆå®¹æ˜“ç™¼ç”Ÿé–‹ç™¼è€…èª¤è§£æ¸¬é …æˆ–æ˜¯è¦æ ¼æ›¸åˆ¶å®šä¸æ¸…æ¥šçš„æƒ…æ³ã€‚è€Œ BDD å°±æ˜¯ç‚ºäº†è§£æ±ºé€™å€‹å•é¡Œï¼Œè®“é–‹ç™¼äººå“¡ä»¥åŠéæŠ€è¡“äººå“¡èƒ½å¤ ä¸€åŒå”ä½œçš„ä¸€ç¨®é–‹ç™¼æ–¹å¼ï¼Œé¦–å…ˆå¤§å®¶æœƒå…±åŒåˆ¶å®šä¸€ä»½è¦æ ¼æ›¸ï¼Œè¦æ ¼æ›¸æœƒä½¿ç”¨æ›´æ¥è¿‘äººé¡èªæ„çš„è‡ªç„¶èªè¨€ä¾†æè¿°è»Ÿé«”åŠŸèƒ½å’Œæ¸¬è©¦æ¡ˆä¾‹ï¼Œåˆ¶å®šå®Œå¾Œï¼Œ QA èƒ½å¤ ç›´æ¥åŸ·è¡Œé€™ä»½è¦æ ¼æ›¸ä¾†æ¸¬è©¦ï¼Œç„¡éœ€å†é¡å¤–å¯«ä¸€äº›è¤‡é›œçš„æ¸¬è©¦ Codeï¼Œç°¡å–®ä¾†èªª BDD å°±æ˜¯ä»¥è»Ÿé«”çš„è¡Œç‚ºä¾†æè¿°æ¸¬è©¦ï¼Œè®“å¤§å®¶éƒ½èƒ½çœ‹æ‡‚ã€‚Ginkgo ä¸»è¦ç”±ä»¥ä¸‹ä¸‰å€‹éƒ¨åˆ†çµ„æˆï¼š  Main Program: ä¸»è¦è¦æ¸¬çš„ç¨‹å¼ã€‚  Test Suite: æ¸¬è©¦åŒ…ï¼Œé€šå¸¸æœƒåŒ…å«å¾ˆå¤š Spec (æ¸¬é …)ã€‚  Spec: æ¸¬é … (å¯èƒ½ä¸€å€‹æˆ–å¤šå€‹)ã€‚ä»¥ä¸‹ä½¿ç”¨ç°¡å–®çš„ç¯„ä¾‹ä¾†ä»‹ç´¹å¦‚ä½•ä½¿ç”¨ Ginkgo å’Œ Gomaga ï¼Œç¯„ä¾‹ Code å¯ä»¥å¾ç­†è€… GitHub ä¸Šä¸‹è¼‰ï¼Œæœ‰èˆˆè¶£å¯ä»¥å»è¼‰ä¸‹ä¾†åŸ·è¡Œçœ‹çœ‹ã€‚  ä¸‹è¼‰ä¸¦å®‰è£ Ginkgo å’Œ Gomega    $ go get github.com/onsi/ginkgo/ginkgo$ go get github.com/onsi/gomega/...# Install Ginkgo CLI$ go install github.com/onsi/ginkgo/ginkgo            é€™é‚Šæ’°å¯«ä¸€å€‹ç°¡å–®çš„ myproject package ï¼Œè£¡é¢æœƒæœ‰å…©å€‹å‡½æ•¸: Greeting() å’Œ Calc() ã€‚ Greeting() åŠŸèƒ½æ˜¯æ˜¯å‚³å…¥ä¸€å€‹å­—ä¸²ï¼Œæœƒå›å‚³ Hello xxx çš„æ‰“æ‹›å‘¼å‡½æ•¸ï¼› Calc() æ˜¯å‚³å…¥ä¸€å€‹æ•¸å€¼ï¼Œæœƒå›å‚³åå€çš„å€¼çµ¦ä½ ã€‚    myproject.go    package myprojectfunc Greeting(name string) string{    return &quot;Hello &quot; + name + &quot;.&quot;}func Calc(number int) int{    return number * 10}        æ–°å¢ Test Suite ï¼Œ Test Suite å°±æ˜¯æ¸¬è©¦åŒ…çš„æ„æ€ï¼Œæ¸¬è©¦åŒ…æœƒå»æŠ“æ‰€æœ‰çš„æ¸¬è©¦æª”ï¼Œä¸¦åŸ·è¡Œè£¡é¢çš„æ¸¬é … ( Spec )ã€‚    $ cd myproject$ lsmyproject.go$ ginkgo bootstrap$ lsmyproject.go myproject_suite_test.go            æŸ¥çœ‹ Test Suite ï¼Œæœƒç™¼ç¾è£¡é¢æœƒæœ‰ä¸€å€‹ Testxxx() å‡½æ•¸ã€‚é è¨­ Golang æœ¬èº«å°±æœ‰æ”¯æ´æ¸¬è©¦çš„åŠŸèƒ½ ( go test )ï¼Œç•¶åŸ·è¡Œ go test å¾Œï¼Œ go æœƒå»æŠ“ç›®éŒ„åº•ä¸‹æ‰€æœ‰ xxx_test.go çš„æª”æ¡ˆï¼Œä¸¦åŸ·è¡Œé€™äº› go æª”è£¡é¢ Testxxx() çš„å‡½æ•¸ï¼Œé€™äº›å‡½æ•¸å°±æ˜¯ä½ å¯«çš„æ¸¬é …ã€‚ Ginkgo ä¹Ÿæ˜¯ä½¿ç”¨ go testÂ é€™ç¨®ç‰¹æ€§ï¼Œè®“ go å…ˆå»åŸ·è¡Œ Testxxx()ï¼Œåªä¸éåœ¨é€™å€‹ Testxxx() å‡½æ•¸è£¡åŸ·è¡Œçš„æ˜¯ Ginkgo çš„å‡½æ•¸ RunSpecs() ï¼Œ RunSpecs() æœƒå»æŠ“ç›®éŒ„åº•ä¸‹æ‰€æœ‰çš„æ¸¬é … ( Spec ) ã€‚    myproject_suite_test.go    package myproject_test import (      &quot;testing&quot;      . &quot;github.com/onsi/ginkgo&quot;      . &quot;github.com/onsi/gomega&quot;)func TestMyproject(t *testing.T) {      RegisterFailHandler(Fail)      RunSpecs(t, &quot;Myproject Suite&quot;)}        æ¥è‘—å°±æ˜¯ç”¢ç”Ÿæ¸¬è©¦æª”    $ ginkgo generate mytest$ lsmyproject.go myproject_suite_test.go mytest_test.go        mytest_test.go     package myproject_test  import (         . &quot;github.com/onsi/ginkgo&quot;         . &quot;github.com/onsi/gomega&quot;         . &quot;github.com/myproject&quot; ) var _ = Describe(&quot;Mytest&quot;, func() { })            æ’°å¯«æ¸¬é … ( Spec ) ï¼Œå¦‚æœä½ æ›¾ç¶“æœ‰å¯«éå…¶ä»–èªè¨€çš„æ¸¬è©¦ï¼Œä½ å¯èƒ½æœƒç™¼ç¾ Ginkgo æ¶æ§‹èˆ‡ä»–å€‘éå¸¸ç›¸ä¼¼ï¼Œéƒ½æ˜¯ç”±ä¸‰å€‹éƒ¨åˆ†çµ„æˆ: Describe , Context ä»¥åŠ It ï¼Œ Describe æ˜¯æè¿°é€™å€‹ Spec ï¼Œä¾‹å¦‚: æ¸¬è©¦ Greeting() å‡½æ•¸ ã€‚ Context æ˜¯è£œå……èªªæ˜é€™å€‹ Spec ï¼Œå¯ä»¥å¢åŠ æ¢ä»¶å¼æˆ–æ˜¯ä»»ä½•è¦å‰‡é‚„è®“ Spec è¡Œç‚ºæ›´åŠ æ˜ç¢ºï¼Œä¾‹å¦‚ï¼š å‚³çµ¦å®ƒä¸€å€‹å­—ä¸² æˆ–æ˜¯ å‚³çµ¦å®ƒä¸€å€‹ä¸­è‹±æ–‡å¤¾é›œçš„å­—ä¸² ç­‰ç­‰ã€‚æœ€å¾Œ It æ˜¯é æœŸé”åˆ°çš„çµæœï¼Œä¾‹å¦‚ï¼š æ‡‰è©²è¦è·Ÿæˆ‘æ‰“æ‹›å‘¼ , è¦å›å‚³ä»€éº¼å€¼ æˆ– è¦å ±éŒ¯ ç­‰ç­‰ã€‚    åœ¨æ­¤ç¯„ä¾‹ä¸­ï¼Œ Spec 1 æ˜¯æ¸¬è©¦å‚³å…¥ä¸€å€‹å­—ä¸²çµ¦ Greeing() ï¼Œé©—è­‰æ˜¯å¦æœƒå›å‚³ Hello &amp;lt;å­—ä¸²&amp;gt;ã€‚ Spec 2 æ˜¯æ¸¬è©¦å‚³å…¥ä¸€å€‹æ•¸å€¼çµ¦ Calc() ï¼Œé©—è­‰æ˜¯å¦æœƒå›å‚³åå€çš„å€¼ã€‚    mytest_test.go     ... var _ = Describe(&quot;Mytest&quot;, func() {     var name string= &quot;test&quot;     var number int= 99     // Spec 1     Describe(&quot;Test Greeting function&quot;, func() {             Context(&quot;Giva a name&quot;, func() {                 It(&quot;Should greeting&quot;, func() {                     Expect(Greeting(name)).To(Equal(&quot;Hello &quot;+name+&quot;.&quot;))                 })             })     })     // Spec 2     Describe(&quot;Test Calc function&quot;, func() {             Context(&quot;Give a number&quot;, func() {                 It(&quot;Should get the correct result&quot;, func() {                     Expect(Calc(number)).To(Equal(number*10))                 })             })     }) })        å¦ä¸€å€‹ç¯„ä¾‹æ˜¯ Ginkgo çš„ä¸€å€‹å‡½æ•¸ BeforeEach() ï¼Œç”±æ–¼ Kubernetes çš„ E2E Test ä¸­ä½¿ç”¨äº†å¾ˆå¤š BeforeEach ï¼Œå› æ­¤é€™è£¡ç‰¹åˆ¥è§£é‡‹ä¸€ä¸‹ BeforeEach Â çš„ä½œç”¨ã€‚ BeforeEach åŸ·è¡Œæ™‚æ©Ÿæ˜¯åœ¨ æ¯å€‹ Spec åŸ·è¡Œå‰ ï¼Œæˆ‘å€‘å¯ä»¥å°‡ä¸€äº›åƒæ•¸åˆå§‹åŒ–çš„æ­¥é©Ÿæˆ–æ˜¯ä¸€äº›å¯èƒ½æœƒè¢« Spec å½±éŸ¿çš„æ­¥é©Ÿæ”¾åˆ° BeforeEach è£¡é¢ï¼Œé€™æ¨£å¯ä»¥ç¢ºä¿æ¯æ¬¡çš„æ¸¬è©¦éƒ½æ˜¯å…¬å¹³ä¹¾æ·¨ä¸”ä¸å—å½±éŸ¿çš„ã€‚    å¾åº•ä¸‹ä¾‹å­ä¾†çœ‹ï¼Œæˆ‘å€‘å®£å‘Šä¸€å€‹ number ä¸¦çµ¦å®ƒå€¼ 99 ï¼Œ Spec 1 æœƒå»åŸ·è¡Œé©—è­‰ Calc() å‡½æ•¸ï¼Œé©—è­‰å®Œå¾ŒæœƒæŠŠ number å€¼æ”¹æ‰ï¼Œå¦‚æœæ²’æœ‰æŠŠ number = 99 æ”¾åˆ° BeforeEach() è£¡é¢ï¼Œé‚£ Spec 2 å°±æœƒç›´æ¥ä½¿ç”¨ è¢«æ”¹é çš„ number ( é€™æ™‚æ‡‰è©²æ˜¯  990 ) å»åšæ¸¬è©¦ï¼Œç„¶å¾Œå°±æœƒæ¸¬å¤±æ•—ï¼Œå› æ­¤å¿…é ˆå°‡ number = 99 æ”¾åˆ° BeforeEach() è£¡é¢ï¼Œè®“ Ginkgo åŸ·è¡Œæ¯å€‹ Spec ä¹‹å‰éƒ½é‡æ–°æŒ‡æ´¾ä¸€æ¬¡ number çš„å€¼ã€‚    mytest2_test.go     â€¦  var _ = Describe(&quot;Mytest&quot;, func() {     var number int     // å¦‚æœå°‡ number æŒ‡æ´¾æ”¾åˆ° BeforeEach å¤–é¢ï¼Œå‰‡ number çš„å€¼æœƒè¢« Spec 1 æ”¹æ‰ã€‚     // number = 99     BeforeEach(func(){         // å°‡number æŒ‡æ´¾æ”¾åˆ° BeforeEach è£¡é¢å¯ä»¥ç¢ºä¿å€¼æ°¸é éƒ½æ˜¯ 99         number  = 99     })     Describe(&quot;Test Calc function again&quot;, func() {         Context(&quot;Give a number 99&quot;, func() {             // Spec 1              It(&quot;Should return 990&quot;, func() {                 Expect(Calc(number)).To(Equal(990))                 number = Calc(number2)             })             // Spec 2             It(&quot;Should return 990, too&quot;, func() {                 Expect(Calc(number)).To(Equal(990))             })         })     }) })           åŸ·è¡Œæ¸¬è©¦ï¼Œæˆ‘å€‘å¯ä»¥ç›´æ¥ä½¿ç”¨ ginkgo æˆ–æ˜¯ go test æŒ‡ä»¤ä¾†åŸ·è¡Œæ¸¬è©¦ã€‚åŸ·è¡Œå®Œå¾Œ Ginkgo æœƒé¡¯ç¤ºåŸ·è¡Œäº†å¹¾å€‹ Spec ï¼Œç„¶å¾Œå¹¾å€‹æˆåŠŸå¹¾å€‹å¤±æ•—ã€‚    $ ginkgo# Show all Specs$ ginkgo -vRunning Suite: Myproject Suite==============================Random Seed: 1568041760Will run 4 of 4 Specsâ€¢â€¢â€¢Ran 4 of 4 Specs in 0.001 secondsSUCCESS! -- 4 Passed | 0 Failed | 0 Pending | 0 SkippedPASSGinkgo ran 1 suite in 3.471827325sTest Suite Passed        åˆ°é€™é‚Šå¤§æ¦‚äº†è§£ Ginkgo çš„ä½œç”¨å¾Œï¼Œæ¥ä¸‹ä¾†æˆ‘å€‘å›åˆ° test-infra/kubetest ï¼Œæ ¹æ“šç¨‹å¼ç¢¼ä¾†çœ‹ä¸€ä¸‹ kubetest åšçš„äº‹ã€‚    ç•¶æˆ‘å€‘åŸ·è¡Œ kubetest --test çš„æ™‚å€™ï¼Œ test-infra/kubetest/main.go æœƒå»åŸ·è¡Œ complete() å‡½æ•¸ï¼Œæ¥è‘—æ ¹æ“šæŒ‡å®šçš„ --deployment åŸ·è¡Œ run(deploy, *o)ã€‚    test-infra/kubetest/main.go    ...func main() {   ...   err := complete(o)   ...}func complete(o *options) error {   ...   if err := run(deploy, *o); err != nil {      return err   }   ...}...        test-infra/kubetest/e2e.go è£¡çš„ run() å‡½æ•¸ï¼Œæœƒåˆ¤æ–·æ˜¯å¦æœ‰è¨­å®š --test flagï¼Œæœ‰å¾—è©±å°±åŸ·è¡Œ Run() ä¾†åš E2E test ï¼Œå¯ä»¥çœ‹åˆ° Run() å‡½æ•¸è£¡æœƒå»å‘¼å« ginkgo-e2e.sh ã€‚    test-infra/kubetest/e2e.go    ...func run(deploy deployer, o options) error {   ...   // åˆ¤æ–·æ˜¯å¦æœ‰è¨­å®š --test flag   if o.test {      // åˆ¤æ–·æ˜¯å¦æœ‰ build äº† e2e.test      if err := control.XMLWrap(&amp;amp;suite, &quot;test setup&quot;, deploy.TestSetup); err != nil {         ...      }       ...      else {         if o.deployment != &quot;conformance&quot; {            ...         }         ...         else{            ...            if tester != nil {               // é–‹å§‹æ¸¬è©¦               return tester.Run(control, testArgs);		            }            ...         }       }   }      }...// Run executes ./hack/ginkgo-e2e.shfunc (t *GinkgoScriptTester) Run(control *process.Control, testArgs []string) error {   return control.FinishRunning(exec.Command(&quot;./hack/ginkgo-e2e.sh&quot;, testArgs...))}        ç”±æ­¤å¯ä»¥çŸ¥é“ kubetest å…¶å¯¦æ˜¯ä½¿ç”¨ Ginkgo ä¾†åŸ·è¡Œæ‰€æœ‰æ¸¬é …ï¼Œä¸¦ä¸”æœƒåŸ·è¡Œ ginkgo-e2e.shã€‚  Stage 3: kubernetes/hack/ginkgo-e2e.sh -&amp;gt; kubernetes/test/e2e/e2e_test.go -&amp;gt; kubernetes/test/e2e/framework/framework.goåœ¨ Stage 2 æˆ‘å€‘å·²ç¶“çŸ¥é“ kubetest æœƒåŸ·è¡Œ Ginkgo ï¼Œ æ¥ä¸‹ä¾†è§£é‡‹åˆ°åº• Test Lists åœ¨å“ªè£¡ã€‚æˆ‘å€‘å¯¦éš›å»çœ‹ kubernetes/hack/ginkgo-e2e.sh åŸå§‹ç¢¼ï¼Œæœƒçœ‹åˆ° Ginkgo æœƒå»åŸ·è¡Œ e2e.testã€‚kubernetes/hack/ginkgo-e2e.sh...# Find the ginkgo binary build as part of the release.ginkgo=$(kube::util::find-binary &quot;ginkgo&quot;)e2e_test=$(kube::util::find-binary &quot;e2e.test&quot;)...&quot;${ginkgo}&quot; &quot;${ginkgo_args[@]:+${ginkgo_args[@]}}&quot; &quot;${e2e_test}&quot; -- \\  &quot;${auth_config[@]:+${auth_config[@]}}&quot; \\  --ginkgo.flakeAttempts=&quot;${FLAKE_ATTEMPTS}&quot; \\...e2e.test å°±æ˜¯ Test Suite ä»¥åŠ æ¸¬é …çš„ Binary æª”ï¼Œå‰é¢æˆ‘å€‘æœ‰æåˆ° kubetest --build æœƒå» Build Kubernetes Source Code ï¼Œå…¶ä¸­ä¸€å€‹å°±æ˜¯æŠŠ kubernetes/test/e2e Build æˆ e2e.test (å¯åƒè€ƒ BUILD)ã€‚  é€™é‚Š Build å…¶å¯¦å°±æ˜¯åš make çš„å‹•ä½œï¼Œå¦‚æœå°æ–¼ make ç´°ç¯€æœ‰èˆˆè¶£ï¼Œå¯ä»¥å»ç ”ç©¶ Kubernetes ç›®éŒ„è£¡çš„ Makefile ã€‚æˆ‘å€‘å†å›åˆ° kubetest åŸå§‹ç¢¼ä¾†çœ‹å¯¦éš›æ­¥é©Ÿï¼Œç•¶åŸ·è¡Œ kubetest --build æ™‚ï¼Œtest-infra/kubetest/main.go æœƒå»åŸ·è¡Œ Build() å‡½æ•¸ï¼Œè€Œé€™å€‹ BUild() å‡½æ•¸æ˜¯ä½æ–¼ test-infra/kubetest/build.go è£¡ã€‚test-infra/kubetest/main.gofunc acquireKubernetes(o *options, d deployer) error {   // Potentially build kubernetes   // åˆ¤æ–·æœ‰æ²’æœ‰è¨­å®š --build flag	if o.build.Enabled() {		var err error		// kind deployer manages build		if k, ok := d.(*kind.Deployer); ok {			err = control.XMLWrap(&amp;amp;suite, &quot;Build&quot;, k.Build)		} else {         // o.build.Build å°±æ˜¯ kubetest --build=&quot;å€¼&quot; æŒ‡å®šçš„å€¼ï¼Œå¦‚æœæ²’æŒ‡å®š         // é è¨­æ˜¯  quick-release			err = control.XMLWrap(&amp;amp;suite, &quot;Build&quot;, o.build.Build)		}		...   }}Build() å‡½æ•¸æœƒå¯¦éš›å»åŸ·è¡Œ make ä¾† Build Source Code ã€‚test-infra/kubetest/build.gofunc (b *buildStrategy) Build() error {	var target string	switch *b {	case &quot;bazel&quot;:		target = &quot;bazel-release&quot;	case &quot;e2e&quot;:		//TODO(Q-Lee): we should have a better way of build just the e2e tests		target = &quot;bazel-release&quot;      ...	case &quot;host-go&quot;:		target = &quot;all&quot;	case &quot;quick&quot;:		target = &quot;quick-release&quot;	case &quot;release&quot;:		target = &quot;release&quot;	case &quot;gce-windows-bazel&quot;:		...	default:		return fmt.Errorf(&quot;Unknown build strategy: %v&quot;, b)	}   ...	// åŸ·è¡Œ make -C kubernetes &amp;lt;target&amp;gt;	return control.FinishRunning(exec.Command(&quot;make&quot;, &quot;-C&quot;, util.K8s(&quot;kubernetes&quot;), target))}åˆ°é€™é‚Šæˆ‘å€‘å·²ç¶“çŸ¥é“ kubetest --build åŸ·è¡Œç´°ç¯€ä»¥åŠ e2e.test çš„ç”±ä¾†ï¼Œæ¥ä¸‹ä¾†æˆ‘å€‘å†è¨è«– e2e.test è£¡çš„ Test Suite ä»¥åŠ Spec åˆ°åº•æ˜¯ä»€éº¼ï¼ŸTest Suiteå‰é¢æœ‰æåˆ° Golang åœ¨åŸ·è¡Œ go test æ™‚æœƒå»æ‰¾ xxx_test.go çš„æª”æ¡ˆï¼Œä¸¦ä¸”åŸ·è¡Œè£¡é¢çš„ Testxxx() å‡½æ•¸ã€‚å› æ­¤ç•¶ Ginkgo åŸ·è¡Œ e2e.test æ™‚ï¼Œæœƒæ‰¾åˆ° kubernetes/test/e2e/e2e_test.go æª”ï¼Œç„¶å¾Œå»åŸ·è¡Œ kubernetes/test/e2e/e2e.go è£¡é¢çš„ TestE2E() å‡½æ•¸ã€‚kubernetes/test/e2e/e2e_test.gofunc TestE2E(t *testing.T) {	RunE2ETests(t)}TestE2E() å‡½æ•¸æœƒåŸ·è¡Œ Ginkgo å‡½æ•¸ RunSpec() ä¾†åŸ·è¡Œæ‰€æœ‰ Specï¼Œç”±æ­¤å¯ä»¥çŸ¥é“ e2e_test.go ä»¥åŠ e2e.go å°±æ˜¯ Test Suite ã€‚kubernetes/test/e2e/e2e.gofunc RunE2ETests(t *testing.T) {   ...   ginkgo.RunSpecsWithDefaultAndCustomReporters(t, &quot;Kubernetes e2e suite&quot;, r)}Specsä¸€èˆ¬ä¾†èªªä½¿ç”¨ Ginkgo ä¾†åšæ¸¬è©¦ï¼Œç‚ºäº†æ–¹ä¾¿ Test Suite å»æŠ“åˆ°æ‰€æœ‰çš„ Spec ï¼Œæœƒåœ¨ Test Suite æª”æ¡ˆ Import Spec çš„ {ackage (é™¤é Spec èˆ‡ Test Suite åŒå€‹ Package )ï¼Œæ‰€ä»¥å¦‚æœç›´æ¥å¾ e2e_test.go ä»¥åŠ e2e.go å»çœ‹ï¼Œå°±æœƒç™¼ç¾åœ¨ e2e_test.go è£¡ Import äº†æ‰€æœ‰ E2E Test ç”¨åˆ°çš„ Spec ï¼Œå¯ä»¥ç™¼ç¾é€™äº›æ¸¬é …å°±æ˜¯ä½æ–¼ kubernetes/test/e2e/ åº•ä¸‹ã€‚kubernetes/test/e2e/e2e_test.gopackage e2eimport (   &quot;flag&quot;   ...   // test sources	_ &quot;k8s.io/kubernetes/test/e2e/apimachinery&quot;	_ &quot;k8s.io/kubernetes/test/e2e/apps&quot;	_ &quot;k8s.io/kubernetes/test/e2e/auth&quot;	_ &quot;k8s.io/kubernetes/test/e2e/autoscaling&quot;	_ &quot;k8s.io/kubernetes/test/e2e/cloud&quot;	_ &quot;k8s.io/kubernetes/test/e2e/common&quot;	_ &quot;k8s.io/kubernetes/test/e2e/instrumentation&quot;	_ &quot;k8s.io/kubernetes/test/e2e/kubectl&quot;	_ &quot;k8s.io/kubernetes/test/e2e/lifecycle&quot;	_ &quot;k8s.io/kubernetes/test/e2e/lifecycle/bootstrap&quot;	_ &quot;k8s.io/kubernetes/test/e2e/network&quot;	_ &quot;k8s.io/kubernetes/test/e2e/node&quot;	_ &quot;k8s.io/kubernetes/test/e2e/scheduling&quot;	_ &quot;k8s.io/kubernetes/test/e2e/servicecatalog&quot;	_ &quot;k8s.io/kubernetes/test/e2e/storage&quot;	_ &quot;k8s.io/kubernetes/test/e2e/storage/external&quot;	_ &quot;k8s.io/kubernetes/test/e2e/ui&quot;	_ &quot;k8s.io/kubernetes/test/e2e/windows&quot;)...å¾è£¡é¢æŒ‘äº†ä¸€å€‹ Spec ä¾†çœ‹ï¼Œå¯ä»¥çœ‹åˆ° Spec æ ¼å¼å°±æ˜¯ä½¿ç”¨ Ginkgo ä»¥åŠ Gomega å¯«å‡ºä¾†çš„ã€‚kubernetes/test/e2e/ui/dashboard.gopackage ui...var _ = SIGDescribe(&quot;Kubernetes Dashboard [Feature:Dashboard]&quot;, func() {	ginkgo.BeforeEach(func() {		// TODO(kubernetes/kubernetes#61559): Enable dashboard here rather than skip the test.		framework.SkipIfProviderIs(&quot;gke&quot;)	})	const (		uiServiceName = &quot;kubernetes-dashboard&quot;		uiAppName     = uiServiceName		uiNamespace   = metav1.NamespaceSystem		serverStartTimeout = 1 * time.Minute	)	f := framework.NewDefaultFramework(uiServiceName)	ginkgo.It(&quot;should check that the kubernetes-dashboard instance is alive&quot;, func() {		ginkgo.By(&quot;Checking whether the kubernetes-dashboard service exists.&quot;)		err := framework.WaitForService(f.ClientSet, uiNamespace, uiServiceName, true, framework.Poll, framework.ServiceStartTimeout)		framework.ExpectNoError(err)		ginkgo.By(&quot;Checking to make sure the kubernetes-dashboard pods are running&quot;)		selector := Labels.SelectorFromSet(Labels.Set(map[string]string{&quot;k8s-app&quot;: uiAppName}))		err = testutils.WaitForPodsWithLabelRunning(f.ClientSet, uiNamespace, selector)		framework.ExpectNoError(err)		ginkgo.By(&quot;Checking to make sure we get a response from the kubernetes-dashboard.&quot;)		err = wait.Poll(framework.Poll, serverStartTimeout, func() (bool, error) {			var status int			proxyRequest, errProxy := e2eservice.GetServicesProxyRequest(f.ClientSet, f.ClientSet.CoreV1().RESTClient().Get())			if errProxy != nil {				framework.Logf(&quot;Get services proxy request failed: %v&quot;, errProxy)			}			ctx, cancel := context.WithTimeout(context.Background(), framework.SingleCallTimeout)			defer cancel()			// Query against the proxy URL for the kubernetes-dashboard service.			err := proxyRequest.Namespace(uiNamespace).				Context(ctx).				Name(utilnet.JoinSchemeNamePort(&quot;https&quot;, uiServiceName, &quot;&quot;)).				Timeout(framework.SingleCallTimeout).				Do().				StatusCode(&amp;amp;status).				Error()			if err != nil {				if ctx.Err() != nil {					framework.Failf(&quot;Request to kubernetes-dashboard failed: %v&quot;, err)					return true, err				}				framework.Logf(&quot;Request to kubernetes-dashboard failed: %v&quot;, err)			} else if status != http.StatusOK {				framework.Logf(&quot;Unexpected status from kubernetes-dashboard: %v&quot;, status)			}			// Don&#39;t return err here as it aborts polling.			return status == http.StatusOK, nil		})		framework.ExpectNoError(err)	})})  æ­¤ Spec æ˜¯æª¢æŸ¥ kubernetes dashboard æ˜¯å¦æ­£å¸¸åŸ·è¡ŒKind of Testså¾å‰é¢å°ç¯€æˆ‘å€‘å¾—çŸ¥ Kubernetes E2E Testing çš„æ¸¬é …ï¼Œä½†æ˜¯é€™äº›æ¸¬é …éå¸¸çš„å¤šï¼Œè¦å¦‚ä½•å€åˆ¥é€™äº›æ¸¬é …å‘¢? Kubernetes é‡å°é€™éƒ¨ä»½æ¡ç”¨äº†è³¦äºˆ Label çš„æ–¹å¼ä¾†å€åˆ¥ä¸åŒç¨®é¡çš„æ¸¬é …ã€‚  [Slow] - åŸ·è¡Œæ™‚é–“è¶…éå…©åˆ†é˜çš„æ¸¬é …ã€‚  [Serial] - éœ€è¦ä¾åºåŸ·è¡Œï¼Œè€Œä¸èƒ½å¹³è¡ŒåŸ·è¡Œçš„æ¸¬é …ã€‚  [Disruptive] - å…·æœ‰ç ´å£æ€§æˆ–æ˜¯æœƒå½±éŸ¿å…¶ä»–æ¸¬è©¦çš„æ¸¬é …ï¼Œä¾‹å¦‚é‡é–‹æ©Ÿ node ï¼Œæˆ–æ˜¯ç æ‰ kube-system ç›¸é—œçš„ pod ç­‰ç­‰ã€‚  [Internet] - æœƒéœ€è¦é€£åˆ°å¤–éƒ¨ç¶²è·¯çš„æ¸¬é …ã€‚  [Conformance] - Conformace Testing çš„æ¸¬é …ã€‚  [LinuxOnly] - åªèƒ½è·‘åœ¨ Linux node çš„æ¸¬é …ã€‚  [Privileged] - æœƒéœ€è¦ privileged container çš„æ¸¬é …ã€‚  [Alpha] - æ¸¬è©¦ Alpha åŠŸèƒ½çš„æ¸¬é …ã€‚â€¦è©³ç´° Label è³‡è¨Šå¯ä»¥åƒè€ƒ - Kinds of testsä¸€å€‹æ¸¬é … ( Spec ) å¯ä»¥è²¼ä¸Šä¸€å€‹æˆ–æ˜¯å¤šå€‹ Label ï¼Œè²¼çš„ä½ç½®å¯ä»¥åœ¨ SIGDescribe æˆ–æ˜¯ Ginkgo.It ï¼Œå¦‚ä»¥ä¸‹ç¯„ä¾‹ï¼šginkgo.It(&quot;should provide Internet connection for containers [Feature:Networking-IPv6][Experimental][LinuxOnly]&quot;, func() {		// IPv6 is not supported on Windows.		framework.SkipIfNodeOSDistroIs(&quot;windows&quot;)		ginkgo.By(&quot;Running container which tries to connect to 2001:4860:4860::8888&quot;)		framework.ExpectNoError(			framework.CheckConnectivityToHost(f, &quot;&quot;, &quot;connectivity-test&quot;, &quot;2001:4860:4860::8888&quot;, 53, 30))})...var _ = SIGDescribe(&quot;Kubernetes Dashboard [Feature:Dashboard]&quot;, func() {	ginkgo.BeforeEach(func() {		framework.SkipIfProviderIs(&quot;gke&quot;)   })...Execute Specific Kind of Testsåœ¨ kubetest ä½¿ç”¨ä¸Šï¼Œè¦éæ¿¾æˆ–æ˜¯åŸ·è¡Œç‰¹å®šçš„æ¸¬é …ï¼Œåªéœ€è¦ä½¿ç”¨ --test_args flag ç„¶å¾Œè£¡é¢å†è¨­å®š --ginkgo.focus/skip å°±å¯ä»¥äº†ã€‚--test_args æ˜¯è®“ kubetest å¯ä»¥ä½¿ç”¨ Ginkgo CLI çš„ flag ï¼Œå› æ­¤ä¸å–®å–®å¯ä»¥ç”¨ focus/skip ï¼Œåªè¦æ˜¯ Ginkgo CLI æ”¯æ´çš„ flag ï¼ŒåŸºæœ¬ä¸Šéƒ½å¯ä»¥ä½¿ç”¨ã€‚focus/skip å¯ä»¥é€éæ­£è¦è¡¨ç¤ºå¼ä¾†æ¯”å° Describe æˆ–æ˜¯ ginkgo.It æè¿°è£¡çš„ Labelã€‚# Only execute tests with LinuxOnly Label.$ kubetest --test --test_args=&quot;--ginkgo.focus=\\[LinuxOnly\\]&quot; --provider local --deployment local# Skip the tests with LinuxOnly Label.$ kubetest --test --test_args=&quot;--ginkgo.skip=\\[LinuxOnly\\]&quot; --provider local --deployment local  focus/skip å¯ä»¥ç”¨ä¾†æ¯”å° Describe æˆ–æ˜¯ ginkgo.It æè¿°è£¡çš„ Labelã€‚framework.gokubernetes/test/e2e/framework/framework.go æ˜¯ç”¨ä¾†åŸ·è¡Œä¸€äº› E2E test æœƒä½¿ç”¨åˆ°çš„å‡½æ•¸ï¼Œå¦‚å¾ŒçºŒæœƒæåˆ°çš„ Conformance Testing å°±æ˜¯åœ¨ framework.go è£¡åŸ·è¡Œ framework.ConformanceIt() ä¾†åšè²¼ Label çš„å‹•ä½œã€‚å…¶é¤˜ framework.go ç´°ç¯€ç­†è€…å°±æ²’æ·±å…¥å»ç­è§£ï¼Œå› æ­¤é€™éƒ¨åˆ†å°±ä¸æ·±å…¥è§£é‡‹ã€‚Write Your Own Teståœ¨äº†è§£ kubetest æµç¨‹ä¹‹å¾Œï¼Œæ¥ä¸‹ä¾†æˆ‘å€‘ä¾†è©¦è‘—æ’°å¯«è‡ªå·±çš„æ¸¬è©¦ã€‚SpecificationsKubernetes Community åœ¨ Writing good e2e tests for Kubernetes è£¡æåˆ°ä¸€äº›æ’°å¯«æ¸¬è©¦å‰éœ€è¦æ³¨æ„çš„äº‹é …ä»¥åŠä¸€äº›è¦ç¯„ï¼Œå¤§è‡´ç‚ºä»¥ä¸‹å¹¾é …ï¼š      Debuggability : åœ¨å¯«æ¸¬è©¦æ™‚ç›¡é‡å°‡æ‰€æœ‰è¨Šæ¯å¯«æ¸…æ¥šï¼Œä¾‹å¦‚æ¸¬è©¦å¤±æ•—æ™‚ï¼Œå¤±æ•—è¨Šæ¯è¦å¯«æ˜ç¢ºèªªæ˜¯å“ªè£¡éŒ¯èª¤ï¼Œä¸è¦å°±å«ç³Šçš„é¡¯ç¤ºã€Œæ¸¬è©¦å¤±æ•—ã€ä¹‹é¡çš„è¨Šæ¯ï¼Œå¿…é ˆè®“æ¸¬è©¦äººå“¡å®¹æ˜“å» Debug ã€‚        Ability to run in non-dedicated test clusters :  ä¸è¦é™å®šæ¸¬è©¦åªèƒ½è·‘åœ¨ç‰¹å®šçš„ Clusterï¼Œé€™è£¡çš„æ„æ€æ˜¯æ’°å¯«æ¸¬è©¦æ™‚ä¸è¦æœ‰å‡è¨­çš„æƒ…æ³ï¼Œä»»ä½•æ¸¬é …éƒ½è¦å¯«æ¸…æ¥šã€‚ä¾‹å¦‚ï¼šå‡è¨­é€™å€‹ Cluster æ˜¯ä¹¾æ·¨çš„ï¼Œä¸Šé¢æ²’æœ‰è·‘ä»»ä½•æœå‹™ã€å‡è¨­ç’°å¢ƒè£¡å·²ç¶“æœ‰ xxx æœå‹™æˆ–æ˜¯å‡è¨­ Cluster è·‘åœ¨ä»€éº¼ç¡¬é«”ã€ç’°å¢ƒç­‰ç­‰ã€‚é€™è£¡å®˜æ–¹èˆ‰äº†ä¸€å€‹ä¾‹å­: å‡å¦‚ä»Šå¤©å¯«äº†ä¸€å€‹æ¸¬è©¦ã€Œç¢ºèªä½ çš„ Pod èƒ½è·‘åœ¨æ‰€æœ‰ Node ä¸Šã€ä¾†é©—è­‰æ‰€æœ‰ Node æœ‰æ²’æœ‰å•é¡Œï¼Œé€™å€‹æ¸¬é …çœ‹èµ·ä¾†ä¼¼ä¹æ²’å•é¡Œï¼Œä½†æ˜¯å¯¦éš›ä¸Šåšäº†ä¸€å€‹ã€ŒåŒæ™‚é–“å…§åªæœ‰ä½ é€™å€‹æ¸¬é …è·‘åœ¨ Node ä¸Šæˆ–æ˜¯åŒæ™‚é–“æ²’æœ‰å…¶ä»–æœå‹™åœ¨ Node ä¸Šã€çš„å‡è¨­ã€‚å‡å¦‚ä½ åœ¨è·‘é€™é …æ¸¬è©¦å‰ï¼Œ Cluster æ­£åœ¨åŒæ™‚è·‘å…¶ä»–æ¸¬è©¦(æˆ–æ˜¯æœå‹™)ï¼Œå°è‡´æŸå€‹ Node è³‡æºè¢«ä½”æ»¿æˆ–æ˜¯åŸ·è¡Œåˆ° [Disruptive] çš„æ¸¬é …ï¼Œé€™æ¨£é€™å€‹æ¸¬è©¦å°±æœƒè¢«å½±éŸ¿è€Œå¤±æ•—ï¼Œä½†æ˜¯ä»–çš„å¤±æ•—ä¸¦ä¸æ˜¯ Node æœ¬èº«æœ‰å•é¡Œï¼Œè€Œæ˜¯è¢«å…¶ä»–æ±è¥¿å½±éŸ¿ï¼Œé€™æ¨£æ¸¬è©¦å‡ºä¾†å°±æœƒä¸æº–ç¢ºã€‚    å¦å¤–æ˜¯ç›¡é‡é¿å…æ’°å¯« [Disruptive] çš„æ¸¬é …ï¼Œæˆ‘å€‘å‰é¢æœ‰æåˆ° [Disruptive] æ˜¯å…·ç ´å£æ€§çš„æ¸¬é …ï¼Œå¯èƒ½æœƒå½±éŸ¿å…¶ä»–æ¸¬è©¦ï¼Œä¾‹å¦‚ï¼šé‡é–‹æ©Ÿã€åˆªæ‰æœå‹™ç­‰ç­‰ã€‚é€™è£¡é¿å…çš„æ„æ€ä¸€æ¨£æ˜¯ä¸è¦å‡è¨­ï¼šã€ŒåŒæ™‚é–“åªæœ‰ä½ é€™å€‹æ¸¬é …åœ¨æ¸¬è©¦ã€ï¼Œé¿å…å½±éŸ¿åˆ°å…¶ä»–æ¸¬è©¦æˆ–æœå‹™ï¼Œå¦‚æœçœŸçš„è¦æ’°å¯«è©²é¡å‹çš„æ¸¬è©¦ï¼Œä¸€å®šè¦åŠ  [Disruptive] Labelï¼Œä¸¦ä¸”æŠŠæ¸¬é …æè¿°å¯«æ¸…æ¥šã€‚    æœ€å¾Œæ˜¯ç›¡é‡ä¸è¦ä½¿ç”¨é Kubernetes å®˜æ–¹çš„ API ä¾†åšæ¸¬è©¦ï¼Œå› ç‚ºé€™æ¨£æ¸¬è©¦å¤±æ•—æ™‚å¾ˆé›£æ‰¾å‡ºæ˜¯ API å•é¡Œé‚„æ˜¯ Cluster å•é¡Œã€‚        Speed of execution : åœ¨å¯«æ¸¬è©¦æ™‚ï¼Œç›¡é‡æå‡æ¸¬è©¦çš„æ•ˆç‡ã€å£“ä½æ¸¬è©¦çš„æ™‚é–“ï¼Œä¸è¦æ”¾ä¸€äº›å¦‚ sleep é€™ç¨®è€—æ™‚é–“çš„å‡½æ•¸ï¼Œå¦‚æœæ¸¬è©¦æ™‚é–“æœƒè¶…éå…©åˆ†é˜ä»¥ä¸Šå°±åŠ ä¸Š [Slow] Labelï¼Œè®“æ¸¬è©¦è€…çŸ¥é“é€™å€‹æ˜¯æ¯”è¼ƒè€—æ™‚çš„æ¸¬é …ã€‚    å¦å¤–é™¤äº†æ¸¬è©¦èŠ±çš„æ™‚é–“ä¹‹å¤–ï¼Œé‚„å¿…é ˆè¨­å®šå¥½æ¸¬è©¦å¤±æ•—çš„æ™‚é–“ï¼Œä¾‹å¦‚ï¼šä½ çš„æ¸¬è©¦å¾ˆç°¡å–®åªéœ€è¦å…©åˆ†é˜å…§å®Œæˆï¼Œä½†æ˜¯å¯èƒ½å…‰æ˜¯ç­‰ Pod Ready å°±ç­‰è¶…éå…©åˆ†é˜ç”šè‡³æ˜¯ Pod å·²ç¶“å¡ä½äº†ï¼Œå¦‚æœæ²’æœ‰è¨­å®šæ¸¬è©¦å¤±æ•—çš„æ™‚é–“ (å¦‚10åˆ†é˜å¾Œå°±èªå®šæ¸¬è©¦å¤±æ•—) ï¼Œé€™å€‹æ¸¬è©¦å°±æœƒæ°¸é å¡åœ¨é‚£ã€‚        Resilience to relatively rare, temporary infrastructure glitches or delays : åœ¨å¯«æ¸¬è©¦æ™‚ï¼Œè¦å½ˆæ€§ä¸€é»ï¼Œç•¶é‡åˆ°å¤±æ•—çš„æƒ…æ³ï¼Œå¤šè©¦å¹¾æ¬¡ï¼Œæœ‰å¯èƒ½åªæ˜¯å‰›å¥½ä¸€äº›æƒ…æ³å°è‡´å¤±æ•—ã€‚èˆ‰ä¾‹ä¾†èªªï¼šä½ çš„æ¸¬é …æ˜¯ ã€Œæ¸¬è©¦ Cluster èƒ½ä¸èƒ½è·‘èµ·ä¾† Nginx çš„ Pod ã€ï¼Œæœ‰å¯èƒ½ç¬¬ä¸€æ¬¡åœ¨æ¸¬å‰›å¥½ç¶²è·¯æ¯”è¼ƒä¸ç©©ï¼Œ Image æŠ“æ¯”è¼ƒæ…¢æˆ–æ˜¯æŠ“ä¸ä¸‹ä¾†ï¼Œå°è‡´æ¸¬è©¦å¤±æ•—ï¼Œä½†æ˜¯ç¬¬äºŒæ¬¡ç¶²è·¯å°±æ¢å¾©é‡æŠ“å°±æŠ“ä¸‹ä¾†äº†ï¼Œå› æ­¤ä¸è¦åœ¨ç¬¬ä¸€æ¬¡å¤±æ•—å°±ç›´æ¥èªå®šæ¸¬è©¦å¤±æ•—ï¼Œéå€‹å¹¾ç§’å†é‡æŠ“ Image ä¸€æ¬¡ï¼Œæ¸¬è©¦å°±æœƒæ­£å¸¸äº†ã€‚    é€™è£¡éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œé›–ç„¶èªªè¦çµ¦æ¸¬é …ä¸€äº›å½ˆæ€§ï¼Œä¸éä¹Ÿæ˜¯è¦æ ¹æ“šä½ çš„æ¸¬é …ä¾†åˆ¤æ–·é©ä¸é©ç”¨ã€‚Add New Testäº†è§£æ¸¬è©¦æ’°å¯«è¦ç¯„ä¹‹å¾Œï¼Œæ¥ä¸‹ä¾†å°±ä¾†å¯¦éš›æ’°å¯«æ¸¬è©¦ï¼Œä»¥ä¸‹ç¯„ä¾‹å¯ä»¥å¾æˆ‘çš„ GitHub - kubernetes-e2e-practice è£¡å–å¾—ï¼Œæœ‰èˆˆè¶£è€…ï¼Œå¯ä»¥è¼‰ä¸‹ä¾†æ¸¬è©¦ã€‚  è©²ç¯„ä¾‹é©ç”¨æ–¼ Kubernetes v1.15.x ç‰ˆæœ¬åœ¨é€™å€‹ç¯„ä¾‹è£¡ï¼Œ æˆ‘å€‘æœƒæ’°å¯«ä¸€å€‹å°æ¸¬è©¦é©—è­‰æ˜¯å¦èƒ½åœ¨ Cluster éƒ¨ç½²ä¸€å€‹åç‚º pohsien çš„ Pod ï¼Œä¸¦ç¢ºèªé€™å€‹ Pod æ˜¯å¦æˆåŠŸåŸ·è¡Œèµ·ä¾†ã€‚  é¦–å…ˆåœ¨ kubernetes/test/e2e æ–°å¢ä¸€å€‹ pohsien è³‡æ–™å¤¾ï¼Œè£¡é¢å°±æ˜¯æ”¾ç½®æˆ‘å€‘è‡ªå·±æ’°å¯«çš„æ¸¬è©¦æª”ã€‚    $ mkdir -c kubernetes/test/e2e/pohsien        æ¥è‘—æ’°å¯«è‡ªå·±çš„æ¸¬è©¦ï¼Œä¸¦æ”¾ç½®åœ¨å‰›å‰›å»ºç«‹çš„ kubernetes/test/e2e/pohsien/ è£¡é¢ï¼ŒåŸºæœ¬ä¸Šé€™é‚Šéƒ½æ˜¯ä½¿ç”¨ client-go ä¾†æ“ä½œ Kubernetes è³‡æºã€‚æˆ‘å€‘å®šç¾©ä¸€å€‹ [Pohsien] Label ï¼Œç„¶å¾ŒæŠŠæˆ‘å€‘çš„æ¸¬é …è²¼ä¸Šé€™å€‹ Label ï¼Œä»¥æ–¹ä¾¿ä¹‹å¾ŒåŸ·è¡Œæ¸¬è©¦ã€‚    $ vim kubernetes/test/e2e/pohsien/pohsien.go$ vim kubernetes/test/e2e/pohsien/framework.go        pohsien.go     package pohsien ... var _ = SIGDescribe(&quot;Kubernetes Pohsien&#39;s Pod [Pohsien]&quot;, func() {         f := framework.NewDefaultFramework(&quot;pods&quot;)         var podClient *framework.PodClient                 ginkgo.BeforeEach(func() {                 podClient = f.PodClient()         })         ginkgo.It(&quot;Make sure the pohsien pod can be deployed&quot;, func(){             // å»ºç«‹ pod              ginkgo.By(&quot;Create Pod&quot;)             pod := &amp;amp;corev1.Pod{                         ObjectMeta: metav1.ObjectMeta{                                 Name: &quot;pohsien&quot;,                                 Labels: map[string]string{                                         &quot;name&quot;: &quot;pohsien&quot;,                                 },                         },                         Spec: corev1.PodSpec{                                 Containers: []corev1.Container{                                         {                                                 Name:  &quot;nginx&quot;,                                                 Image: &quot;nginx:1.17.3&quot;,                                         },                                 },                         },                 }             podClient.Create(pod)                             // æª¢æŸ¥ pod æ˜¯å¦æˆåŠŸé‹è¡Œèµ·ä¾†             ginkgo.By(&quot;Get the pod&quot;)                 podGetting, err := podClient.Get(pod.Name, metav1.GetOptions{})             framework.ExpectNoError(err, &quot;Failed to get the pod&quot;)             framework.ExpectNoError(f.WaitForPodRunning(podGetting.Name))             gomega.Expect(podGetting.Name, &quot;pohsien&quot;)         }) })        framework.go æ˜¯ç”¨ä¾†å®£å‘Š SIGDescribe() å‡½æ•¸ï¼Œè€Œå…¶ä»–çš„æ¸¬è©¦æª”æœƒå‘¼å«é€™å€‹å‡½æ•¸ä¸¦ä¸”å‚³éç›¸é—œåƒæ•¸(ä¾‹å¦‚è¦è¨­å®šçš„ Label ä»¥åŠ Spec ç­‰ç­‰ï¼‰ï¼Œä¸€èˆ¬ä¾†èªªæœƒåœ¨ framework.go è¨­å®šä¸€äº› Global çš„è¨­å®šæˆ–è®Šæ•¸ï¼Œä¾‹å¦‚å¹«æ•´å€‹è©²è³‡æ–™å¤¾çš„æ¸¬é …è²¼ä¸Šå°æ‡‰çš„ SIG Labelã€‚é›–ç„¶ framework.go æ‡‰è©²ä¸æ˜¯å¿…è¦çš„ï¼Œä½†æ˜¯ç‚ºäº†èˆ‡å…¶ä»–æ¸¬é …ä¸€è‡´ï¼Œå› æ­¤åœ¨æ­¤ç¯„ä¾‹æˆ‘å€‘ä¹Ÿæ–°å¢äº† framework.go ï¼Œä¸¦ä¸”åŠ ä¸Šäº†æˆ‘å€‘è™›æ§‹çš„ [pohsien-testing] Label ã€‚ framework.go     package pohsien import &quot;github.com/onsi/ginkgo&quot; // SIGDescribe annotates the test with the SIG Label. func SIGDescribe(text string, body func()) bool {     return ginkgo.Describe(&quot;[pohsien-testing] &quot;+text, body) }        ç”±æ–¼æˆ‘å€‘ç¯„ä¾‹åªæ˜¯ Demo ç”¨ï¼Œå› æ­¤åœ¨é€™è£¡ä¸¦æ²’æœ‰ç‰¹åˆ¥åš´è¬¹çš„æŒ‡å®š Label ï¼Œä½†è«‹è¨˜å¾—åœ¨æ’°å¯«è‡ªå·±çš„æ¸¬è©¦æ™‚ä¸€å®šè¦åŠ ä¸Šå°æ‡‰ Label ï¼Œå¦‚ [Slow] ã€ [Serial] ã€ [Disruptive] ç­‰ç­‰ï¼Œé€™æ¨£å¯ä»¥è®“æ¸¬è©¦äººå“¡æ›´åŠ äº†è§£ä½ çš„æ¸¬é …çš„ç‰¹æ€§ï¼Œå¦‚æœä¸ç¢ºå®šè¦åŠ ä¸Šå“ªäº› Label å¯ä»¥åœ¨ slack æˆ–æ˜¯ ç™¼ä½ˆ Issue / PR æ™‚ï¼Œæ¨™è¨» #kinds-of-tests ä¾†è©¢å•ã€‚    æ¥ä¸‹ä¾†åœ¨ kubernetes/test/e2e/e2e_test.go è£¡é¢ Import æˆ‘å€‘è‡ªå·±çš„æ¸¬é …ã€‚framework.go    package e2eimport (   &quot;flag&quot;   &quot;fmt&quot;   ...   // test sources   _ &quot;k8s.io/kubernetes/test/e2e/apimachinery&quot;   _ &quot;k8s.io/kubernetes/test/e2e/apps&quot;   ...   _ &quot;k8s.io/kubernetes/test/e2e/pohsien&quot;)...            æ¥ä¸‹ä¾†æ’°å¯«åŠä¿®æ”¹ BUILD æª”ä¾†è®“ kubetest --build æˆ–æ˜¯ make æ™‚èƒ½æŠ“åˆ°æˆ‘å€‘å¯«çš„æ¸¬è©¦æª”ã€‚ä¸»è¦æœ‰å…©å€‹åœ°æ–¹: ä¸€å€‹æ˜¯åœ¨ kubernetes/test/e2e/pohsien/ åº•ä¸‹æ–°å¢ BUILD æª”ï¼Œå¦ä¸€å€‹æ˜¯åœ¨ kubernetes/test/e2e/BUILD è£¡åŠ ä¸Šæˆ‘å€‘å¯«çš„æ¸¬è©¦æª”ã€‚          BUILD æª”å¯«æ³•å¯ä»¥åƒè€ƒå…¶ä»– E2E æ¸¬é …ã€‚        $ vim kubernetes/test/e2e/pohsien/BUILD$ vim kubernetes/test/e2e/BUILD            å®Œæˆå¾Œï¼Œæ¥ä¸‹ä¾†æˆ‘å€‘å°±å¯ä»¥åŸ·è¡Œçœ‹çœ‹ã€‚    $ kubetest --build$ kubetest --test --test_args=&quot;--ginkgo.focus=\\[Pohsien\\]&quot;[pohsien-testing] Kubernetes Pohsien&#39;s Pod [Pohsien]Make sure the pohsien pod can be deployed/root/go/src/k8s.io/kubernetes/_output/local/go/src/k8s.io/kubernetes/test/e2e/pohsien/pohsien.go:35...STEP: Create PodSTEP: Get the pod[AfterEach] [pohsien-testing] Kubernetes Pohsien&#39;s Pod [Pohsien]/root/go/src/k8s.io/kubernetes/_output/local/go/src/k8s.io/kubernetes/test/e2e/framework/framework.go:151Oct 25 09:33:54.652: INFO: Waiting up to 3m0s for all (but 0) nodes to be readySTEP: Destroying namespace &quot;pods-1457&quot; for this suite.Oct 25 09:34:16.682: INFO: Waiting up to 30s for server preferred namespaced resources to be successfully discoveredOct 25 09:34:16.740: INFO: namespace pods-1457 deletion completed in 22.085125288sOct 25 09:34:16.742: INFO: Running AfterSuite actions on all nodesOct 25 09:34:16.742: INFO: Running AfterSuite actions on node 1Ran 1 of 4414 Specs in 28.369 secondsSUCCESS! -- 1 Passed | 0 Failed | 0 Pending | 4413 SkippedPASSGinkgo ran 1 suite in 29.513161526sTest Suite Passed2019/10/25 09:34:16 process.go:155: Step &#39;./hack/ginkgo-e2e.sh --ginkgo.focus=\\[Pohsien\\]&#39; finished in 29.787466628s      åˆ°é€™è£¡ Kubernetes E2E Testing è§£é‡‹å°±å‘Šä¸€æ®µè½ï¼Œä¸‹ä¸€ç¯‡æ–‡ç« æœƒä»‹ç´¹å¦‚ä½•åœ¨è‡ªå·±å»ºç«‹çš„ Cluster åš E2E Test ã€‚References  Types Of Software Testing: Different Testing Types With Details  WIKIPEDIA - Special Interest Group  Kubernetes SIGs and Working Groups  Kubernetes Community Governance Model  Subprojects of each SIGs  Sig-Testing  test-infra  Kubernetes E2E Testing  Kubetest  Ginkgo  Gomega  End-To-End Testing in Kubernetes  Writing good e2e tests for Kubernetes  æ–‡ç« å…§å®¹çš„è½‰è¼‰ã€é‡è£½ã€ç™¼ä½ˆï¼Œè«‹è¨»æ˜å‡ºè™•: https://pohsienshih.github.io"
  },
  
  {
    "title": "ELK Filebeat With Log Rotate",
    "url": "/blog/elk-filebeat-with-log-rotate/",
    "categories": "Others",
    "tags": "ELK, log, system",
    "date": "2019-09-24 20:11:10 +0000",
    





    "snippet": "Log Rotateæ„æ€æ˜¯ç•¶logéš¨è‘—æ™‚é–“æ“´å¤§å¾Œï¼Œèƒ½å¤ è‡ªå‹•æ‰“åŒ…å£“ç¸®æˆ–æ˜¯æ¸…é™¤æ‰èˆŠlogï¼Œä»¥å…ç³»çµ±ç©ºé–“è¢«logåƒå…‰ã€‚ELK Filebeatä¸¦ç„¡æ”¯æ´log rotateçš„åŠŸèƒ½ï¼ŒBeatsä¸»è¦åŠŸèƒ½æ˜¯åšlog shippingï¼Œä¸åŒ…å«log rotateï¼Œå› æ­¤éœ€è¦é€éé¡å¤–çš„æ–¹å¼åšã€‚  åœ¨æ­¤æ–‡ç« ä¸­æ¸¬è©¦ç’°å¢ƒç‚º Ubuntu Server 18.04 LTSæ–¹æ³•1: logrotate Toolç¶²è·¯ä¸ŠæŸ¥åˆ°å¤§éƒ¨åˆ†å¹¾ä¹éƒ½æ˜¯æ¡ç”¨Linuxå…§å»ºçš„logrotateå·¥å…·ä¾†é…åˆFilebeatï¼Œä¸€èˆ¬Linuxç³»çµ±çš„å¥—ä»¶å¦‚syslog, apt-getç­‰ç­‰å…¶å¯¦éƒ½å·²ç¶“æœ‰ä½¿ç”¨logrotateé€™å€‹å·¥å…·ä¾†åšç®¡ç†ï¼Œé€™å€‹å·¥å…·å¯ä»¥è¨­å®šå®šæœŸæˆ–æ˜¯æ ¹æ“šå¤§å°ä¾†åšrotateã€‚ä»¥ä¸‹ç‚ºä¸€å€‹å°ç¯„ä¾‹:  åœ¨/var/logåº•ä¸‹å»ºç«‹ä¸€å€‹pohsien.logã€‚```bash$ cd /var/log; vim pohsien.log$ ls -l pohsien.log-rw-râ€“râ€“  1 root root 204 Aug 20 09:47  pohsien.log```  å°‡/var/log/pohsien.logåŠ åˆ°logrotateè¨­å®šæª”è£¡é¢ã€‚     $ vim /etc/logrotate.conf        æ–°å¢ä»¥ä¸‹å…§å®¹     /var/log/pohsien.log{     # å¤§å°è¶…é500KBå°±åŸ·è¡Œlog rotate     maxsize 500K     # å°‡èˆŠçš„æª”æ¡ˆå£“ç¸®ï¼Œä¸¦å‰µå»ºæ–°çš„pohsien.logæª”     # å¦‚æœæ²’å£“ç¸®çš„è©±ï¼ŒèˆŠæª”æœƒæ”¹åï¼Œç„¶å¾Œä¸€æ¨£æœƒå‰µå»ºæ–°çš„pohsien.logæª”     compress     # åšè¶…éå…©æ¬¡log rotateå°±æŠŠæœ€èˆŠçš„è³‡æ–™ç æ‰ï¼Œä¹Ÿå°±æ˜¯æœ€å¤šåªæœƒç•™å…©å€‹å£“ç¸®æª”     rotate 2 }            æ¸¬è©¦log rotate é‡è¤‡å¯«å…¥pohsien.logç„¶å¾Œæ‰‹å‹•åŸ·è¡Œlogrotateï¼Œå¯ä»¥ç™¼ç¾ç•¶æª”æ¡ˆè¶…é500KBï¼Œå°±æœƒè‡ªå‹•ç”¢ç”Ÿpohsien.log.x.gzï¼Œä¸”æœ€å¤šåªæœƒæœ‰å…©å€‹å£“ç¸®æª”ï¼Œæœ€èˆŠçš„æœƒä¸€ç›´è¢«ç æ‰ã€‚    æ‰‹å‹•åŸ·è¡Œlogrotate     $ logrotate -v /etc/logrotate.conf        æŸ¥çœ‹çµæœ     $ ls -l /var/log           æ³¨æ„äº‹é …åœ¨æ­¤ç¯„ä¾‹ä¸­åªæœ‰ä½¿ç”¨åˆ°ä¸€äº›åŠŸèƒ½ï¼Œå¯¦éš›ä¸Šlogrotateå¯ç”¨çš„åŠŸèƒ½ç›¸ç•¶å¤šï¼Œå¯è¦–å„ç¨®æƒ…å¢ƒåšèª¿æ•´ã€‚å¦å¤–logrotateæ˜¯ä½¿ç”¨cronjobåŸ·è¡Œçš„ï¼Œåœ¨Ubuntué è¨­æ˜¯15åˆ†é˜åŸ·è¡Œä¸€æ¬¡ï¼Œå¦‚æœæƒ³è¦è‡ªè¨‚åŸ·è¡Œæ™‚é–“å¯ä»¥è‡ªå·±å¦å¤–å¯«cronjobåŸ·è¡Œlogrotateï¼Œå¦å¤–è¦æ³¨æ„çš„æ˜¯å¦‚æœè¦è·Ÿfilebeatä¸€èµ·ä½¿ç”¨ï¼Œéœ€è¦é…åˆå¥½å…©å€‹çš„åŸ·è¡Œæ™‚é–“ã€‚åƒè€ƒè³‡æ–™  é³¥å“¥çš„Linuxç§æˆ¿èœ Logrotate - http://linux.vbird.org/linux_basic/0570syslog.php#rotate  How to Use logrotate to Manage Log Files - https://www.linode.com/docs/uptime/logs/use-logrotate-to-manage-log-files/ç›¸é—œè¨è«–  Log rotation and filebeat - https://discuss.elastic.co/t/log-rotation-and-filebeat/140285æ–¹æ³•2: æª¢æŸ¥filebeat registryElasticsearch staffåœ¨è¨è«–å€ æ–‡ç« 1è·Ÿæ–‡ç« 2æœ‰æåˆ°ä¸€å€‹æ¯”è¼ƒtrickyçš„æ–¹å¼:  filebeatæ¯æ¬¡æˆåŠŸå‚³é€å®Œæª”æ¡ˆå¾ŒæœƒæŠŠè¨˜éŒ„å¯«åœ¨/var/lib/filebeat/registry/filebeat/data.json  å¯«ä¸€éš»cronjobæˆ–æ˜¯å…¶ä»–ç¨‹å¼æª¢æŸ¥data.jsonè£¡çš„offsetæ˜¯å¦è·Ÿlogæª”æ¡ˆå¤§å°ä¸€æ¨£ï¼Œå¦‚æœä¸€æ¨£å°±ä»£è¡¨å‚³è¼¸å®Œäº†ï¼Œç„¶å¾Œåˆªæ‰å‚³è¼¸å®Œçš„logæª”æ¡ˆã€‚ç›¸é—œè¨è«–  Delete processed log entries - https://discuss.elastic.co/t/delete-processed-log-entries/75960  FileBeats -Are there any ways we can delete the log files after file beat harvest the data to logstash - https://discuss.elastic.co/t/filebeats-are-there-any-ways-we-can-delete-the-log-files-after-file-beat-harvest-the-data-to-logstash/177997  æ–‡ç« å…§å®¹çš„è½‰è¼‰ã€é‡è£½ã€ç™¼ä½ˆï¼Œè«‹è¨»æ˜å‡ºè™•: https://pohsienshih.github.io"
  },
  
  {
    "title": "iThome Kubernetes Summit 2019 å¿ƒå¾—",
    "url": "/blog/2019-ithome-kubernetes-summit-notes/",
    "categories": "Kubernetes",
    "tags": "conference",
    "date": "2019-09-16 21:11:58 +0000",
    





    "snippet": "é€™æ¬¡æ˜¯ç¬¬ä¸€æ¬¡åƒåŠ iThome Kubernetes Summitï¼Œç•¶åˆçœ‹åˆ°æ—©é³¥ç¥¨é‡‹å‡ºå°±ç›´æ¥è²·äº†($2400å·¦å³)ï¼Œä»¥ä¸€å¤©çš„Conferenceä¾†èªªä¸ç®—ä¾¿å®œï¼Œä½†æ˜¯èƒ½å¤ å»å­¸ç¿’å­¸ç¿’å¢å»£è¦‹èä¹Ÿæ˜¯å€¼å¾—çš„ã€‚çµæœè²·ç¥¨ä¹‹å¾Œæ‰å¾—çŸ¥æˆ‘å€‘ç¤¾ç¾¤Cloud Native Taiwan User Group(CNTUG)ä¹Ÿæœ‰å»æ“ºæ”¤ï¼Œé›–ç„¶æ˜¯ä»˜è²»ç¥¨ï¼Œä½†æ˜¯é‚„æ˜¯å»æ”¯æ´äº†ä¸€ä¸‹ç¤¾ç¾¤æ”¤ä½xDã€‚ä¸Šåˆå ´éƒ½åœ¨è·Ÿé™„è¿‘ç¤¾ç¾¤äº¤æµã€é€›æ”¤ä½ä»¥åŠé¡§ç¤¾ç¾¤æ”¤ä½ï¼Œå› æ­¤åªè½äº†ç¬¬ä¸€å ´ã€Œè³£K8s çš„äººä¸æ•¢å‘Šè¨´ä½ çš„äº‹ã€ã€‚ä¸‹åˆèŠ±æ¯”è¼ƒå¤šçš„æ™‚é–“åœ¨è½è­°ç¨‹ï¼Œä»¥ä¸‹åˆ—å‡ºéƒ¨åˆ†è­°ç¨‹çš„ç°¡å–®å¿ƒå¾—è·Ÿç­†è¨˜ã€‚ç›®å‰å®˜æ–¹å·²ç¶“æœ‰å°‡ç°¡å ±é‡‹å‡ºï¼Œä¹Ÿæœ‰é‡‹å‡ºç•¶å¤©å¤§æœƒå„è­°ç¨‹å…±ç­†ï¼Œæœ‰èˆˆè¶£çš„äººå¯ä»¥åƒè€ƒï¼šè­°ç¨‹: https://summit.ithome.com.tw/kubernetes/å¤§æœƒå…±ç­†: https://hackmd.io/@k8ssummit/19/%2FRe80SUVITjWAMbUwaUVnWwè³£ K8s çš„äººä¸æ•¢å‘Šè¨´ä½ çš„äº‹è‘‰ç§‰å“²ï¼ˆWilliamï¼‰ / æ–°åŠ å¡å•†éˆ¦å¦ç§‘æŠ€ Technical CoachSlideé€™å ´è­°ç¨‹å¤§å¤šæ¯”è¼ƒåå‘ä½¿ç”¨è€…åœ¨å°å…¥Kubernetesæ™‚éœ€è¦æ€è€ƒçš„äº‹ï¼Œå¤§éƒ¨åˆ†è³£K8så¹³å°çš„å» å•†åœ¨å”åŠ©å°å…¥Kubernetesçš„æ™‚å€™éƒ½åªæåˆ°å¥½è™•(å¥½ç®¡ç†Containerä»¥åŠå¥½Scale)ï¼Œä½†æ˜¯éƒ½æ²’æœ‰æåˆ°ç¶­é‹æˆæœ¬ä»¥åŠå…¶ä»–å±¤é¢(Networking, Storage etc)ã€‚è¬›è€…æåˆ°äº†åœ¨å°å…¥Kubernetesæ™‚ï¼Œå¯ä»¥ä½¿ç”¨ä¸‰ç¨®æ–¹å¼ä¾†æ›´åŠ äº†è§£åŠå®šä½å‡ºè‡ªå·±çš„éœ€æ±‚æˆ–ç›®æ¨™ï¼š1. ä»»ä½•äº‹æƒ…ä¸èƒ½åªçœ‹è¡¨é¢ï¼Œè¦äº†è§£ç¾å¯¦é¢ã€‚ä½¿ç”¨5W1H(What,Where,When,Why,Who,How)åˆ†ææ³•å»äº†è§£äº‹æƒ…ï¼Œè¦æ·±å…¥çš„å»äº†è§£äº‹æƒ…ï¼Œä¸èƒ½åªå–®å–®çœ‹è¡¨é¢ï¼Œè¬›è€…é€™è£¡æåˆ°ä¸€äº›ä¾‹å­ï¼šKuberneteså®˜æ–¹å°Kubernetesçš„ä»‹ç´¹ï¼šOpenSourceã€Auto-Deploymentã€Containerizedç­‰ç­‰ã€‚é€™å€‹æ™‚å€™å¯ä»¥å»æ€è€ƒï¼š  OpenSourceå¦‚æœå‡ºå•é¡Œï¼Œæœ‰å“ªå€‹å» å•†å¯ä»¥supportå˜›ï¼Ÿ  ç‚ºä»€éº¼ç›´åˆ°ç¾åœ¨æ‰æœ‰é€™ç¨®Auto-Deployment Containeræœå‹™æˆ–è‘—æ˜¯è·Ÿç¾æœ‰çš„è§£æ±ºæ–¹æ¡ˆå·®åˆ¥åœ¨å“ªï¼Ÿ  æˆ‘å€‘çœŸçš„åšå¥½è‡ªå‹•åŒ–çš„æº–å‚™å—ï¼Ÿæˆ‘å€‘çš„ServiceçœŸçš„æº–å‚™å¥½Auto-Deploymentäº†å—ï¼Ÿ  ç‚ºä»€éº¼æœƒéœ€è¦Containerizedï¼Ÿ  Service Containerizedä¹‹å¾Œç©©å®šå—ï¼Ÿ  â€¦iThome éåœ°é–‹èŠ±çš„K8sèˆ‡å®¹å™¨æ‡‰ç”¨æ–‡ç« ï¼Œè£¡é¢æåˆ°K8sã€å®¹å™¨åŒ–ã€å¾®æœå‹™ã€éƒ¨ç½²è·Ÿç®¡ç†æ–¹ä¾¿ä»¥åŠHybrid Cloud Solutionç­‰ç­‰ã€‚é€™å€‹æ™‚å€™å¯ä»¥å»æ€è€ƒï¼š  ç‚ºä»€éº¼éœ€è¦å¾®æœå‹™? å„ªç¼ºé»æ˜¯ä»€éº¼ï¼Ÿ  ä»€éº¼æƒ…æ³ä¸‹æœƒéœ€è¦Hybrid Cloud Solutionï¼Œä»¥åŠç‚ºä»€éº¼ä»¥å‰æ²’æœ‰æ¨é€™ç¨®Solution?  â€¦Kubernetes at GitHubï¼ŒGitHubåœ¨è‡ªå®¶æœå‹™ä½¿ç”¨Kubernetesçš„æˆåŠŸæ¡ˆä¾‹ï¼Œä»–å€‘ä¸€é–‹å§‹å…ˆå°github.comä»¥åŠapi.github.comå°å…¥Kubernetesï¼Œä¸”ç¬¬ä¸€éšæ®µå…ˆæŠŠstatelessæœå‹™é·ç§»åˆ°Kubernetesä¸Šã€‚å…ˆé¸æ“‡github.comä»¥åŠapi.github.comçš„åŸå› æ˜¯å› ç‚ºé€™å…©å€‹æœå‹™å°å…¥æœ€è‰±é›£ï¼Œåªè¦é€™å…©å€‹å°å…¥æˆåŠŸçš„ï¼Œå…¶ä»–çš„æ‡‰è©²å°±æ¯”è¼ƒæ²’å•é¡Œã€‚å°å…¥çš„å·¥ä½œä¸»è¦æ˜¯ç”±æ˜¯SREã€Platformä»¥åŠDeveloperä¸‰å€‹ä¸€èµ·åƒèˆ‡å°å…¥ã€‚çœ‹åˆ°é€™äº›å¯ä»¥å»æ€è€ƒï¼š  ç‚ºä»€éº¼å°å…¥è¦å…ˆä»¥æœ€è‰±é›£çš„æœå‹™å°å…¥ï¼Ÿä¸æ˜¯é€šå¸¸éƒ½æœƒå…ˆç”¨ç°¡å–®æˆ–æ¯”è¼ƒä¸é‡è¦çš„æœå‹™æ¸¬è©¦Kubernetesï¼Œç„¶å¾Œå†æ…¢æ…¢æŠŠé‡è¦çš„é·ç§»ä¸Šå»å—ï¼ŸGitHubé€™æ¨£æ˜¯æœ‰ä¸åŒè€ƒé‡å—ï¼Ÿå°æˆ‘çš„ä¼æ¥­è€Œè¨€å“ªç¨®æ¯”è¼ƒé©åˆå‘¢ï¼Ÿ  ç‚ºä»€éº¼æœƒéœ€è¦SREã€Platformä»¥åŠDeveloperä¸‰ç¨®å·¥ç¨‹å¸«ä¸€èµ·åƒèˆ‡ï¼Ÿç¼ºå°‘ä»»ä¸€å€‹å¯ä»¥å—ï¼Ÿ  ç‚ºä½•å…ˆæŒ‘é¸statelessæœå‹™åšè™•ç†å‘¢ï¼Ÿ2. æ“´å±•è‡ªå·±çš„çŸ¥è­˜å¤šæ“´å±•è‡ªå·±çš„çŸ¥è­˜ï¼Œå¯ä»¥å¤šçœ‹CNCF Cloud Native Interactive Landscapeï¼Œç­è§£projectçš„åˆ†é¡ï¼Œä¸¦ä¸”å®šä½è‡ªå·±ç›®å‰éœ€è¦é”æˆçš„æ˜¯å“ªäº›ç›®æ¨™ï¼Œå¤šäº†è§£ä¸€äº›ï¼Œä¸è¦å†’ç„¶é¸å» å•†è·Ÿè§£æ±ºæ–¹æ¡ˆã€‚å¦å¤–ä¹Ÿå¯ä»¥åƒè€ƒCNCF Trail Mapï¼Œè£¡é¢æœ‰æä¾›åå€‹éšæ®µä¾†å»ºè­°ä¼æ¥­æ¼¸é€²å¼å°å…¥Cloud Nativeå°ˆæ¡ˆï¼Œå¯ä»¥è©¢å•è‡ªå·±ç›®å‰æƒ³è¦åšçš„æ˜¯å“ªä¸€éšæ®µæˆ–æ˜¯å» å•†æä¾›çš„æ˜¯å“ªä¸€éšæ®µçš„æœå‹™ï¼Ÿ3. Devè·ŸOpséƒ½éœ€è¦äº†è§£è¦å°å…¥Kubernetesçµ•å°ä¸æœƒåªæ˜¯Operationçš„äº‹ï¼ŒDevelopmentä¹Ÿæ˜¯ç›¸ç•¶é‡è¦çš„ï¼Œå–„ç”¨å„æ–¹é¢çš„çŸ¥è­˜ï¼Œä¸¦ä¸”äº’ç›¸äº¤æµï¼Œæ‰èƒ½å¤ é™ä½å°å…¥Kubernetesçš„é–€æª»ã€‚Docker Swarm å¤ªé™½æ˜¥ K8s å¤ªè¤‡é›œï¼Ÿè©¦è©¦è¼•é‡ç´šçš„ K3s å§ï¼ç‹å‰ä»»ï¼ˆWeithennï¼‰ / Micron Technology Senior System Engineeré€™å€‹è­°ç¨‹ä¸»è¦æ˜¯åœ¨ä»‹ç´¹Rancher K3sï¼Œæåˆ°K3sæ¯”èµ·ä¸€èˆ¬Kubernetesé‚„è¦æ›´åŠ çš„è¼•é‡åŒ–åŠå·®ç•°é»(SQLiteå–ä»£etcd,é è¨­Container Runtimeä½¿ç”¨containerd)ã€‚ç”±æ–¼ä»–éå¸¸çš„è¼•é‡ï¼Œå› æ­¤å¾ˆé©åˆéƒ¨ç½²åœ¨å¦‚æ¨¹è“æ´¾é€™æ¨£çš„IoTè£ç½®ä¸Šï¼Œä¸”éƒ¨ç½²æ–¹å¼éå¸¸æ–¹ä¾¿ï¼Œä¹Ÿèƒ½å¤ æ•´åˆKubernetesé è¨­çš„dashboardæˆ–æ˜¯Rancher Dashboardä¾†åšç®¡ç†ã€‚Harden Your Kubernetes Clusterè”¡å®—åŸï¼ˆsmalltownï¼‰ / Maicoin Senior Site Reliability Engineerslideæ­¤è­°ç¨‹è¬›è€…ä¸»è¦é‡å°ä¸åŒçš„å±¤é¢ä¾†æ¢è¨å¦‚ä½•å¢å¼·Kubernetesçš„å®‰å…¨æ€§ã€‚è¬›è€…æåˆ°äº†éå¸¸å¤šå¯¦ç”¨çš„ç¶“é©—è·Ÿå·¥å…·ï¼Œé€™è£¡æœ‰äº›éƒ¨åˆ†æ²’æœ‰ç­†è¨˜åˆ°æˆ–æ˜¯ä¸æ¸…æ¥šï¼Œå»ºè­°å¯ä»¥ç›´æ¥çœ‹ç°¡å ±æ¯”è¼ƒè©³ç´°ã€‚Image  ç›¡é‡ä½¿ç”¨Minimal Base Imageï¼Œå¤ªå¤§åŒ…çš„imageå¯èƒ½æœƒæœ‰ä¸å¿…è¦çš„å¥—ä»¶ï¼Œå¢åŠ å®‰å…¨é¢¨éšªã€‚  é™åˆ¶åŸ·è¡ŒContainerçš„ä½¿ç”¨è€…èº«ä»½ï¼Œä»¥å…è®“Containerå–å¾—éå¤§çš„æ¬Šé™ã€‚  Imageç›¡é‡ä¸è¦ä½¿ç”¨latestç‰ˆæœ¬ï¼Œå› ç‚ºlatestå°æ‡‰åˆ°çš„Imageå¯èƒ½æœƒä¸€ç›´è®Šå‹•ã€‚  ä¸è¦éš¨æ„ç›¸ä¿¡Registryä¸Šçš„Imageï¼Œå› ç‚ºä½ ç„¡æ³•ç¢ºä¿é‚£çœŸçš„æ˜¯å®˜æ–¹é‡‹å‡ºçš„ã€‚  å¯ä»¥ä½¿ç”¨ç°½ç« æ©Ÿåˆ¶ä¾†è­˜åˆ¥å®˜æ–¹é‡‹å‡ºçš„Imageï¼Œ(å¯ä½¿ç”¨Notary)ã€‚  Imageä¸è¦å„²å­˜ä¸€äº›æ•æ„Ÿè³‡è¨Šï¼Œç›¡é‡ç”¨ä¸€äº›Secretå½¢å¼ä¾†å–ä»£ã€‚  Use COPY instead of ADD  å¯ä½¿ç”¨ Anchor, Clair, Trivyä¾†å°imageåšCVEæƒæï¼Œæ‰¾å‡ºImageæ·ºåœ¨çš„æ¼æ´ã€‚  Regular Vulnerability Assessment -&amp;gt; è©•ä¼°è·Ÿåˆ†é¡æƒç„å‡ºä¾†çš„æ¼æ´  DevSecOps -&amp;gt; æŠŠimage security æ•´åˆCI/CDã€‚Credential  Kubernetes Secretæ”¾åœ¨Clusterè£¡ä¸ä¸€å®šå®‰å…¨ã€‚  HashiCorp Vault -&amp;gt; ç®¡ç†credentials ç”Ÿå‘½é€±æœŸåŠå„²å­˜ï¼Œæ”¯æ´Dynamic Credentialsï¼Œå¯ä»¥æ•´åˆpublic cloudæˆ–æ˜¯DBã€‚  Credentials Lifecycleï¼šä¸è¦æŠŠCredentials å­˜åœ¨Diskï¼Œå¯å­˜åœ¨Memoryï¼Œä½¿ç”¨å®Œå°±ç›´æ¥æ¸…æ‰ï¼Œä¸è¦ä¿å­˜ã€‚Network  é è¨­æƒ…æ³ä¸‹ï¼ŒPodä¹‹é–“æ˜¯æ²’æœ‰éš”é›¢çš„ï¼Œç¶²è·¯éƒ½æ˜¯äº’é€šã€‚  Kubernetes Network Policy(é ˆæ³¨æ„ä¸¦ä¸æ˜¯æ¯å€‹CNIéƒ½æœ‰æ”¯æ´ï¼Œslideè£¡é€£çµæœ‰æ”¯æ´è¡¨å¯ä»¥åƒè€ƒ)  Podè·ŸPodä¹‹é–“å‚³è¼¸æ˜¯æ˜ç¢¼çš„ï¼Œå¾ˆå®¹æ˜“æœƒæœ‰MITMã€‚  Istio è£¡é¢podè·Ÿpodä¹‹é–“æœƒæœ‰envoy proxyåšå‚³è¼¸ï¼Œå¯ä»¥åœ¨é€™é‚Šåšæ‰‹è…³(Istio TLS)ï¼Œå°‡podè·Ÿpodä¹‹é–“å‚³è¼¸åšåŠ å¯†ã€‚  Istio with Kiali ( å¯ä»¥è¦–è¦ºåŒ–podä¹‹é–“pod trafficæµé‡ï¼Œä¹Ÿæœƒé¡¯ç¤ºé€£ç·šæ˜¯å¦æœ‰åŠ å¯†ã€‚Runtime(podåº•å±¤)åˆ†æˆå…©å€‹éƒ¨åˆ† Auditing &amp;amp; Enforcement  Enforcement -&amp;gt; å¼·è¿«å»åšä¸€äº›äº‹æƒ…(pod security policy, aurmor)  Falco -&amp;gt; é™å®šä½¿ç”¨è€…ä¸èƒ½åšä»€éº¼äº‹ï¼Œä¾‹å¦‚ä½¿ç”¨è€…æƒ³è¦execåˆ°podåŸ·è¡Œbashï¼Œå‹•ä½œå°±æœƒè¢«æ“‹ä½ï¼Œç„¶å¾ŒFalcoæœƒå‚³é€šçŸ¥çµ¦administratorã€‚Policy as Code  Open Policy Agent (Kubernetes Admission Control, HTTP API Authorization)  OPA Flowï¼Œæœ‰é»é¡ä¼¼æœƒæœ‰ä¸€å€‹authorization/authentication serverå»å°æ¬Šé™åšç®¡ç†ï¼Œk8såœ¨åŸ·è¡Œä»»ä½•å‹•ä½œå‰éƒ½æœƒå»å•authorization serverä¾†æ±ºå®šå¯ä¸å¯ä»¥åŸ·è¡Œã€‚  éœ€æ³¨æ„OPAä¸æ˜¯ä½¿ç”¨yamlä¾†æ’°å¯«ï¼Œæ˜¯è‡ªå·±çš„èªæ³•ã€‚å‰æ–¹æœ‰é›·åˆ¥å†è¸©â”€ä¼æ¥­å°å…¥ Kubernetes çš„æƒé›·æŒ‡å—æœ±åŸ¹è¯ / å¤šå¥‡æ•¸ä½å‰µæ„ç³»çµ±å·¥ç¨‹å¸«æ­¤è­°ç¨‹çš„è¬›è€…æ•´ç†äº†éå¸¸å¤šçš„Kubernetes Best Practiceï¼Œå¾update, scaling, secretç®¡ç†åˆ°labelæ‡‰ç”¨ã€è³‡æºæ‡‰ç”¨ä»¥åŠç›£æ§ç­‰ç­‰ï¼Œéå¸¸å¤šå¯¦ç”¨çš„å…§å®¹ï¼Œé€™éƒ¨åˆ†å› ç‚ºä¸€äº›åŸå› æ²’æœ‰è¨˜éŒ„å¤ªå¤šç­†è¨˜ï¼Œä¸éè¬›è€…çš„ç°¡å ±ç›¸ç•¶è©³ç´°ï¼Œå› æ­¤å»ºè­°å¯ä»¥ç›´æ¥åƒè€ƒç°¡å ±ã€‚ç¸½çµé€™è£¡ç­†è€…åªåˆ—å‡ºä¸€äº›è­°ç¨‹ç­†è¨˜ï¼Œå…¶ä»–æ¯”è¼ƒåå®‰è£æ•™å­¸æˆ–æ˜¯æœ‰äº›æ²’æœ‰ç­†è¨˜åˆ°çš„å°±æ²’æœ‰å¯«åœ¨é€™ä¸Šé¢ï¼Œæœ‰èˆˆè¶£è€…å¯ä»¥åƒè€ƒå®˜æ–¹çš„å…±ç­†æˆ–æ˜¯ç°¡å ±ã€‚é€™æ¬¡åƒåŠ çš„æ„Ÿæƒ³æ˜¯è­°ç¨‹éƒ¨åˆ†æ¯”è¼ƒå…¥é–€é¡ï¼Œåå‘ç¶“é©—åˆ†äº«æˆ–æ˜¯å·¥å…·ä½¿ç”¨æ•™å­¸ï¼Œå¾ˆé©åˆåƒç­†è€…é€™æ¨£çš„èœé³¥æ–°æ‰‹å»è½ã€‚æ”¤ä½éƒ¨åˆ†ä¸å¤šï¼Œå¤§æ¦‚åªæœ‰å¹¾å®¶æ¯”è¼ƒå¤§çš„è´ŠåŠ©å•†ä¾†æ“ºæ”¤ï¼Œä¸éå» å•†è´ˆå“é€çš„é‚„è »å¤šçš„ï¼Œå¦å¤–é€™æ¬¡å¾ˆç‰¹åˆ¥çš„æ˜¯æœ‰ä¾†è‡ªåœ‹å¤–çš„Dr.Brad Topolç°½æ›¸æœƒ(æ›¸åKubernetes in the Enterprise)ï¼Œåªè¦ç”¨åç‰‡å°±å¯ä»¥æ›åˆ°ä¸€æœ¬åŸæ–‡ç°½åæ›¸ï¼Œç®—æ˜¯é€™æ¬¡Conferenceä¸­æœ€ä½›å¿ƒçš„æ´»å‹•ã€‚æœ€å¾Œé‚„æ˜¯è¦ºå¾—ç¥¨åƒ¹ä¸ä¾¿å®œï¼Œå¸Œæœ›æ˜å¹´æœ‰æ©Ÿæœƒèƒ½å¤ ç•¶è¬›è€…ï¼Œé™¤äº†èƒ½ç´¯ç©ç¶“é©—å¤–ï¼Œä¹Ÿèƒ½ä½¿ç”¨è¬›è€…ç¥¨åƒåŠ ï¼Œä¸€èˆ‰æ•¸å¾—ã€‚Cloud Native Taiwan User Groupæ”¤ä½Kubernetes in the Enterpriseä½œè€…ç°½æ›¸æœƒ  æ–‡ç« å…§å®¹çš„è½‰è¼‰ã€é‡è£½ã€ç™¼ä½ˆï¼Œè«‹è¨»æ˜å‡ºè™•: https://pohsienshih.github.io"
  },
  
  {
    "title": "é‡å°Enterprise PKSç’°å¢ƒçš„K8s Cluster Nodeç¡¬ç¢Ÿç©ºé–“ä¸è¶³æ¸¬è©¦åŠè§£æ³•",
    "url": "/blog/enterprise-pks-k8s-node-disk-out-of-space/",
    "categories": "Pivotal, Container, Service",
    "tags": "pks, kubernetes",
    "date": "2019-07-02 21:22:24 +0000",
    





    "snippet": "  æ­¤ç¯‡æ–‡ç« å·²ä¸å†æ›´æ–°ï¼Œå…§å®¹å¯èƒ½å·²éæ™‚é€™ç¯‡ä¸»è¦æ˜¯æ¸¬è©¦Enterprise PKSä½ˆå‡ºä¾†çš„Kubernetes Node ä¸Šé¢çš„ç¡¬ç¢Ÿæ»¿äº†æœƒé€ æˆä»€éº¼å½±éŸ¿ä»¥åŠè¦å¦‚ä½•è§£æ±ºã€‚å…¶å¯¦é€™å€‹å•é¡Œæ‡‰è©²è·Ÿä¸€èˆ¬Kubernetesç’°å¢ƒå·®ä¸å¤šï¼Œåªæ˜¯ç›®å‰æœ‰ä¸€äº›caseç·£æ•…é‚„æ˜¯éœ€è¦åœ¨Enterprise PKSç’°å¢ƒä¸‹æ¸¬è©¦ä¸€ä¸‹ã€‚å› æ­¤ç‰¹åˆ¥é‡å°é€™éƒ¨åˆ†åšæ¸¬è©¦ã€‚Kubernetes Nodeä¸Šçš„diskç¨®é¡åœ¨PCF Ops Manager Web GUI &amp;gt; Enterprise PKS Tile &amp;gt; Planè£¡ï¼Œå¯ä»¥è¨­å®šEnterprise PKSéƒ¨ç½²å‡ºä¾†çš„Kubernetes Clusterè³‡æºï¼Œå…¶ä¸­æœ‰ä¸€äº›æ¬„ä½æ˜¯è¨­å®šnode VMçš„ç¡¬ç¢Ÿè³‡è¨Š:é è¨­BOSHç”¢ç”Ÿå‡ºä¾†çš„nodeä¸Šé¢æœƒæœ‰ä¸‰é¡†è™›æ“¬ç¡¬ç¢Ÿã€‚é€™è£¡æˆ‘å€‘ç”¨sda,sdb,sdcä¾†ä»£ç¨±ã€‚  sda: Node System Diskï¼Œæ›è¼‰ç›®éŒ„ç‚º/ï¼Œç‚ºnode VMä½œæ¥­ç³»çµ±çš„æ ¹ç›®éŒ„ï¼Œé€™å€‹å¤§å°ç›®å‰æ˜¯ä¸èƒ½è¨­å®šçš„ï¼Œé è¨­3GBã€‚  sdb: Agent Package Diskï¼Œæ›è¼‰ç›®éŒ„ç‚º/var/vcap/data...ï¼Œç‚ºå­˜æ”¾pks-systemä»¥åŠbosh agenté€™äº›å¿…è¦å¥—ä»¶çš„ä½ç½®ï¼Œé€™å€‹å°±æ˜¯PCF Ops Managerä¸Šè¨­å®šçš„VM Typeè£¡é¢çš„diskå¤§å°ã€‚  sdc: Persistent Diskï¼Œæ›è¼‰ç›®éŒ„/var/vcap/store/...ï¼Œé€™å€‹diskåœ¨masterä¸­æ˜¯ç”¨ä¾†å­˜etcdçš„ï¼Œå› æ­¤åªè¦diskæ²’æœ‰æ›æ‰ï¼Œä¸ç®¡BOSHæ€éº¼ä¿®å¾©masterï¼Œetcdè³‡æ–™éƒ½ä¸æœƒæ¶ˆå¤±ã€‚å¦‚æœæ˜¯workerçš„è©±ï¼Œé€™å€‹diskæ˜¯ç”¨ä¾†å­˜docker container ä»¥åŠdocker imageã€‚sdcå¤§å°æ˜¯æ ¹æ“šPCF Ops Managerè£¡é¢è¨­å®šçš„Persistent Disk Typeä¾†é…ç½®ã€‚  ç•¶nodeç™¼ç”ŸéŒ¯èª¤è€Œå•Ÿå‹•BOSHè‡ªå‹•ä¿®å¾©æ©Ÿåˆ¶æ™‚ï¼Œåªæœ‰sdcè³‡æ–™æœƒè¢«ä¿ç•™ï¼Œå…¶ä»–çš„éƒ½æœƒè¢«æ¸…ç©ºé‚„åŸæˆåˆå§‹ç‹€æ…‹ã€‚  ä¸Šé¢diskåç¨±åªæ˜¯æ–¹ä¾¿è­˜åˆ¥ï¼Œä¸¦éå®˜æ–¹å–åã€‚ç”±æ–¼diskè£¡çš„è³‡æ–™å¯èƒ½æœƒéš¨è‘—æ™‚é–“æˆé•·ï¼Œä¾‹å¦‚:log, docker image/containeæˆ–æ˜¯ä¸€äº›æš«å­˜æª”ç­‰ç­‰ã€‚ç‚ºäº†ç¢ºå®šæ¸…æ¥šç¡¬ç¢Ÿå¡çˆ†æ˜¯å¦æœƒå½±éŸ¿Kubernetesæœå‹™ï¼Œå› æ­¤æ¥ä¸‹ä¾†æœƒæ¸¬è©¦å¡çˆ†ä¸‰ç¨®diskä¸¦è§€å¯Ÿæœƒç™¼ç”Ÿçš„æƒ…æ³ã€‚ä½¿ç”¨åˆ°çš„æŒ‡ä»¤å»ºç«‹ä»»æ„å¤§å°çš„æª”æ¡ˆ$ fallocate -l &amp;lt;æª”æ¡ˆå¤§å°&amp;gt; &amp;lt;æª”æ¡ˆåç¨±&amp;gt;Example:$ fallocate -l 50G testæŸ¥çœ‹ç›®éŒ„å±¬æ–¼å“ªé¡†diskã€å¤§å°åŠä½¿ç”¨ç‡$ df &amp;lt;ç›®éŒ„&amp;gt; -hExample:$ df /var/vcap/ -hæŸ¥çœ‹ç›®éŒ„æˆ–æª”æ¡ˆå¤§å°$ du -sh &amp;lt;æª”æ¡ˆåç¨±/ç›®éŒ„&amp;gt;Example:$ du -sh /var/vcap/æŸ¥çœ‹dockeræ ¹ç›®éŒ„$ docker system infoæŸ¥çœ‹docker image/containeræ•¸é‡/å¤§å°è³‡è¨Š$ docker system dfNode System Disk(sda)æ¸¬è©¦ç’°å¢ƒ:  1å°master, 2å°workeræ¸¬è©¦çµæœ  Containerä¸æœƒæ›æ‰ï¼Œæ­£å¸¸é‹è¡Œã€‚  BOSH sshåˆ°workerçš„æ™‚å€™æœƒé¡¯ç¤ºno space left on deviceéŒ¯èª¤ã€‚  ä¿®å¾©æ–¹å¼          é—œé–‰å£æ‰çš„nodeè®“BOSHè‡ªå‹•ä¿®å¾©ï¼Œç”¢ç”Ÿæ–°çš„node VMã€‚      å¦‚æœé‚„èƒ½ç™»å…¥nodeï¼Œå¯ä»¥æ¸…æ‰ä¸€äº›è³‡æ–™é‡‹å‡ºNode System Disk(sda)ç©ºé–“ã€‚      æ¸¬è©¦æµç¨‹      ä½¿ç”¨kubectlå»ºç«‹deploymentåˆ°clusterä¸Šã€‚    é€£åˆ°worker VMè£¡ä¸¦å¡æ»¿sdaç©ºé–“     # SSH bosh -d &amp;lt;deployment&amp;gt; ssh &amp;lt;worker&amp;gt; # åˆ‡æ›åˆ°/dev/sda1æ›è¼‰ç›®éŒ„ cd /var # å¡æ»¿ç©ºé–“ fallocate -l 10G test        Containerä¾ç„¶æ­£å¸¸é‹è¡Œç„¡ç•°å¸¸ï¼Œä½†æ˜¯ç•¶åŸ·è¡Œbosh sshæ™‚å‡ºç¾ä¸‹åœ–ç©ºé–“ä¸è¶³éŒ¯èª¤ã€‚Agent Packages Disk(sdb)æ¸¬è©¦ç’°å¢ƒ:  1å°master, 2å°workeræ¸¬è©¦çµæœ  Nodeæœƒæ›æ‰ï¼Œç„¡æ³•è² è·åŸæœ¬çš„containerï¼Œå› æ­¤åŸæœ¬ä¸Šé¢è·‘çš„containeréƒ½æœƒè®ŠæˆEvictedç‹€æ…‹ã€‚(å¯èƒ½æœƒé€ æˆæœå‹™ä¸­æ–·)  å¦‚æœæœ‰é¡å¤–çš„nodeå¯ç”¨ï¼Œmasteræœƒä½ˆæ–°çš„containeråˆ°åˆ¥å°nodeä¸Šã€‚å¦‚æœæ²’æœ‰ï¼Œæ‰€æœ‰containeréƒ½æœƒè®ŠæˆPendingç‹€æ…‹ã€‚  ä¿®å¾©æ–¹å¼:          æ¸…å‡ºAgent Packages Diskç©ºé–“ï¼Œç„¶å¾ŒåŸ·è¡Œmonit restart allï¼Œé€™æ¨£nodeå°±æœƒæ¢å¾©æ­£å¸¸ã€‚      æ¸¬è©¦æµç¨‹      ä½¿ç”¨kubectlå»ºç«‹deploymentåˆ°clusterä¸Šã€‚    é€£åˆ°worker VM(b685858b...)è£¡ä¸¦å¡æ»¿sdbç©ºé–“     # SSH bosh -d &amp;lt;deployment&amp;gt; ssh &amp;lt;worker&amp;gt; # åˆ‡æ›åˆ°/dev/sdb2æ›è¼‰ç›®éŒ„ cd /var/vcap/data/ # å¡æ»¿ç©ºé–“ fallocate -l 10G test            ä½¿ç”¨kubectlæŸ¥çœ‹podsç‹€æ…‹ï¼Œå¯ä»¥çœ‹åˆ°å‰›å‰›è¢«å¡çˆ†çš„worker(b685858b...)ä¸Šçš„podséƒ½é€²å…¥Evictedç‹€æ…‹ï¼Œä¸”masteråœ¨å…¶ä»–nodeç”¢ç”Ÿæ–°çš„podsã€‚     ä½¿ç”¨kubectl describe pods &amp;lt;pod name&amp;gt;æŸ¥çœ‹Evicted podï¼Œå¯ä»¥çœ‹åˆ°æ˜¯å› ç‚ºnodeç©ºé–“ä¸è¶³å°è‡´çš„ã€‚Persistent Disk(sdc)æ¸¬è©¦ç’°å¢ƒ:  1å°master, 2å°workeræ¸¬è©¦çµæœ  èˆ‡Agent Packages Disk(sdb)çµæœç›¸åŒ  Nodeæœƒæ›æ‰ï¼Œç„¡æ³•è² è·åŸæœ¬çš„containerï¼Œå› æ­¤åŸæœ¬ä¸Šé¢è·‘çš„containeréƒ½æœƒè®ŠæˆEvictedç‹€æ…‹ã€‚(å¯èƒ½æœƒé€ æˆæœå‹™ä¸­æ–·)  å¦‚æœæœ‰é¡å¤–çš„nodeå¯ç”¨ï¼Œmasteræœƒä½ˆæ–°çš„containeråˆ°åˆ¥å°nodeä¸Šã€‚å¦‚æœæ²’æœ‰ï¼Œæ‰€æœ‰containeréƒ½æœƒè®ŠæˆPendingç‹€æ…‹ã€‚  ä¿®å¾©æ–¹å¼:          æ¸…å‡ºpersistent diskç©ºé–“ï¼Œç„¶å¾Œåœ¨nodeä¸ŠåŸ·è¡Œmonit restart allæŒ‡ä»¤ï¼Œé€™æ¨£nodeå°±æœƒæ¢å¾©æ­£å¸¸ã€‚      æ¸¬è©¦æµç¨‹      ä½¿ç”¨kubectlå»ºç«‹deploymentåˆ°clusterä¸Šã€‚    é€£åˆ°worker VM(3f28d443...)è£¡ä¸¦å¡æ»¿sdbç©ºé–“     # SSH bosh -d &amp;lt;deployment&amp;gt; ssh &amp;lt;worker&amp;gt; # åˆ‡æ›åˆ°/dev/sdc1æ›è¼‰ç›®éŒ„ cd /var/vcap/store/docker # å¡æ»¿ç©ºé–“ fallocate -l 50G test        ä½¿ç”¨kubectlæŸ¥çœ‹podsç‹€æ…‹ï¼Œå¯ä»¥çœ‹åˆ°å‰›å‰›è¢«å¡çˆ†çš„worker(3f28d443...)ä¸Šçš„podséƒ½é€²å…¥Evictedç‹€æ…‹ï¼Œä¸”masteråœ¨å…¶ä»–nodeç”¢ç”Ÿæ–°çš„podsã€‚æ“´å¤§Node Diskå¤§å°çœ‹åˆ°ä¸Šè¿°æ¸¬è©¦å¯ä»¥å¾—çŸ¥diskå¦‚æœæ»¿äº†æ˜¯æœ‰å¯èƒ½æœƒå½±éŸ¿æœå‹™ï¼Œè§£æ±ºæ–¹æ³•é™¤äº†æ¸…æ‰ä¸å¿…è¦çš„æª”æ¡ˆé‡‹å‡ºç©ºé–“ä¹‹å¤–ï¼Œä¹Ÿå¯ä»¥é¸æ“‡æ“´å¤§åŸæœ‰çš„ç©ºé–“ï¼Œä½†ç›®å‰èƒ½æ“´å¤§çš„åªæœ‰sdbä»¥åŠsdcã€‚å®˜æ–¹æä¾›çš„æ“´å¤§æ–¹å¼æ˜¯åˆ°PCF Ops Managerå»èª¿åŸplanè¨­å®šï¼Œä¾‹å¦‚æŠŠdiskèª¿å¤§è³‡æºèª¿å¤šç­‰ç­‰, ç„¶å¾Œapply changeçš„æ™‚å€™å‹¾é¸upgrade all cluster, é€™æ¨£åŸæœ‰çš„clusterå°±æœƒå¥—ç”¨æ–°çš„è¨­å®š(cpu/memory/persistent diskâ€¦)ï¼Œä½†åªèƒ½ä¿®æ”¹åŸplanæ•¸å€¼, ç„¡æ³•ä¿®æ”¹æˆä¸åŒplan(ä¾‹å¦‚å¾plan1æ”¹æˆplan2)ã€‚è©³æƒ…å¯åƒè€ƒé€£çµ ï¼Œå¦å¤–æ­¤æ–¹æ³•çš„ç¼ºé»æ˜¯è¦æ”¹çš„è©±ï¼Œå…¨éƒ¨åŒæ¨£ä½¿ç”¨è©²plançš„clusteréƒ½æœƒä¸€ä½µä¿®æ”¹ã€‚é™¤äº†å®˜æ–¹è§£æ³•å¤–ï¼Œç­†è€…æˆ‘æƒ³åˆ°å¦å¤–ä¸€ç¨®æ¯”è¼ƒæš´åŠ›çš„æ–¹æ³•æ˜¯ç›´æ¥åœ¨vCenteræŠŠnodeçš„ç¡¬ç¢Ÿæ“´å¤§, ä½†æ˜¯å¯¦éš›æ¸¬è©¦é€™ç¨®æ–¹å¼æœƒå°è‡´BOSHé‚£é‚Šä¸åŒæ­¥å¼•ç™¼éŒ¯èª¤ï¼Œå› æ­¤ç›®å‰é€™æ˜¯ä¸å¯è¡Œçš„ã€‚ä»¥ä¸‹æ˜¯å…©ç¨®æ–¹æ³•çš„æ¸¬è©¦æµç¨‹:PCF Ops Managerèª¿æ•´Planè¨­å®š      å‡è¨­ç›®å‰worker VM (91997fd5...) persistent diskå·²ç¶“è¢«å¡çˆ†(é è¨­50G)ï¼Œå¸Œæœ›èƒ½æ“´å¤§ç©ºé–“ã€‚            åˆ°PCF Ops Manager Web GUI &amp;gt; Enterprise PKS Tile &amp;gt; Planå°‡workerçš„persistent diskèª¿æ•´æˆ75Gã€‚            Apply Change            å®Œæˆå¾Œé€£åˆ°worker VM(91997fd5...)å»çœ‹ï¼Œå¯ä»¥çœ‹åˆ°ç©ºé–“å·²ç¶“æˆåŠŸæ“´å¤§ã€‚                Podä¹Ÿå¯ä»¥æ­£å¸¸çš„éƒ¨ç½²åœ¨worker VM (91997fd5...)ä¸Šäº†ã€‚      å¾vCenterå¼·åˆ¶èª¿æ•´Node Diskå¤§å°  æ³¨æ„é€™ç¨®æ–¹å¼æœƒå°è‡´BOSHé‚£é‚Šä¸åŒæ­¥å¼•ç™¼éŒ¯èª¤ï¼Œå› æ­¤ç›®å‰æ­¤æ–¹æ³•æ˜¯ä¸å¯è¡Œçš„ï¼Œä½†é‚„æ˜¯å°‡éç¨‹åˆ—å‡ºä¾†ä¾›åƒè€ƒã€‚      å‡è¨­ç›®å‰worker VM (3f28d443...) persistent diskå·²ç¶“è¢«å¡çˆ†(é è¨­50G)ï¼Œå¸Œæœ›èƒ½æ“´å¤§ç©ºé–“ã€‚            åˆ°vCenterä¸Šç›´æ¥å»å°‡worker VM persistent diskèª¿æ•´ç‚º80Gã€‚            æ¥ä¸‹ä¾†ç‚ºäº†é¿å…BOSHå°‡é€™å°workerç æ‰ï¼Œå› æ­¤è¦å…ˆé—œé–‰è‡ªå‹•ä¿®å¾©æ©Ÿåˆ¶ã€‚    $ bosh -d &amp;lt;deployment&amp;gt; update-resurrection  off                æ¥ä¸‹ä¾†å°‡worker VM(3f28d443...)é—œæ©Ÿã€‚            å¯ä»¥å¾bosh vmsçœ‹åˆ°è©²å°worker1 å·²ç¶“è®Šæˆunresponsive agentç‹€æ…‹ï¼Œä½†æ˜¯BOSHä¸æœƒå°‡å®ƒç æ‰ã€‚            æ¥ä¸‹ä¾†åˆ°vCenter &amp;gt; Datastore &amp;gt; pcf_disksæ‰¾åˆ°worker VM(3f28d443...)çš„persistent diskï¼Œä¸¦æ“´å¤§å®ƒçš„ç©ºé–“ã€‚    å…ˆæ‰¾å‡ºworker1å°æ‡‰çš„persistent disk(Disk CIDs)     $ bosh instances -i            åˆ°vCenter &amp;gt; Datastore &amp;gt; pcf_disksæ‰¾åˆ°å°æ‡‰çš„diskï¼Œå¯ä»¥ç™¼ç¾diské‚„æ˜¯50Gã€‚        é»æ“Šinflateä¾†æ“´å¤§ç¡¬ç¢Ÿã€‚(é€™å€‹å‹•ä½œæœƒè·‘ä¸€æ®µæ™‚é–“)        å¥½äº†ä¹‹å¾Œå¯ä»¥çœ‹åˆ°diskå·²ç¶“è®Š80Gã€‚            æ¥ä¸‹ä¾†å°‡worker1é–‹æ©Ÿï¼Œä½†æ˜¯é–‹å¥½ä¹‹å¾Œé‚„æ˜¯unresponsive agentã€‚        ä¸å¾—å·²æƒ…æ³ä¸‹åªå¥½å°‡è‡ªå‹•ä¿®å¾©é–‹èµ·ä¾†ï¼Œçœ‹çœ‹BOSHæœƒä¸æœƒç æ‰å»ºç«‹æ–°çš„workerï¼Œç„¶å¾Œå°‡persistent diskæ›è¼‰ä¸Šå»ã€‚    $ bosh -d &amp;lt;deployment&amp;gt; update-resurrection  on                BOSHé–‹å§‹ä¿®å¾©ï¼Œä½†æ˜¯ä¿®å¾©åˆ°æœ€å¾Œå¤±æ•—ï¼Œç¡¬ç¢Ÿç„¡æ³•æ›è¼‰ï¼Œå¯èƒ½æ˜¯å› ç‚ºdiskè£¡çš„partitionæœ‰è®Šå‹•åˆ°ã€‚åˆ°é€™è£¡å°±å¡ä½äº†ï¼ŒBOSHå°±ç„¡æ³•ä¿®å¾©äº†ï¼Œä¹Ÿè¨±æ˜¯æŸä¸€æ­¥åšéŒ¯æˆ–æ˜¯BOSHæœ¬èº«ä¸æ”¯æ´é€™ç¨®æ”¹æ³•ï¼Œå¾ŒçºŒå¦‚æœæœ‰æˆåŠŸå†ä¾†æ›´æ–°æ­¤ç¯‡ï¼Œç›®å‰æš«ä¸å°‡æ­¤æ–¹æ³•åˆ—å…¥è§£æ³•ã€‚      Summaryæ¸¬è©¦ä¸‹ä¾†çš„æ„Ÿè¦ºå¥½åƒè·Ÿæ˜¯ä¸æ˜¯Enterprise PKSç’°å¢ƒæ²’å•¥é—œä¿‚xDã€‚ä¸éç¶“éæ­¤æ¸¬è©¦ä¹Ÿæ¯”è¼ƒæ¸…æ¥šEnterprise PKSé‹è¡Œæ©Ÿåˆ¶ä»¥åŠé‡å°é€™ç¨®æƒ…æ³çš„è™•ç†æ–¹å¼ï¼Œä½†å°ç›®å‰çš„Enterprise PKSä¾†èªªï¼Œæ“´å¤§ç¡¬ç¢Ÿçš„æ©Ÿåˆ¶é‚„æ˜¯å¾ˆä¸å½ˆæ€§ï¼Œé€™æœ‰å¯èƒ½æ˜¯å—åˆ°BOSHçš„é™åˆ¶ï¼Œå¸Œæœ›æœªä¾†èƒ½å¤ å†åŠ å¼·é€™éƒ¨åˆ†ã€‚Reference  PKS Plan Resizing - https://community.pivotal.io/s/question/0D50e00005j9wr2/pks-plan-resizing  Changing the thick or thin provisioning of a virtual disk - https://kb.vmware.com/s/article/2014832  æ–‡ç« å…§å®¹çš„è½‰è¼‰ã€é‡è£½ã€ç™¼ä½ˆï¼Œè«‹è¨»æ˜å‡ºè™•: https://pohsienshih.github.io"
  },
  
  {
    "title": "Enterprise PKSä»‹ç´¹",
    "url": "/blog/enterprise-pks-introduction/",
    "categories": "Pivotal, Container, Service",
    "tags": "pks, kubernetes",
    "date": "2019-06-28 00:06:57 +0000",
    





    "snippet": "  æ­¤ç¯‡æ–‡ç« å·²ä¸å†æ›´æ–°ï¼Œå…§å®¹å¯èƒ½å·²éæ™‚PKSå…¨åæ˜¯Pivotal Container Serviceï¼Œé¡§åæ€ç¾©æ˜¯ç”±Pivotalé€™é–“å…¬å¸é–‹ç™¼çš„ã€‚Pivotalæ˜¯VMwareçš„å­å…¬å¸ï¼Œä¹Ÿè¨±æ¯”è¼ƒå°‘äººçŸ¥é“é€™é–“å…¬å¸ï¼Œä¸éç›¸ä¿¡å¤§å®¶æ‡‰è©²éƒ½è½étomcatæˆ–æ˜¯redisï¼Œé€™å…©å€‹çŸ¥åçš„å°ˆæ¡ˆå°±æ˜¯ç”±Pivotalé–‹ç™¼çš„ï¼Œç”±æ­¤å¯çŸ¥Pivotalä¹Ÿæ˜¯ä¸€å®¶æŠ€è¡“éå¸¸æ‰å¯¦å¼·å¤§çš„å…¬å¸ã€‚PKSä»‹ç´¹PKSæ˜¯ç”¨ä¾†ç®¡ç†/éƒ¨ç½²Kubernetes Clusterçš„ä¸€å€‹å¹³å°ï¼Œç”±æ–¼ç›®å‰Kubernetesåœ¨å»ºç½®æˆ–ç¶­é‹ä¸Šé‚„æ˜¯éœ€è¦è »é«˜çš„æˆæœ¬åŠæŠ€è¡“é–€æª»ï¼Œç‚ºäº†è¦é™ä½ç¶­é‹æˆæœ¬ï¼Œè®“ä¼æ¥­èƒ½å®Œå…¨å°ˆæ³¨åœ¨è‡ªå·±çš„æœå‹™ä¸Šï¼Œå› æ­¤æ‰æ¼¸æ¼¸é–‹å§‹æœ‰äº†é€™é¡ç®¡ç†/éƒ¨ç½²Kubernetesçš„å¹³å°å‡ºç¾ã€‚é€éé€™ç¨®å¹³å°èƒ½å¤ è¼•é¬†çš„éƒ¨ç½²Kubernetes Clusterï¼Œæœ‰äº›å¹³å°ç”šè‡³é‚„é‡å°Kubernetes Clusteræä¾›HAã€Fault Toleranceæˆ–æ˜¯Load Balancingçš„æ©Ÿåˆ¶ï¼Œå¤§å¤§é™ä½ç¶­é‹æˆæœ¬ï¼Œè€ŒPKSå°±æ˜¯å…¶ä¸­ä¸€ç¨®é€™ç¨®å¹³å°(ç”¢å“)ï¼Œé¡ä¼¼çš„å…¶ä»–ç”¢å“é‚„æœ‰Rancherã€Redhat OpenShiftä»¥åŠIBM Cloud Privateç­‰ã€‚ç›®å‰Pivotalæœ‰ä¸‰ç¨®ä¸åŒçš„PKSç”¢å“ï¼š  VMware Enterprise PKS  VMware Essential PKS  VMware Cloud PKSVMware Enterprise PKSï¼Œç›®å‰ç‚º1.4.1ç‰ˆï¼Œåœ¨1.4.0ä»¥å‰åç¨±é‚„å«åšPKSè€Œå·²ï¼Œå¯èƒ½æ˜¯å› ç‚ºè¦è·Ÿå…¶ä»–ç”¢å“å€åˆ†é–‹ä¾†å› è€Œæ”¹åï¼Œé€™å€‹ç”¢å“æ¶æ§‹ä¸»è¦æ˜¯ç”±Cloud Foundryé–‹ç™¼çš„BOSHå°ˆæ¡ˆä»¥åŠPivotalå„å¼ç”¢å“çµ„æˆï¼Œç›®å‰æ”¯æ´çš„å¹³å°ç‚ºvSphere,GCP,Azureä»¥åŠAWSï¼Œæœ¬ç¯‡æœƒä»¥Enterprise PKSä»‹ç´¹ç‚ºä¸»ï¼Œç¨å¾Œæœƒæœ‰è¼ƒè©³ç´°çš„æ¶æ§‹ä»‹ç´¹ã€‚VMware Essential PKSæ˜¯ä»Šå¹´2019å¹´3æœˆVMwareå‡ºçš„ä¸€ç¨®æ–°çš„PKSç‰ˆæœ¬ï¼Œé€™å€‹ç‰ˆæœ¬æ¯”è¼ƒç‰¹æ®Šä¸€é»ï¼Œä¸»è¦æ˜¯heptioå…¬å¸(å·²è¢«VMwareè²·ä¸‹ä¾†)é–‹ç™¼çš„ï¼Œå› æ­¤ä»–çš„æ¶æ§‹ä¸»è¦éƒ½æ˜¯ç”±heptioæ‰€æä¾›çš„Open Sourceå¥—ä»¶çµ„åˆè€Œæˆçš„ï¼Œä¾‹å¦‚ç”¨ä¾†å‚™ä»½Kubernetesçš„veleroã€æˆ–æ˜¯ä½œç‚ºproxyçš„contourç­‰ç­‰ã€‚é€™å€‹ç”¢å“ç›®å‰ç­†è€…ä¹Ÿæä¸æ¸…æ¥šå®šä½åœ¨å“ªï¼Œæ„Ÿè¦ºèˆ‡Pivotalé–‹ç™¼çš„Enterprise PKSæœ‰è¼ƒå‹æ„å‘³(Pivotalå®˜æ–¹æ–‡ä»¶ä¹Ÿå®Œå…¨æ²’æœ‰æåˆ°é€™å€‹ç”¢å“ï¼Œéƒ½åªæœ‰åœ¨VMwareç¶²ç«™æ‰æœ‰xD)ï¼Œä¸éç›®å‰é—œæ–¼é€™ç”¢å“çš„è³‡è¨Šé‚„å¤ªå°‘ï¼Œä¹Ÿè¨±éä¸€æ®µæ™‚é–“å°±æœƒçŸ¥é“å®šä½è·Ÿå·®ç•°äº†ã€‚Cloud PKSæ˜¯VMwareæä¾›çš„ä¸€å€‹Public Cloud Kubernetesç’°å¢ƒï¼Œæ˜¯ä¸€å€‹SaaSå¹³å°ï¼Œä½¿ç”¨è€…å¯ä»¥ç›´æ¥å°‡Containeréƒ¨ç½²ä¸Šå»ï¼Œå®Œå…¨ä¸éœ€è¦ç¶­è­·Kubernetesç’°å¢ƒï¼Œè©³ç´°è³‡è¨Šå¯ä»¥åƒè€ƒé€£çµã€‚PKSæ¶æ§‹çµ„æˆåœ–ç‰‡ç‚ºç°¡ç•¥çš„Enterprise PKSæ¶æ§‹åœ–ï¼Œç”±æ–¼Pivotalæ˜¯VMwareçš„å­å…¬å¸ï¼Œå› æ­¤ç›®å‰Enterprise PKSå°vSphereç’°å¢ƒç›¸å®¹æ€§æœ€å¥½ï¼Œå°¤å…¶æ˜¯çµåˆVMwaer NSX-Tèƒ½å¤ å®Œå…¨ç™¼æ®å‡ºEnterprise PKSåŠŸèƒ½ã€‚ä¸éä¸ç®¡æ˜¯é‹è¡Œåœ¨å“ªå€‹å¹³å°ï¼ŒEnterprise PKSå…ƒä»¶éƒ½æœƒä»¥VMçš„å½¢å¼é‹è¡Œï¼Œå› æ­¤æ˜¯ä¸æœƒèˆ‡å¹³å°ä¸­å…¶ä»–ä¸€èˆ¬VMç›¸è¡çªçš„ã€‚Enterprise PKS1. PCF Ops Manageré€™æ˜¯Pivotalçš„ä¸€å€‹ç”¢å“ï¼Œä¸»è¦æ˜¯æä¾›ä¸€å€‹GUIå¹³å°è®“ä½¿ç”¨è€…å¯ä»¥ç›´æ¥ä¸Šå‚³Pivotalç³»åˆ—ç”¢å“ä¾†é€²è¡Œéƒ¨ç½²ã€‚Enterprise PKSä¹Ÿæ˜¯é€éé€™ç¨®æ–¹å¼å®‰è£ã€‚Pivotalçš„ç”¢å“æ˜¯ç”¨Tileç‚ºå–®ä½(.pivotalæª”)ï¼Œåªéœ€è¦å…ˆå°‡Tileä¸Šå‚³åˆ°Ops Managerï¼Œå†æ‰‹å‹•è¨­å®šä¸€äº›åƒæ•¸(IP,å¯†ç¢¼ç­‰ç­‰)ï¼Œå°±å¯ä»¥ç›´æ¥æŒ‰ä¸‹è®Šæ›´éˆ•éƒ¨ç½²ï¼Œéå¸¸æ–¹ä¾¿ã€‚å¦‚æœè¦åˆªæ‰ç”¢å“ä¹Ÿåªè¦å…ˆæŒ‰Tileæ—é‚Šçš„åƒåœ¾æ¡¶ï¼Œå†æ¡ˆè®Šæ›´éˆ•å³å¯ã€‚å¦‚ä¸‹åœ–æ‰€ç¤ºï¼ŒPCF Ops Managerä¸Šé¢æœ‰ä¸‰å€‹Tileï¼Œåˆ†åˆ¥æ˜¯BOSH Tile,PKS Tileä»¥åŠHarbor Tileã€‚PCF Ops Manageråªæ˜¯ä¸€å€‹Tileç®¡æ§ä»‹é¢ï¼Œå®ƒä¸€å®šè¦çµåˆBOSH(ä¸‹ä¸€é»æœƒæåˆ°)æ‰èƒ½éƒ¨ç½²ï¼Œæ‰€ä»¥å¯¦éš›ä¸Šç•¶ä½¿ç”¨è€…æŒ‰ä¸‹è®Šæ›´éˆ•ä¹‹å¾Œæ‡‰è©²æ˜¯Ops Manageræœƒå‘¼å«BOSH Directorå»æ ¹æ“šè¨­å®šçš„åƒæ•¸éƒ¨ç½²é€™äº›Tileã€‚  Pivotalå®˜ç¶²æœ‰é‡‹å‡ºè¨±å¤šå®ƒå€‘åŒ…å¥½çš„Tileï¼Œä¸éå¤§éƒ¨åˆ†éƒ½æ˜¯ä»–å€‘è‡ªå®¶çš„ç”¢å“ï¼Œæ˜¯è¦ä»˜è²»çš„ã€‚å¦‚æœæƒ³è¦è‡ªå·±åšTileï¼Œå¯ä»¥åƒç…§é€£çµå°‡è‡ªå·±çš„æœå‹™æ‰“åŒ…æˆTileä¾†å®‰è£ã€‚2. BOSH DirectorBOSHæ˜¯æ•´å€‹Enterprise PKSçš„æ ¸å¿ƒï¼ŒBOSHæ˜¯ç”±Cloud Foundryé–‹ç™¼çš„Open Sourceå°ˆæ¡ˆï¼Œç”¨ä¾†éƒ¨ç½²ã€ç›£æ§ã€ä¿®å¾©VMã€‚è€ŒCloud Foundryæœ¬èº«å¹³å°ä¹Ÿæ˜¯æ¡ç”¨BOSHä¾†å»ºç½®çš„ã€‚åœ¨PKSç•¶ä¸­ï¼Œæ‰€æœ‰çš„å…ƒä»¶åŒ…å«å¾Œé¢æåˆ°çš„PKS API Serverã€Harboræˆ–K8s Clusteréƒ½æ˜¯ç”±BOSH Directoréƒ¨ç½²çš„ï¼ŒBOSH Directoré‚„æœƒå®šæœŸåœ°å»ç›£æ§æ‰€æœ‰å…ƒä»¶çš„å¥åº·ç‹€æ…‹(æ¯å¹¾ç§’å°±pollingä¸€æ¬¡)ï¼Œåªè¦ç™¼ç”Ÿæœ‰å•é¡Œçš„å…ƒä»¶ï¼Œå°±æœƒå•Ÿå‹•è‡ªå‹•ä¿®å¾©æ©Ÿåˆ¶ï¼Œéå¸¸æ–¹ä¾¿ã€‚3. PKS API ServerPKS API Serverè² è²¬å»ºç½®Kubernetes Clusterï¼Œä¸éé€™æ˜¯æ¯”è¼ƒæ”çµ±çš„èªªæ³•ï¼Œå…¶å¯¦æ˜¯PKS API Serveræ”¶åˆ°Requestä¹‹å¾Œï¼Œæœƒé€šçŸ¥BOSH Directoréƒ¨ç½²K8s Clusterçš„Node(VM)ï¼Œç­‰åˆ°Node(VM)éƒ½å»ºå¥½å¾Œï¼ŒPKS API Serverå°±æœƒé–‹å§‹é‡å°é€™äº›VMå»åšè¨­å®šåŠå®‰è£ä¸€äº›PKSåŠKubernetesçš„å¿…è¦å…ƒä»¶ï¼Œå¦‚kube-proxy, kubelet, docker daemonç­‰ç­‰ã€‚4. Kubernetes Clusteråˆ†æˆmasterä»¥åŠworkerï¼Œç›®å‰PKSä½ˆå‡ºä¾†çš„Kubernetes clusteréƒ½æ˜¯ä½ˆåœ¨VMä¸Šé¢(ç•¢ç«Ÿä¸€é–‹å§‹æœ¬ä¾†å°±æ˜¯ç‚ºvSphereæ‰“é€ çš„)ã€‚PKSå¯ä»¥ä¸€æ¬¡éƒ¨ç½²å¤šå€‹Clusterï¼Œå› æ­¤ä¼æ¥­å¯ä»¥æ ¹æ“šä¸åŒéƒ¨é–€ï¼Œçµ¦ä¸åŒçš„Kubernetes Clusterä¸¦ä¸”æŒ‡æ´¾ä¸åŒçš„æ¬Šé™ï¼Œä¸”å½¼æ­¤æ˜¯ç¨ç«‹é–‹ä¾†çš„ã€‚æ‰€æœ‰é€éBOSH Directorè·ŸPKS API Serveréƒ¨ç½²å‡ºä¾†çš„VMï¼Œä¸Šé¢éƒ½æœƒé å…ˆè£å¥½BOSH Agentä»¥åŠPKS Service(Agent)ï¼ŒBOSHå°±æ˜¯é€éé€™äº›Agentä¾†è¨­å®šVMä»¥åŠç›£æ§VMå¥åº·ç‹€æ…‹ã€‚å¦å¤–ç›®å‰Enterprise PKSåªæ”¯æ´Docker  Containerï¼Œä¸ç¢ºå®šä¹‹å¾Œæœƒä¸æœƒæ•´åˆå…¶ä»–çš„Container Runtimeã€‚5. HarborHarboræ˜¯VMwareé‡‹å‡ºçš„ä¸€å€‹é–‹æºDocker Container Registryï¼Œä¹Ÿæ˜¯å±¬æ–¼CNCFè£¡çš„ä¸€å€‹å°ˆæ¡ˆã€‚Harborå…¶å¯¦ä¸¦ä¸å±¬æ–¼æ–¼PKSç”¢å“ç·šçš„ä¸€å“¡ï¼Œåªæ˜¯é€šå¸¸Pivotalè·ŸVMwareæœƒå°‡å®ƒèˆ‡PKSæ­é…åœ¨ä¸€èµ·ã€‚å¾ä¸Šé¢çš„æ¶æ§‹åœ–å¯ä»¥çœ‹åˆ°å…©å€‹ä½æ–¼ä¸åŒåœ°æ–¹çš„Harborï¼Œæ„æ€æ˜¯Harboræœ‰å…©ç¨®å®‰è£æ–¹å¼ï¼šä¸€ç¨®æ˜¯é€éPCF Ops Managerå®‰è£ï¼Œä½¿ç”¨Pivotalæº–å‚™çš„Harbor Tileå»åšéƒ¨ç½²ï¼Œé€™æ¨£ä½ˆå‡ºä¾†çš„Harboræœƒåœ¨BOSHçš„ç®¡æ§ä¿è­·ä¹‹ä¸‹ã€‚å¦‚æœä¸æƒ³é€éHarbor Tileå®‰è£çš„è©±ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å¦ä¸€ç¨®æ–¹å¼è‡ªå·±æ‰‹å‹•è£(ä¸€èˆ¬æ˜¯é€édocker)ï¼Œå®‰è£æ–¹å¼å¯ä»¥åƒè€ƒGithubï¼Œé€™å…©ç¨®æ–¹å¼éƒ½æ˜¯å¯ä»¥çš„ã€‚Harboré™¤äº†èƒ½æä¾›ä¸€èˆ¬Container Registryçš„æœå‹™ä¹‹å¤–ï¼Œé‚„èƒ½å¤ æ•´åˆé–‹æºå°ˆæ¡ˆNotaryä»¥åŠClairã€‚Notaryæ˜¯CNCFçš„å°ˆæ¡ˆï¼Œä¸»è¦æ˜¯æä¾›Content Trustç°½ç« æœå‹™ï¼Œç¢ºä¿Imageå…§å®¹ä¸è¢«ä¸²æ”¹ï¼Œè€ŒClairèƒ½å¤ é‡å°Imageæä¾›éœæ…‹åˆ†æï¼Œæ ¹æ“šå·²çŸ¥çš„CVEåº«ä¾†æ‰¾å‡ºImageæ·ºåœ¨çš„æ¼æ´ã€‚  Harbor Tileé™¤äº†å¤šäº†ä¸€äº›BOSH Agentä»¥å¤–ï¼Œå…¶ä»–éƒ¨åˆ†éƒ½è·Ÿæ‰‹å‹•è£çš„ç‰ˆæœ¬ä¸€æ¨¡ä¸€æ¨£ã€‚6. PKS Clientç›®å‰PKSä»¥åŠBOSHéƒ½å°šæœªæä¾›GUIä»‹é¢ä¾†åšæ“ä½œï¼Œå› æ­¤éƒ½å¿…é ˆé€éCLIä¾†åšæ“ä½œã€‚é€šå¸¸æœƒæ‰¾ä¸€å°ä¸»æ©Ÿå®‰è£æ‰€éœ€è¦çš„CLIï¼Œé€™å°æ©Ÿå™¨æˆ‘å€‘å°±ç¨±ç‚ºPKS Clientï¼ŒPKS Clientä¸¦æ²’æœ‰é™åˆ¶ä¸€å®šè¦ç”šéº¼ä½œæ¥­ç³»çµ±æˆ–æ˜¯å¤šå°‘è³‡æºï¼Œå°±åªè¦èƒ½å®‰è£CLIä»¥åŠå­˜å–åˆ°PKSç’°å¢ƒå°±å¯ä»¥äº†ã€‚7. NSX-TNSX-Tæ˜¯VMwareæ——ä¸‹Networking Virtualizationç”¢å“ï¼Œèˆ‡NSX-Vä¸åŒï¼ŒNSX-Tæ˜¯å®Œå…¨ç¨ç«‹çš„åŸä»¶ï¼Œå®ƒä¸¦æ²’æœ‰é™åˆ¶ä¸€å®šè¦æ•´åˆvSphereæˆ–æ˜¯å»ºç½®åœ¨vSphereç’°å¢ƒä¸Šã€‚åƒç­†è€…å°±çœ‹éOpenStackæ•´åˆNSX-Tçš„ã€‚å¦å¤–NSX-Tä¹Ÿæ”¯æ´Containerç’°å¢ƒã€‚NSX-Tåœ¨Enterprise PKSç’°å¢ƒä¸­åŒæ¨£ä¸æ˜¯å¿…é ˆçš„ï¼Œä¹Ÿå®Œå…¨èˆ‡Pivotalç„¡é—œä¿‚(å› æ­¤æ²’æœ‰ç”šéº¼NSX-T Tile xD)ï¼Œç•¶ç„¶ä½ å¯ä»¥ä¸æ¡ç”¨NSX-Tï¼Œç›´æ¥ä½¿ç”¨vSphereç’°å¢ƒçš„vSSæˆ–æ˜¯vDSæä¾›çµ¦Enterprise PKSç’°å¢ƒç¶²è·¯ï¼Œä½†æ˜¯ç­†è€…èªç‚ºPKSè¦æ•´åˆNSX-Tæ‰èƒ½å®Œå…¨å¢å¼·PKSçš„åŠŸèƒ½(å¯ä»¥åƒç…§æ¯”è¼ƒè¡¨)ï¼Œå› ç‚ºNSX-Té™¤äº†æä¾›SDNåŠŸèƒ½ä¹‹å¤–ï¼Œé‚„æä¾›äº†éå¸¸å¼·å¤§çš„å¾®åˆ†å‰²ï¼Œå¾®åˆ†å‰²çš„å–®ä½å¯ä»¥ç¸®å°åˆ°podè·Ÿpodä¹‹é–“ï¼Œä¹Ÿå°±æ˜¯ç®¡ç†è€…å¯ä»¥è‡ªå®šç¾©ACLçµ¦ä¸åŒçš„podï¼Œé€²è€Œé”åˆ°å¼·å¤§çš„éš”é›¢æ€§ã€‚é›–ç„¶NSX-Tå¾ˆå¼·å¤§ä¸”ä¹Ÿå¯ä»¥å®Œå…¨æ•´åˆPKSï¼Œä½†æ˜¯ç­†è€…èªç‚ºNSX-Té‚„æ˜¯ä¸€å€‹ä¸å¤ªç©©å®šçš„ç”¢å“ï¼Œå¯èƒ½å‰›å‡ºä¾†ä¸ä¹…é‚„æœ‰è¨±å¤šå•é¡Œè·ŸåŠŸèƒ½å°šæœªå®Œæˆï¼Œæ„Ÿè¦ºé‚„æœ‰ä¸€æ®µè·¯è¦èµ°ã€‚å®‰è£Enterprise PKSç›®å‰å®‰è£æ–¹å¼éƒ½æ˜¯ä½¿ç”¨PCF Ops Managerä¾†åšå®‰è£ï¼Œç”±æ–¼æ­¥é©Ÿç¹å¤šï¼Œå› æ­¤é€™è£¡ä¸å¤šåŠ é—¡è¿°ï¼Œæœ‰èˆˆè¶£å¯ä»¥åƒè€ƒå®˜æ–¹æ–‡ä»¶ - https://docs.pivotal.io/runtimes/pks/1-4/index.htmlPreparation:  vSphere Environment  vCenter Server  NSX-T (Optional)  Ops Manager OVA  PKS Tile  Harbor Tile (Optional)  BOSH/PKS/Ops Manager CLIPKSæ”¯æ´Cluster ç‰ˆæœ¬Release Notes - https://docs.pivotal.io/runtimes/pks/1-4/release-notes.html#1.4.1Enterprise PKSç›®å‰æœ€æ–°ç‰ˆæ˜¯1.4.1ï¼Œæ­¤ç‰ˆæ‰€å°æ‡‰çš„Kubernetesç‰ˆæœ¬æ˜¯v1.13.5ï¼Œç›®å‰å°šç„¡æ³•é¸æ“‡è¦éƒ¨ç½²çš„Kubernetesç‰ˆæœ¬ï¼Œå› ç‚ºBOSHéƒ¨ç½²æ–¹å¼æ˜¯ä½¿ç”¨VM Templateï¼Œå®‰è£å¥—ä»¶éƒ½æ˜¯å·²ç¶“åŒ…å¥½çš„äº†ï¼Œå› æ­¤å¦‚æœæƒ³è¦ä½¿ç”¨æ–°ä¸€é»ç‰ˆæœ¬çš„Kubernetesï¼Œåªèƒ½ç­‰åˆ°ä¸‹æ¬¡PKSæ›´æ–°ä¹‹å¾Œäº†ã€‚åƒè€ƒè³‡æ–™  Pivotal.io - https://pivotal.io/  Rancher - https://rancher.com/  OpenShift - https://www.openshift.com/  IBM Cloud Private - https://www.ibm.com/tw-zh/cloud/private  BOSH - https://www.bosh.io/docs/  Harbor - https://github.com/goharbor/harbor  Notary - https://github.com/theupdateframework/notary  Clair - https://github.com/coreos/clair  NSX-T Data Center Installation Guide  VMware Cloud PKS - https://cloud.vmware.com/vmware-cloud-pks  Enterprise PKS document -https://docs.vmware.com/en/VMware-NSX-T-Data-Center/2.4/nsxt_24_install.pdfhttps://docs.pivotal.io/runtimes/pks/1-4/index.html  VMware ç™¼ä½ˆ VMware Essential PKS - https://blogs.vmware.com/vmware-taiwan/2019/03/01/vmware-%E7%99%BC%E4%BD%88-vmware-essential-pks/  æ–‡ç« å…§å®¹çš„è½‰è¼‰ã€é‡è£½ã€ç™¼ä½ˆï¼Œè«‹è¨»æ˜å‡ºè™•: https://pohsienshih.github.io"
  },
  
  {
    "title": "2019 iThomeè³‡å®‰å¤§æœƒç­†è¨˜",
    "url": "/blog/2019-ithome-cyber-sec-notes/",
    "categories": "Security",
    "tags": "conference",
    "date": "2019-05-26 23:17:07 +0000",
    





    "snippet": "é€™ç¯‡ä¸»è¦æ˜¯è£œä¸Šä»Šå¹´3æœˆä»½åƒåŠ iThomeè³‡å®‰å¤§æœƒçš„ä¸€äº›ç­†è¨˜è·Ÿå°å°å¿ƒå¾—ã€‚ä»Šå¹´çš„è³‡å®‰å¤§æœƒèˆ‡å¾€å¹´ä¸€æ¨£éƒ½åœ¨å°åŒ—åœ‹éš›æœƒè­°ä¸­å¿ƒèˆ‰è¾¦ï¼Œä¸éç”±æ–¼æˆ‘ç¬¬ä¸€å¤©æœ‰äº‹æƒ…ï¼Œå› æ­¤ä»Šå¹´åªæœ‰åƒåŠ åˆ°å¾Œé¢å…©å¤©ï¼ŒæŒºå¯æƒœçš„ï¼Œä¸éå¾Œé¢å…©å¤©ä¹Ÿè »å¤šç²¾å½©çš„æ¼”è¬›(é›–ç„¶å¤§éƒ¨åˆ†é‚„æ˜¯æ¨éŠ·ç”¢å“å±…å¤š)ï¼Œä»¥ä¸‹å°±æ˜¯æˆ‘çš„ä¸€äº›å°å°ç­†è¨˜ï¼Œå¦‚æœæƒ³æš¸è§£æ›´ç´°éƒ¨çš„è©±ï¼Œç›®å‰ç°¡å ±å·²ç¶“éƒ½é‡‹å‡ºåœ¨å®˜ç¶²ä¸Šäº†ï¼Œå¯ä»¥å»åƒè€ƒï½è­°ç¨‹: https://cyber.ithome.com.tw/agenda3/20Keynote æ­£é¢è¿æˆ°å…§éƒ¨å¨è„…ï¼Œå…¬å¸è¢«å®³é‚„æ˜¯å“¡å·¥è¢«é§­?!  ã€Œç ”ç™¼éƒ¨é–€æ˜¯ä¼æ¥­å‘½è„ˆï¼Œå»æœ€é›£ç®¡ç†ã€ï¼Œé–å¤ªå¤šæ¬Šé™å¯èƒ½å°è‡´é–‹ç™¼äººå“¡æ²’è¾¦æ³•å®‰è£å¥—ä»¶æˆ–æ˜¯ä¸€äº›æ’°å¯«çš„ä¸€äº›ç¨‹å¼åŠŸèƒ½ç„¡æ³•åŸ·è¡Œï¼Œä½†æ˜¯é–‹ç™¼äººå“¡æœ‰å¯èƒ½æœƒè—‰ç”±ä¸€äº›æ–¹å¼(å¦‚IDE)ï¼Œä½¿ç”¨çœ‹èµ·ä¾†åˆæ³•çš„æ“ä½œä¾†å°‡ä¼æ¥­è³‡æ–™æ”œå‡ºã€‚  ç‚ºäº†é¿å…é€™æ¨£ï¼Œç²¾å“ç§‘æŠ€é–‹ç™¼çš„ç”¢å“èƒ½å¤ è®“ITäººå“¡é‡å°ç‰¹å®šIDEå»æ‰€æ¬Šé™ï¼Œä¾‹å¦‚å¯ä»¥è¨­å®švisual codeæ‰€åŸ·è¡Œçš„CMDæ²’è¾¦æ³•ç”¨ä¾†ä¸Šç¶²æˆ–æ˜¯æ²’è¾¦æ³•åŸ·è¡Œæ•æ„ŸæŒ‡ä»¤(copy &amp;amp; paste)ï¼Œæ­£å¸¸æƒ…æ³ä¸‹çš„CMDæ²’äº‹ï¼Œä½†æ˜¯åªè¦æ˜¯å¾IDEå«å‡ºä¾†çš„CMDå°±é–æ¬Šé™ã€‚å¦å¤–ä¹Ÿå¯æ“‹æ‰IDEä¸Šé¢çš„codeåœ¨åŸ·è¡ŒæŸäº›æ•æ„Ÿçš„å‹•ä½œã€‚  é™¤äº†IDEä»¥å¤–ï¼Œå¦å¤–ä¹Ÿå¯ä»¥é™åˆ¶å¦‚Officeé€™ç¨®è»Ÿé«”ï¼Œæ¬Šé™å¯ä»¥è¨­å®šçš„å¾ˆå½ˆæ€§ï¼Œä¾‹å¦‚å¯ä»¥è¨­å®šåªèƒ½æŠŠæ–‡å­—å¾å¤–éƒ¨è¤‡è£½è²¼ä¸Šåˆ°Wordï¼Œä½†æ˜¯ä¸èƒ½å¾WordæŠŠè³‡æ–™è¤‡è£½å‡ºä¾†ç­‰ã€‚  åŸç†æ¨æ¸¬æ˜¯é€éåœ¨ç«¯é»åŸ·è¡ŒAgentç›´æ¥å»å°Windowsåº•å±¤çš„APIå»åšé˜»æ“‹ï¼Œå› ç‚ºä¸ç®¡ä»€éº¼æ“ä½œéƒ½é‚„æ˜¯è¦é Windows åº•å±¤çš„APIä¾†å®Œæˆï¼Œå› æ­¤ç›´æ¥å»é–åº•å±¤å°±å¯ä»¥é”åˆ°é€™æ¨£çš„ç®¡ç†ã€‚Cyberlab è¶¨å‹¢ç§‘æŠ€ Target ransom  å¯¦æ©Ÿèª²ç¨‹ï¼Œç”±æ–¼ç¦æ­¢å°‡è¬›ç¾©è·Ÿåƒè€ƒè³‡æ–™å¸¶å‡ºï¼Œå› æ­¤åªèƒ½ç°¡å–®æ¦‚è¿°å¯¦æ©Ÿå…§å®¹ã€‚  ç¾åœ¨å‹’é–è»Ÿé«”å·²ç¶“ä¸ä¸€å®šè¦ä½¿ç”¨ä¸€äº›éæ³•çš„ç¨‹å¼ï¼Œè¨±å¤šé§­å®¢å·²ç¶“é–‹å§‹ä½¿ç”¨ã€Œæ­£ç•¶åˆæ³•è»Ÿé«”ã€ä¾†ä½œåŠ å¯†çš„å‹•ä½œ(å¦‚winrar)ï¼Œé€™æ¨£å¯ä»¥é¿å…é˜²æ¯’çš„åµæ¸¬ã€‚  ä¸€èˆ¬ä¼æ¥­ä¸­å‹’é–ç—…æ¯’éƒ½ä»¥ç‚ºåªè¦æŠŠä¸­çš„é‚£å°é‚„åŸæˆ–æ˜¯æŠŠè³‡æ–™å¾å‚™ä»½å€’å›ä¾†å°±å¥½ï¼Œä½†æ˜¯é€™æ¨£æ²»æ¨™ä¸æ²»æœ¬ï¼Œå› ç‚ºé§­å®¢é‚„æ˜¯å­˜åœ¨å…¬å¸è£¡ï¼Œä¹Ÿè¨±ä»–æ˜¯é€éå…§ç¶²è£¡æŸå°è·³æ¿æ©Ÿä¾†æ”»æ“Šç›®æ¨™ï¼Œä½†å¾€å¾€ITäººå“¡éƒ½åªæœƒæŠŠç„¦é»æ”¾åœ¨è¢«æ”»æ“Šçš„ç›®æ¨™ä¸Šï¼Œä»¥ç‚ºæ˜¯é‚£å°è¢«é§­ã€‚è¦å¦‚ä½•è¿½æŸ¥APTæ”»æ“Šæ€éº¼é€ æˆçš„å°æ–¼ITäººå“¡ä¾†èªªæ˜¯éå¸¸çš„å›°é›£ï¼Œé€éè¶¨å‹¢ç§‘æŠ€çš„APEXç”¢å“ï¼Œå°±å¯ä»¥å¹«åŠ©ITäººå“¡æ–¹ä¾¿çš„æŸ¥æ‰¾å•é¡Œã€‚  å¯¦æ©Ÿæ“ä½œå°±æ˜¯è©¦è‘—æ‰®æ¼”é§­å®¢é€éè·³æ¿æ©Ÿå»æ‰“ä¸‹AD Serverï¼Œç„¶å¾Œå†è©¦è‘—æ‰®æ¼”ç¶²ç®¡äººå“¡å»è¿½æŸ¥æ”»æ“Šæµç¨‹ã€‚å­¸å“¡æ‰®æ¼”è§’è‰²ï¼šé§­å®¢:Step 1: é¦–å…ˆé€£åˆ°ä¼æ¥­çš„ä¸€å€‹ç¶²ç«™Step 2: é€éè¯çµ¡æˆ‘å€‘ä¸Šå‚³ç…§ç‰‡åŠŸèƒ½ï¼Œä¸Šå‚³Webshellåˆ°ç¶²ç«™ã€‚Step 3: ç›´æ¥åœ¨ç¶²ç«™ä¸ŠåŸ·è¡ŒWebshellï¼Œæ–°å¢ä¸€å€‹ä½¿ç”¨è€…ä¸¦ææ¬Šç‚ºç®¡ç†è€…ï¼Œç„¶å¾Œäº†è§£ä¸€ä¸‹Web Serverç›¸é—œè³‡è¨Š(hostnameã€Web server versionâ€¦)Step 4: ç™¼ç¾Web Serveræ˜¯Windows Server IISã€‚Step 5: å˜—è©¦èƒ½ä¸èƒ½é ç«¯æ¡Œé¢ï¼Œä¸èƒ½ï¼Œå¯èƒ½æ˜¯é˜²ç«ç‰†æ“‹ä½æˆ–æ˜¯æ²’é–‹RDPåŠŸèƒ½ã€‚Step 6: é€éWeb shellé—œé–‰é˜²ç«ç‰†åŠŸèƒ½ä»¥åŠé–‹å•ŸRDPStep 7: åœ¨æ¸¬è©¦ä¸€æ¬¡é ç«¯æ¡Œé¢ï¼ŒæˆåŠŸé€²åˆ°Web Serverã€‚Step 8: æ¥è‘—è¦ä½¿ç”¨procdumpè·Ÿé§­å®¢å·¥å…·minikatzä¾†å–å¾—Web Serverä¸Šè·‘çš„æœå‹™çš„ä½¿ç”¨è€…å¸³å¯†ã€‚Step 9: ç”±æ–¼minikatzæœƒè¢«å¤§éƒ¨åˆ†é˜²æ¯’çµ¦æ“‹æ‰ï¼Œå› æ­¤ä¸èƒ½ç›´æ¥å°±æŠŠminikatzä¸Šå‚³åˆ°Web Serverï¼Œå› æ­¤é€™è£¡åªä¸Šå‚³procdumpã€‚Step 10: procdumpæ˜¯åˆæ³•çš„è»Ÿé«”ï¼Œå°±æ˜¯æŠŠprocess dumpå‡ºä¾†ï¼Œå› æ­¤åœ¨Web Serverä¸ŠåŸ·è¡Œæ²’å•é¡Œï¼Œæˆ‘å€‘ç›´æ¥å°‡procesè³‡è¨Šdumpåƒä¾†ï¼Œç„¶å¾ŒæŠŠOutputå‚³åˆ°é§­å®¢çš„é›»è…¦ã€‚Step 11: åœ¨é§­å®¢é›»è…¦åŸ·è¡Œminikatzåˆ†æprocess dumpçµæœï¼ŒæˆåŠŸç™¼ç¾kerberoså¸³è™Ÿå¯†ç¢¼ä»¥åŠæœå‹™IP(AD Server)ã€‚Step 12: æ¸¬è©¦çœ‹çœ‹èƒ½ä¸èƒ½ç›´æ¥é€éç¶²è·¯èŠ³é„°è¼¸å…¥IPä½ç½®è·Ÿå¸³è™Ÿå¯†ç¢¼é€£åˆ°AD Serverçš„admin$ç›®éŒ„ï¼Œç™¼ç¾å¯ä»¥æˆåŠŸåˆ°admin$ç›®éŒ„ã€‚Step 12: å°‡é å¯«å¥½çš„å‹’é–è»Ÿé«”ä¸Šå‚³åˆ°Web Serverï¼Œç”±æ–¼æ˜¯é€éwinrarå»åŠ å¯†ç¨‹å¼ï¼Œå› æ­¤ä¸æ€•é˜²æ¯’åµæ¸¬ã€‚Step 13: åœ¨Web ServeråŸ·è¡Œå‹’é–è»Ÿé«”ï¼ŒåŠ å¯†AD Server admin$è³‡æ–™å¤¾ã€‚Step 14: åŠ å¯†å®Œæˆï¼ŒAD Serveræœå‹™å·²åœæ­¢ã€‚å­¸å“¡æ‰®æ¼”è§’è‰²ï¼šITäººå“¡:Step 1: ç™¼ç¾AD Serverè¢«åŠ å¯†ï¼Œè¦é–‹å§‹æŸ¥æ‰¾å•é¡Œæ˜¯æ€éº¼ç™¼ç”Ÿçš„ã€‚Step 2: é€£å…¥è¶¨å‹¢ç§‘æŠ€çš„ç”¢å“Apex Web GUIä¾†æŸ¥æ‰¾å•é¡Œã€‚Step 3: é¦–å…ˆå…ˆéš¨ä¾¿åœ¨AD Serveræ‰¾ä¸€å€‹è¢«åŠ å¯†çš„æª”æ¡ˆåç¨±ï¼Œç„¶å¾Œé€éæª”æ¡ˆåç¨±å»æœå°‹ã€‚Step 4: APEXæ‰¾å‡ºé€™å€‹æª”æ¡ˆå­˜åœ¨æ–¼å“ªä¸€å°ä¸»æ©Ÿ(AD Server)ï¼Œä»¥åŠä»–çš„LOGï¼Œé€éLOGå¯ä»¥çœ‹åˆ°ä»–æ˜¯è¢«ä»€éº¼WindowsæŒ‡ä»¤åŠ å¯†çš„(rar.exe -df   -p)é‚„æœ‰æ˜¯å“ªå€‹ä½¿ç”¨è€…å¸³è™ŸåŸ·è¡Œçš„ã€å¾å“ªå€‹æª”æ¡ˆåŸ·è¡Œçš„ä»¥åŠåŸ·è¡Œæ™‚é–“ï¼Œçœ‹åˆ°åŠ å¯†çš„å¯†ç¢¼ï¼Œç¶²ç®¡äººå“¡å¯ä»¥æ¾ä¸€å£æ°£ï¼Œè¡¨ç¤ºè‡³å°‘å¯ä»¥é‚„åŸæª”æ¡ˆäº†ã€‚Step 5: APEXä¸Šå¯ä»¥ä½¿ç”¨LOGç”¢å‡ºRoot Cause Analysis(RCA)åœ–ï¼Œé¡ä¼¼é—œè¯åœ–ã€‚é—œè¯åœ–ä¸Šé¢é¡¯ç¤ºè·Ÿé‚£æ®µæŒ‡ä»¤æœ‰ç›¸é—œçš„æª”æ¡ˆ:PsExec.exe -&amp;gt; encrypt.exe -&amp;gt; cmd.exe -&amp;gt; rar.exe -&amp;gt; &amp;lt;è¢«åŠ å¯†çš„æª”æ¡ˆ&amp;gt;å¾é—œè¯åœ–å¯ä»¥çœ‹å‡ºï¼Œæœ‰äººé€éPsExecç¨‹å¼ä¾†å¾åˆ¥å°ä¸»æ©Ÿé ç«¯åœ¨AD Serverä¸ŠåŸ·è¡Œencrypt.exeä½œåŠ å¯†çš„å‹•ä½œã€‚Step 6: æ¥ä¸‹ä¾†è¦æ‰¾å“ªä¸€å°ä¸»æ©Ÿçš„logæœ‰encrypt.exeé€™å€‹æª”æ¡ˆçš„ç´€éŒ„ã€‚ä¸€æ¨£åˆ°APEX GUIé€éæª”åæœå°‹Step 7: çªç„¶æœåˆ°é™¤äº†AD Serverä»¥å¤–ï¼Œé‚„æœ‰ä¸€å°WEB Serverä¸€æ¨£æœ‰åŸ·è¡Œé€™å€‹æª”æ¡ˆçš„ç´€éŒ„(é€™å€‹æ˜¯åŸ·è¡Œç´€éŒ„ï¼Œå°±ç®—æª”æ¡ˆåˆªæ‰ä¹Ÿæ²’ç”¨ï¼Œåˆªæ‰çš„æŒ‡ä»¤ä¹Ÿä¸€æ¨£å®Œå…¨éƒ½æœƒè¢«è¨˜éŒ„é€²ä¾†)ï¼Œå¦å¤–é‚„ç™¼ç¾æ˜¯WEB Serverå¥‡æ€ªçš„å¸³è™Ÿ(å‰›å‰›é§­å®¢ç”¨webshellæ–°å¢çš„ä½¿ç”¨è€…ï¼Œä¸€æ¨£é§­å®¢åˆªæ‰ä½¿ç”¨è€…ä¹Ÿæ²’æœ‰ç”¨ï¼Œå› ç‚ºä¸€èˆ‰ä¸€å‹•éƒ½è¢«è¨˜éŒ„ä¸‹ä¾†)åŸ·è¡Œencrypt.exeçš„ã€‚Step 8: ç”¢å‡ºRCAåœ–ï¼Œå¯ä»¥çœ‹åˆ°encrypt.exeçš„åŸæª”åExplorer.exe -&amp;gt; randsom.exe(åŸæª”å) -&amp;gt; PsExec.exe -&amp;gt; encrypt.exe -&amp;gt; cmd.exe -&amp;gt; ...å¯ä»¥çœ‹åˆ°Explorer.exeåŸ·è¡Œrandsom.exeï¼Œå› æ­¤å¯ä»¥æ¨æ–·WEB Serverå°±æ˜¯æºé ­ä¹Ÿå°±æ˜¯è·³æ¿æ©Ÿã€‚Step 9: å›åˆ°APEX WEB GUIï¼Œä»¥ä¸»æ©Ÿç‚ºå–®ä½ï¼Œç›´æ¥å»å«å‡ºWEB Serverä¸Šåœ¨é€™æ®µæœŸé–“åŸ·è¡Œæ‰€æœ‰çš„å‹•ä½œï¼Œå› æ­¤é§­å®¢æ‰€åšçš„æ¯ä¸€æ­¥éƒ½ç›´æ¥é¡¯ç¤ºåœ¨é é¢ä¸Š(ç”¨webshellåŸ·è¡Œçš„æ‰€æœ‰å‹•ä½œ)ã€‚Step 10: çµæŸã€‚å¿ƒå¾—:APEXèˆ‡å‰é¢keynoteçš„åŸç†ä¸€æ¨£ï¼Œä¸€æ¨£è¦åœ¨ä¼æ¥­çš„æ‰€æœ‰æ©Ÿå™¨è£Agentï¼Œé€™å€‹Agentå°±æ˜¯è¶¨å‹¢ç§‘æŠ€çš„é˜²æ¯’è»Ÿé«”ï¼Œåªæ˜¯å¦‚æœè¦æ¡ç”¨agentæ”¶é›†åŠŸèƒ½ï¼Œè¦åŠ æˆæ¬Šå°±å¯ä»¥ï¼Œé€™å€‹Agentä¸€æ¨£æœƒå»hook windowsåº•å±¤çš„APIï¼Œæ‰€ä»¥æ¯ä¸€æ­¥é©Ÿéƒ½å®Œå…¨è¢«è¨˜éŒ„ä¸‹ä¾†ï¼Œé§­å®¢è¦é—œæ‰Agentæ˜¯éå¸¸å›°é›£çš„ï¼ŒAgentæœƒç”¨å¯†ç¢¼åŠ å¯†ï¼Œä¸”å¯èƒ½æœƒè¢«è¨­å®šç‚ºå”¯ç¨ï¼Œå› æ­¤å¯èƒ½ä¸æœƒå—å‹’é–è»Ÿé«”å½±éŸ¿ã€‚é€™å€‹agentæœƒå®Œå…¨æ²’æœ‰éš±ç§ï¼Œä½†PCæ‰€æœ‰çš„ä¸€èˆ‰ä¸€å‹•éƒ½æœƒè¨˜éŒ„ä¸‹ä¾†ï¼Œæ‰€ä»¥ä»¥å‰å¸¸è½åˆ°çš„é§­å®¢å…¥ä¾µå¾Œè¦æ¸…é™¤è¶³è·¡ï¼Œåœ¨é€™ç¨®æƒ…æ³ä¸‹å¹¾ä¹æ˜¯å®Œå…¨ä¸ç®¡ç”¨çš„ï¼Œå› ç‚ºå°±é€£ã€æ¸…é™¤ã€é€™å€‹å‹•ä½œä¹Ÿæœƒè¢«è¨˜éŒ„èµ·ä¾†ã€‚Android æƒ¡æ„ç¨‹å¼å‹•æ…‹è§£æ®¼ç ”ç©¶  ä¸€èˆ¬ä¾†èªªAndroidé–‹ç™¼è€…æœƒå°ç¨‹å¼ç¢¼é€²è¡ŒåŠ æ®¼ï¼Œä¾†é˜²æ­¢åç·¨è­¯ã€‚  åŠ æ®¼æ–¹æ³•ï¼š          æ··æ·†Code(ç¼ºé»æ˜¯æ¨™æº–APIä¸èƒ½æ··æ·†)      Dexæ–‡ä»¶åŠ å¯†      Headerä¿®æ”¹      Dex dataåŠ å¯†      Methodå‹•æ…‹åŠ è§£å¯†      VMP (Virtual Protect)        æœ‰äº›é–‹ç™¼è€…æœƒå…ˆæŠŠcodeåŠ å¯†ï¼Œç„¶å¾Œæ•…æ„æŠŠä¸é‡è¦çš„æª”æ¡ˆåšæ··æ·†ï¼Œè®“åç·¨è­¯çš„äººä»¥ç‚ºæ··æ·†çš„æª”æ¡ˆå°±æ˜¯codeï¼Œç„¶å¾ŒèŠ±å¿ƒåŠ›åœ¨è™•ç†æ··æ·†ï¼Œæ®Šä¸çŸ¥çœŸæ­£çš„codeè¢«åŠ å¯†æ”¾åœ¨åˆ¥çš„åœ°æ–¹ã€‚è³‡è¨Šå®‰å…¨ä¸­çš„äººå·¥æ™ºèƒ½å°æŠ—  è¿‘å¹´ä¾†å¤§å®¶å¾ˆæµè¡Œä½¿ç”¨Machine Learningä¾†training modelå»å°è³‡å®‰æ”»æ“Šåšåµæ¸¬ï¼Œä½†æ˜¯ä¹Ÿè¡ä¼¸äº†ä¸€ç¨®é‡å°Machine Learning Modelé€²è¡Œæ”»æ“Šçš„ã€ŒAdversarial Machine Learningã€(AML)ã€‚  AMLæ˜¯å»æ¬ºé¨™Modelï¼Œä½¿ç”¨æ··æ·†æˆ–æ˜¯æ±¡æŸ“çš„æ–¹å¼ä¾†æ”»æ“Šå¼„å£Modelã€‚ä¾‹å¦‚ï¼šModelå¯ä»¥åˆ†å‡ºç‹—è·Ÿè²“ï¼Œä½†å‡å¦‚èªªé§­å®¢åšä¸€å€‹åƒè²“åˆåƒç‹—çš„ç…§ç‰‡(è‡ªç„¶ç•Œä¸å­˜åœ¨ï¼Œä¹Ÿå°±æ˜¯éæ­£å¸¸çš„Data)ï¼Œç„¶å¾Œé¤µçµ¦Modelï¼ŒModelå¯èƒ½å°±æœƒé€ æˆèª¤åˆ¤ã€‚å¦å¤–ä¸€ç¨®æ–¹å¼æ˜¯åœ–ç‰‡æ˜¯ç‹—ï¼Œä½†æ˜¯æŸä¸€å€‹pixelæ•…æ„æ”¾çƒ¤éºµåŒ…æ©Ÿï¼Œä»¥äººçš„è‚‰çœ¼ä¾†çœ‹çœ‹ä¸å‡ºä¾†ï¼Œä½†æ˜¯Modelåœ¨åˆ¤åˆ¥æ™‚ï¼Œå°±æœƒé€ æˆéŒ¯èª¤ï¼Œå¯èƒ½æœƒèª¤åˆ¤ã€‚  é™¤åœ–åƒçš„ä»¥å¤–ï¼Œåƒåœ¾éƒµä»¶çš„åµæ¸¬ä¹Ÿå¯ä»¥ä½¿ç”¨AMLï¼Œä¾‹å¦‚åœ¨åƒåœ¾éƒµä»¶è£¡é¢æ•…æ„å¡ä¸€æ®µæ­£å¸¸æ–‡å­—ï¼ŒModelå¯èƒ½å°±æœƒä»¥ç‚ºé€™æ˜¯æ­£å¸¸çš„éƒµä»¶ã€‚æˆ–æ˜¯éƒµä»¶è£¡é¢çš„æŸäº›æ–‡å­—æ•…æ„æ›æˆåŒç¾©è©ï¼Œé€™æ¨£å¯èƒ½ä¹Ÿå¯ä»¥ç¹éåƒåœ¾éƒµä»¶åˆ¤åˆ¥ã€‚  çµ•å¤§éƒ¨åˆ†çš„Modeléƒ½ä¸å¤ªå¯èƒ½ç™¾åˆ†ä¹‹ç™¾ä¸è¢«é¨™æˆ–æ˜¯æ··æ·†ï¼Œå¦‚æœä¸€å€‹Modelå®Œå…¨ä¸æœƒè¢«æ··æ·†ï¼Œé‚£å€‹Modelä¹Ÿæ²’æœ‰AMLçš„åƒ¹å€¼ã€‚  AMLæ”»æ“Šæ‰‹æ³•å¯ä»¥åˆ†æˆå…©ç¨®ï¼š          Evasion Attack: è£½ä½œç‰¹è£½çš„dataä¾†é¨™æˆ–ç¹éModelï¼Œåˆå¯åˆ†æˆé»‘ç®±è·Ÿç™½ç®±ï¼Œé»‘ç®±æ˜¯é§­å®¢ä¸çŸ¥é“Modelé•·æ€æ¨£ï¼Œåªèƒ½ä¸æ–·é€éOutputå»çŒœæ¸¬ï¼Œç™½ç®±æ˜¯æŒ‡é§­å®¢å·²ç¶“äº‹å…ˆäº†è§£Modelè¦å‰‡ã€‚      Poision Attack: å»ç ´å£Modelï¼Œä¾‹å¦‚æœ‰äº›chat botæ¡ç”¨online traingæ©Ÿåˆ¶ï¼Œä¸€é‚ŠèŠå¤©ä¸€é‚Šå­¸ï¼Œä½†åªè¦ä¸€ç›´é¤µçµ¦ä»–ç‰¹å®šçš„dataï¼Œå°±å¯ä»¥è®“Modelå£æ‰ï¼Œå­¸å¥‡æ€ªçš„æ±è¥¿æˆ–æ˜¯èª¤åˆ¤ã€‚        é˜²ç¦¦æ–¹å¼ï¼š          Evasion Attack: é§­å®¢ä¸€å®šè¦æœ‰æ–¹æ³•å»è©¦Model Outputï¼Œå› æ­¤åªè¦åµæ¸¬æ˜¯å¦æœ‰äººåœ¨çŸ­æ™‚é–“å…§å¤§é‡æ¸¬è©¦æˆ–æ˜¯äººå·¥ç°¡å–®çœ‹ä¸€ä¸‹æ˜¯å¦æœ‰ä¸å°‹å¸¸éè‡ªç„¶å¾—dataï¼Œå¦‚æœæœ‰å°±BANæ‰ã€‚      Model retrainï¼šä¸€ä½†ç™¼ç¾Modelåˆ†æè³‡æ–™ä¸æº–ï¼Œå°±é¦¬ä¸Šä¿®æ­£Modelä¸¦é‡æ–°trainingã€‚retrainåˆå¯åˆ†æˆä¸»å‹•å¼è·Ÿè¢«å‹•å¼ï¼Œä¸»å‹•å¼æ˜¯ä¼æ¥­å…§éƒ¨red/blue teamä¸»å‹•å»æ”»æ“ŠModelï¼Œç„¶å¾Œä¿®æ­£Modelã€‚è¢«å‹•æ˜¯ç­‰è¢«æ”»æ“Šäº†ï¼Œæ‰Retrainã€‚      é§­å®¢å¦‚ä½•åˆ©ç”¨å…¬é–‹å·¥å…·åœ¨å…§éƒ¨ç¶²è·¯ä¸­æš¢è¡Œç„¡é˜»iThomeå ±å° - https://www.ithome.com.tw/news/129486?fbclid=IwAR2rBpZx6r-fWXgmsTupgUrzkWsOiCunvCleq5oyfONtz6zyd3aQ1Zr1Abg  ç´…éšŠæ¼”ç·´ vs æ»²é€æ¸¬è©¦          ç´…éšŠæ¼”ç·´ï¼šé§­å®¢æ€ç¶­å‡ºç™¼ã€å…¨é¢ä¸”å»£æ³›ã€ç›®çš„æ˜¯ç«Šå–ä¼æ¥­è³‡æ–™      æ»²é€æ¸¬è©¦ï¼šåœ¨ç‰¹å®šç¯„åœã€é‡å°ç‰¹å®šç›®æ¨™ã€ç›®çš„æ˜¯æŒ–æ˜ç³»çµ±æ¼æ´        æ”»æ“ŠéŠ:    ç›®æ¨™åµæŸ¥ -&amp;gt; æ­¦å™¨ç ”è£½ -&amp;gt; ç™¼å‹•æ”»æ“Š -&amp;gt; ç¶­æŒæ§åˆ¶ -&amp;gt; å…§ç¶²æ»²é€ -&amp;gt; å·å–è³‡æ–™        ç›®æ¨™åµæŸ¥: Recon-Ngå·¥å…·  æ­¦å™¨ç ”è£½: Metasploit(ç”¢ç”Ÿæƒ¡æ„å·¨é›†æ–‡ä»¶)  ç¶­æŒæ§åˆ¶ï¼šå®‰è£å¾Œé–€  å…§ç¶²æ»²é€ï¼š BloodHound(èƒ½å¤ å°‡AD Serverç¶²åŸŸå…§çš„å…ƒä»¶ä»¥åœ–æ€§åŒ–é¡¯ç¤ºä¸¦ä¸”æä¾›æ”»æ“Šè·¯å¾‘)ã€Responder(é‡å°LLMNRæˆ–NBT-NS,MDNSè¬é€²è¡Œpoisoning attack)  å·å–è³‡æ–™ï¼šdnscat2(DNS Tunnel)ã€icmpsh(ICMP Tunnel)ã€‚  é˜²ç¦¦æ–¹å°ç­–          ç ”ç©¶å…¬é–‹å·¥å…·ï¼Œå°‡å…¶ç‰¹å¾µåŠ å…¥è³‡å®‰ç”¢å“      ç¦æ­¢ä¸å®‰å…¨çš„å·¨é›†æˆ–æ˜¯ä¸å¸¸è¦‹çš„è…³æœ¬é‹è¡Œ(hta,vbsâ€¦)ã€‚      ä½¿ç”¨å…¬é–‹å·¥å…·æƒç¶²è·¯ç’°å¢ƒé–‹å•Ÿæœå‹™ä¸¦é—œé–‰æœªä½¿ç”¨çš„åŠŸèƒ½ã€‚      æª¢è¦–ä¸å®‰å…¨çš„ACLé…ç½®      æª¢è¦–DNSä¼ºæœå™¨çš„è§£ææ–¹å¼      3/21KEYNOTEã€Live Demoã€‘å·¥æ¥­æ§åˆ¶ Testbed èˆ‡è³‡å®‰æ”»é˜²ç ”ç©¶  è¿‘å¹¾å¹´å·¥æ¥­è£½é€ çš„è³‡å®‰å•é¡Œä¹Ÿæ…¢æ…¢é–‹å§‹è¢«é‡è¦–ã€‚  è¬›è€…ç¾å ´Demoä¸€å€‹æ¨¡æ“¬ç«è»Šç’°å¢ƒï¼Œé§­å®¢å…¥ä¾µéµé“ç®¡ç†ç³»çµ±ï¼Œç„¶å¾Œå°‡ç«è»Šå¼•å°åˆ°æ–·è»Œçš„åœ°æ–¹ã€‚  æ”»æ“Šæ‰‹æ³•ç‚ºï¼š    æ»²é€è‡³å…§ç¶²-&amp;gt; ä¸­é–“äººæ”»æ“Š -&amp;gt; å°åŒ…å´éŒ„æˆ–è§£æ -&amp;gt; ä¸²æ”¹å°åŒ…æˆ–æ˜¯ç™¼æ”¾å‡å°åŒ…çµ¦æ§åˆ¶ç«¯        å°ç£å·¥æ§è¨­å‚™æœ‰10546å€‹æš´éœ²æ–¼ç¶²éš›ç¶²è·¯(å…·æœ‰çœŸå¯¦èª¿æŸ¥è³‡æ–™)ï¼Œä¸”å¤§éƒ¨åˆ†éƒ½æ˜¯èµ°HTTPå”å®šï¼Œéå¸¸ä¸å®‰å…¨ï¼Œæš´éœ²çš„ç”¢æ¥­æœ‰èƒ½æºæ¥­ã€å¤§å°ˆé™¢æ ¡ã€æ”¿åºœæ©Ÿé—œã€åœè»Šå ´æ¥­è€…ã€é‹¼éµè£½é€ æ¥­ã€é£¯åº—å¤§å¤ç®¡ç†ç­‰ã€‚  å·¥æ¥­æ§åˆ¶ç¶²è·¯é˜²è­·è‡ªæˆ‘å¥åº·æª¢æŸ¥          è³‡ç”¢ç›¤é»ï¼š                  æ˜¯å¦å·²è¾¨è­˜é—œéµåŸºç¤è¨­æ–½ï¼Ÿ          æ˜¯å¦é€²è¡Œé¢¨éšªç®¡ç†èˆ‡è©•ä¼°ï¼Ÿ          ä½¿å¦æª¢è¦–ç¶²æ®µåŠƒåˆ†èˆ‡å·¥æ¥­æ§åˆ¶ç¶²è·¯é‚Šç•Œï¼Ÿ          æ˜¯å¦æª¢è¦–ç¶²è·¯æ¶æ§‹è¨­è¨ˆé‚è¼¯ï¼Ÿ                    ICSç³»çµ±å¸³è™Ÿç®¡ç†ï¼š                  æ˜¯å¦åˆ¶å®šå¸³è™Ÿé–å®šã€ç®¡ç†æ”¿ç­–ï¼Ÿ          æ˜¯å¦æŸ¥æ‰¾ã€åˆªé™¤ä»»ä½•é è¨­çš„ç‰¹æ¬Šå¸³è™ŸåŠå¯†ç¢¼ï¼Ÿ          æ˜¯å¦è¦æ±‚ä½¿ç”¨å¼·å¯†ç¢¼å’Œå¤šå› ç´ èº«ä»½é©—è­‰ï¼Ÿ          æ˜¯å¦é™åˆ¶ç‰¹æ¬Šå¸³è™Ÿæ•¸é‡ï¼Ÿå°¤å…¶ç¬¬ä¸‰æ–¹ä¾›æ‡‰å•†          æ˜¯å¦è¦æ±‚OTå ´åŸŸäººå“¡å®šæœŸæ›´æ›å¯†ç¢¼                    OTç¶²è·¯éš”é›¢æ€§(ioslate)æª¢è¦–                  æ˜¯å¦å¯ä»¥ç›´æ¥ç”±ç¶²éš›ç¶²è·¯å­˜å–ICSï¼Ÿ          æ˜¯å¦å¯ä»¥ç›´æ¥ç”±ITç¶²è·¯å­˜å–ICS?          æ˜¯å¦æœ‰åš´è¬¹ä¹‹å‚˜ç«¯å­˜å–ç®¡ç†æ”¿ç­–ï¼Ÿ          é˜²ç«ç‰†æ˜¯å¦å·²éš”é›¢æ‰€æœ‰éœ€ä¿è­·çš„ICSç¶²è·¯å’Œè¨­å‚™ã€‚                    KEYNOTEå–„ç”¨é§­å®¢æ€ç¶­ï¼šå¦‚ä½•è¯åˆç™½å¸½é§­å®¢å…±åŒåŠ å¼·è³‡å®‰é˜²ç¦¦èƒ½é‡  ç´…éšŠæ¼”ç·´ä¸æ‡‰è©²äº‹å…ˆå‘ŠçŸ¥ï¼Œä¸”ç´…éšŠæœƒä¸€ç›´å­¸ç¿’æ–°çš„æ”»æ“ŠæŠ€è¡“ï¼Œå¢å¼·æ”»æ“Šèƒ½åŠ›ï¼Œé€™æ¨£å¯ä»¥è€ƒé©—è—éšŠçš„æ‡‰å°è™•ç†æ©Ÿåˆ¶ã€‚  ä¼æ¥­ç”¢å“å®‰å…¨ä¿è­·æ–¹å¼(æŒ‰ç…§é †åº)ï¼š          Code &amp;amp; architecture review: é‡å°å·¥ç¨‹å¸«æˆ–æ˜¯å“¡å·¥ä¸Šé¢¨éšªè©•ä¼°ä»¥åŠè³‡è¨Šå®‰å…¨æ¦‚å¿µçš„ç›¸é—œèª²ç¨‹ã€‚å·¥ç¨‹å¸«å…§éƒ¨é‡å°codeå»åšreviewï¼Œçœ‹æœ‰æ²’æœ‰å®‰å…¨é¢¨éšªã€‚      å‹•ï¼†éœæ…‹ç¨‹å¼æ¸¬è©¦      ç´…éšŠæ¼”ç·´ï¼šä¼æ¥­å…§éƒ¨åœ˜éšŠæ‰¾æ¼æ´ã€‚      é–‹å•ŸBug Bountyï¼šè®“å…¨ä¸–ç•Œçš„ç™½å¸½é§­å®¢ä¸€èµ·ä¾†æ‰¾æ¼æ´ã€‚        ç´…éšŠæ¼”ç·´çš„å¥½è™•ï¼š          èƒ½å¤ è®“ä¼æ¥­äº†è§£ç”¢å“çš„å¼±é»åŠæ¼æ´é¢å‘ã€‚      èƒ½å¤ è®“è—éšŠå¢å¼·ä¼æ¥­å®‰å…¨çš„é˜²å®ˆã€‚      å…è¨±ç®¡ç†å±¤è¡¡é‡å®‰å…¨è§£æ±ºæ–¹æ¡ˆçš„æŠ•è³‡ã€‚      èƒ½å¤ å¢åŠ æ”»æ“Šçš„æˆæœ¬ï¼Œè®“é§­å®¢æ”»æ“Šæ›´åŠ å›°é›£ã€‚      è³‡å®‰è„«å£ç§€  ç”²æ–¹ä¸æ‡‰è©²çœ‹å“ªå®¶å» å•†è¨­å‚™æ•¸å­—æˆ–æˆç¸¾æ¼‚äº®å°±é¸æ“‡ä»–ï¼Œæ‡‰è©²æ˜¯æ ¹æ“šè‡ªèº«éœ€è¦ä¾†é¸æ“‡ï¼Œå¯ä»¥æ•´ç†è¿‘å¹¾å¹´å…¬å¸é‡åˆ°çš„è³‡å®‰äº‹ä»¶ï¼Œç„¶å¾Œå†è·Ÿä¹™æ–¹åšè¨è«–ï¼Œé€™æ¨£æ‰èƒ½é¸æ“‡åˆ°å…¬å¸å¯ç”¨çš„è§£æ±ºæ–¹æ¡ˆã€‚çªç ´å›°å¢ƒï¼šè³‡å®‰é–‹æºå·¥å…·ä¹‹æ‡‰ç”¨åˆ†äº«  ç°¡å ± - https://www.slideshare.net/jasoncheng7115/20190321-137504140?fbclid=IwAR26IO1-XOw_0xPIX2jPZB859H2B9XC8Xt35WxO0EZVvx9yEW6ZL7TTYST8            é–‹æºå·¥å…·      è§£æ±ºæ–¹æ¡ˆ                  Proxmox      é–‹æºä¼ºæœå™¨è™›æ“¬åŒ–ç®¡ç†å¹³å°              LibreNMS      é–‹æºè£ç½®èˆ‡æœå‹™ç‹€æ…‹ç›£è¦–              Open-audIT      é–‹æºITè³‡ç”¢ç®¡ç†ç³»çµ±              Graylog      é–‹æºäº‹ä»¶è¨˜éŒ„ç®¡ç†èˆ‡åˆ†æ              FreeNAS      é–‹æºå„²å­˜ä¼ºæœå™¨ç³»çµ±              Duplicati      é–‹æºè³‡æ–™å‚™ä»½ç³»çµ±              PacketFence      é–‹æºç¶²è·¯å­˜å–æ§åˆ¶ç³»çµ±              WSO2 IoT      é–‹æºè¡Œå‹•è£ç½®ç®¡ç†(MDM BYODç®¡ç†)              OpenVAS      é–‹æºå¼±é»æª¢æ¸¬ç®¡ç†å¹³å°              MobSF      é–‹æºAPPå®‰å…¨æ¸¬è©¦å¹³å°              SonarQube      é–‹æºç¨‹å¼ç¢¼æª¢æ¸¬å¹³å°              Proxmox MG      é–‹æºéƒµä»¶é–˜é“ä¼ºæœå™¨        é–‹æºå¥—ä»¶é¸æ“‡è¦é»          ç‰ˆæœ¬æ›´æ–°: å¯ä»¥æŸ¥çœ‹æ›´æ–°æ—¥æœŸ      æ´»èºç¨‹åº¦ï¼šå¯ä»¥çŸ¥é“é€™å€‹å°ˆæ¡ˆåˆ°åº•æœ‰æ²’æœ‰åœ¨ç¶­è­·      å•†æ¥­æ”¯æ´ï¼šæ˜¯å¦æœ‰ä»˜è²»ç‰ˆè·Ÿé–‹æºç‰ˆï¼Œé€šå¸¸æœ‰ä»˜è²»ç‰ˆæ’è…°çš„æ¯”è¼ƒå¥½ã€‚      ç•™æ„æˆæ¬Šå•é¡Œ(GPL,BSD, Apacheâ€¦)        Open Hub - é–‹æºå°ˆæ¡ˆå®‰å…¨æª¢æ¸¬èˆ‡æˆæ¬Šå»ºè­°è§£å¯† HTTPS é›²ç«¯æœå‹™çš„ç¾éº—èˆ‡å“€æ„: å´éŒ„ / å‚™ä»½ / é˜²æ¯’ / ç¨½æ ¸  TLSæä¾›äº†å¯¦è³ªæ€§çš„å¥½è™•ï¼Œä½†æ˜¯å»ä¹Ÿå¢åŠ äº†åˆ†ææµé‡çš„å›°é›£ã€‚  éƒ¨åˆ†åœ‹å®¶æ˜¯ç¦æ­¢å°HTTPSåšè§£å¯†ï¼Œå› ç‚ºæœƒæœ‰éš±ç§æ¬Šå•é¡Œã€‚  é€šå¸¸é‡‘èæ¥­æ˜¯ä¸èƒ½å°HTTPSåšè§£å¯†ï¼Œå› ç‚ºè³‡æ–™éåº¦æ•æ„Ÿã€‚  æœ‰äº›è»Ÿé«”ä¾‹å¦‚Lineæˆ–æ˜¯Messengerï¼Œæ²’è¾¦æ³•åšè§£å¯†ï¼Œå› ç‚ºé€™äº›ç¨‹å¼åªè¦ç™¼ç¾æ†‘è­‰è¢«æ”¹å°±æœƒè¢«æ“‹æ‰ã€‚å¿ƒå¾—: å¤§éƒ¨åˆ†çš„HTTPSè§£å¯†éƒ½æ˜¯é€éproxyä¾†åšåˆ°ï¼Œclientç«¯è£agentä¾†æ›æ‰æ†‘è­‰ï¼Œç„¶å¾Œproxyç«¯åšè§£å¯†çš„å‹•ä½œï¼Œæ¥è‘—å†ç”±proxyå»è·ŸWeb Serverå»åšé€£ç·šï¼Œé€™æ¨£å°±å¯ä»¥å–å¾—HTTPSçš„å…§å®¹ã€‚å» å•†(åªæœ‰éƒ¨åˆ†)éƒµä»¶éæ¿¾åŠéƒµä»¶å®‰å…¨ï¼š  Proofpointéƒµä»¶ä¼ºæœå™¨åŠéƒµä»¶å®‰å…¨  Openfindç‰¹æ¬Šå¸³è™Ÿç›£æ§ç®¡ç†  CyberarkHTTPSæµé‡ç®¡ç†ç›£æ§(è§£å¯†HTTPS)  L7Ntwork  F5é›²ç«¯å®‰å…¨  Tufin  F-Secureé€éDNSä¾†é˜²è­·  Cisco Umbrellaç«¯é»æª”æ¡ˆåŠ å¯†(ç‚ºé‡è¦æª”æ¡ˆåŠ å¯†)  ä¸­è¯é›»ä¿¡SecurBoxDDoSé˜²è­·  å¨ç¿ç§‘æŠ€ GenieATM(é€éè¨­å‚™å°‡æµé‡å°åˆ°F5é‚£äº›å»åšæ¸…æ´—ï¼Œä»–å€‘åªåšå°å‘çš„å‹•ä½œè€Œå·²)  Arbor  AkamaiLogç®¡ç†  ALogæ•´åˆå‹å®‰å…¨é¢¨éšªç®¡ç†å¹³å°  tenable  IBM SecurityBirdmanæ–°å‰µå…¬å¸  CYCARRIERå…¶é¤˜å­¸ç¿’  ä»¥å¾€å°ä»˜DDoSï¼Œå» å•†éƒ½æ˜¯ç›´æ¥æ”¾ä¸€å°è‡ªå®¶è¨­å‚™åœ¨Gatewayï¼Œç•¶æ”»æ“Šç™¼ç”Ÿæ™‚è¨­å‚™å°‡æµé‡å°å‘åˆ°Cloud Scrubbing Centerå»åšæ¸…æ´—ï¼Œä½†æ˜¯é€™æ¨£å­å°Clientç«¯é‚„æ˜¯æœ‰å¾ˆå¤§å¾—è² æ“”ï¼Œå› æ­¤ç™¼ç¾ä»Šå¹´è¨±å¤šè™•ç†DDoSçš„å» å•†ï¼Œåœ¨Redirectçš„éƒ¨åˆ†æ”¹ç”¨äº†BGP forwardingæˆ–æ˜¯DNS Forwardingï¼Œç›´æ¥åœ¨æºé ­å°±å°‡æµé‡å°å‘åˆ°Scrubbing Centerï¼Œé€™æ¨£å°±ä¸æœƒå¢åŠ Clientçš„è² æ“”ã€‚  å¸‚é¢ä¸Šå¤§éƒ¨åˆ†çš„IP Caméƒ½æ˜¯æ›æ¹¯ä¸æ›è—¥ï¼Œå¤–æ®¼æ˜¯è‡ªå·±è¨­è¨ˆï¼Œä½†æ˜¯æ™¶ç‰‡å¯èƒ½å°±æ¡ç”¨å¤§é™¸æ™¶ç‰‡ï¼Œé€™ç¨®èªè­‰é€šå¸¸éƒ½å¾ˆè„†å¼±ï¼Œåªè¦ä½¿ç”¨ä¸€äº›ç¾æœ‰çš„APPå°±å¯ä»¥æƒåˆ°IP camç„¶å¾Œå…èªè­‰ç™»å…¥ï¼Œå› æ­¤åœ¨è²·IP camçš„æ™‚å€™ï¼Œæœ€å¥½é¸æ“‡æœ‰é€šéã€ IP Camera å ´åŸŸå¯¦é©—å®¤ã€èªè­‰çš„IP Camã€‚  é›»å½±è£¡é¨™éç®¡ç†è€…IP CAMç•«é¢ç¾å¯¦æ˜¯åšå¾—åˆ°çš„ï¼Œåªè¦é€éarp spoofingå…ˆå»æ¬ºé¨™IP CAMç®¡ç†å™¨ï¼Œé€™æ¨£ç®¡ç†å™¨å°±æœƒä»¥ç‚ºé§­å®¢çš„é›»è…¦æ‰æ˜¯IP CAMï¼Œç„¶å¾Œé§­å®¢å†é€å‡è¨Šè™Ÿ(ç•«é¢æ­£å¸¸çš„å½±ç‰‡)çµ¦ç®¡ç†å™¨ï¼Œé€™æ¨£ç®¡ç†å™¨é‚£é‚Šå°±æœƒä¸€ç›´çœ‹åˆ°æ˜¯æ­£å¸¸çš„ç•«é¢ã€‚  æ–‡ç« å…§å®¹çš„è½‰è¼‰ã€é‡è£½ã€ç™¼ä½ˆï¼Œè«‹è¨»æ˜å‡ºè™•: https://pohsienshih.github.io"
  },
  
  {
    "title": "SSH Tunnelä»‹ç´¹",
    "url": "/blog/ssh-tunnel-introduction/",
    "categories": "Linux",
    "tags": "ssh",
    "date": "2019-05-23 00:23:25 +0000",
    





    "snippet": "ç”±æ–¼æœ€è¿‘ç¢°åˆ°ä¸€äº›ç‰¹æ®Šç¶²è·¯æƒ…å¢ƒå¿…é ˆä½¿ç”¨åˆ°SSH Tunnelï¼Œå› æ­¤èŠ±é»æ™‚é–“è¤‡ç¿’äº†ä¸€ä¸‹ã€‚SSH Tunnelæ˜¯å€‹éå¸¸å¥½ç”¨çš„æŠ€è¡“ï¼Œå¯ä»¥åœ¨ä¸€äº›æ¯”è¼ƒå®‰å…¨æˆ–å°é–‰çš„ç¶²è·¯å°‡æµé‡é€éSSH Protocolå‚³è¼¸å‡ºå»ã€‚ä½¿ç”¨SSH Tunnelä¸€å®šè¦æº–å‚™ä¸€å€‹èˆ‡Clientç«¯ä¸åŒç¶²è·¯çš„Remote Serverç•¶ä½œè·³æ¿æ©Ÿï¼Œå…¶åŸç†é¡ä¼¼Port Forwardingçš„æ¦‚å¿µï¼Œåœ¨Clientä»¥åŠRemote Serverä¹‹é–“å»ºç«‹ä¸€å€‹SSH Tunnelï¼Œç„¶å¾Œå°‡ç‰¹å®šçš„æœå‹™å…¨éƒ¨é€éé€™å€‹Tunnelä¾†å‚³é€ï¼Œå°±å¯ä»¥é”åˆ°åŠ å¯†åŠç©¿é€çš„æ•ˆæœã€‚SSH Tunnelåˆå¯åˆ†æˆå…©ç¨®:  Local Tunnel (åˆç¨±SSH Local Forwarding)  Remote Tunnel (åˆç¨±SSH Remote Forwarding)é€™å…©ç¨®å·®åˆ¥å…¶å¯¦å°±æ˜¯è¦å¾å“ªä¸€ç«¯å°‡æµé‡é€éSSH Tunnelå‚³é€å‡ºå»ï¼Œä¸€å€‹æ˜¯å¾localç«¯å‚³é€çµ¦Remoteç«¯ï¼Œä¸€å€‹æ˜¯å¾Remoteå‚³å›ä¾†çµ¦localã€‚æ¥ä¸‹ä¾†æœƒé‡å°é€™å…©ç¨®Tunnelåšç´°éƒ¨è§£é‡‹ä»¥åŠé©ç”¨çš„æƒ…å¢ƒã€‚Local TunnelLocal Tunnelä¸»è¦æ˜¯å¾Localç«¯(Clientç«¯)ï¼Œå°‡Clientç«¯ç‰¹å®šæœå‹™çš„æµé‡é€éSSHå‚³çµ¦Remote Serverï¼Œå†é€éRemote Serverå‚³å‡ºå»çµ¦Application Serverã€‚å…¶ä½¿ç”¨çš„æƒ…å¢ƒå¯ä»¥åˆ†æˆå…©ç¨®ï¼šä¸€ç¨®æ˜¯æƒ³è¦é€£åˆ°ç‰¹å®šçš„æœå‹™ï¼Œä½†æ˜¯å»ä¸æƒ³è¢«ç¶²ç®¡ç›£æ¸¬åˆ°æµé‡ï¼Œå°±å¯ä»¥ä½¿ç”¨SSHä¾†å‚³é€æµé‡å‡ºå»ï¼Œé€™æ¨£ç¶²ç®¡åªèƒ½çœ‹åˆ°SSHåŠ å¯†çš„æµé‡ï¼Œæ²’è¾¦æ³•çœ‹åˆ°å…§å®¹ã€‚å¦ä¸€ç¨®æ˜¯å…¬å¸é˜²ç«ç‰†æœ‰é™åˆ¶å“¡å·¥ä¸èƒ½é€£åˆ°ç‰¹å®šæœå‹™æˆ–ç¶²ç«™ï¼Œä¹Ÿå¯ä»¥å°‡æµé‡åŒ…åˆ°SSHè£¡é¢ä¾†ç¹éé˜²ç«ç‰†å‡ºå»(å‰ææ˜¯é˜²ç«ç‰†æ²’æœ‰æª”SSHæœå‹™)ã€‚æŒ‡ä»¤(æ­¤æŒ‡ä»¤éœ€åœ¨Clientç«¯åŸ·è¡Œ)ï¼š$ ssh -NfL &amp;lt;local listening IP&amp;gt;:&amp;lt;local listening port&amp;gt;:&amp;lt;application ip&amp;gt;:&amp;lt;application port&amp;gt; &amp;lt;Remote Server&amp;gt;# Example$ ssh -NfL localhost:1234:&amp;lt;web server ip&amp;gt;:80 user@&amp;lt;remote server ip&amp;gt;  -N ä»£è¡¨ä¸è¦é–‹èµ·shell codeæ¨¡å¼-f ä»£è¡¨åœ¨èƒŒæ™¯åŸ·è¡Œ-L ä»£è¡¨Local Tunnel&amp;lt;local listening IP&amp;gt; è¦åœ¨Clientä¸Šç›£è½çš„IPã€‚&amp;lt;local listening port&amp;gt; è¦åœ¨Clientä¸Šç›£è½çš„Portï¼Œå¯è‡ªè¡Œå®šç¾©ã€‚&amp;lt;application ip&amp;gt; è¦å­˜å–çš„æœå‹™IP&amp;lt;application port&amp;gt; è¦å­˜å–çš„æœå‹™porté€™é‚Šæ„æ€æ˜¯å‡å¦‚Clientä¸Šæœ‰ä»»ä½•Requestè¦å‚³é€åˆ°&amp;lt;local listening IP&amp;gt;:&amp;lt;local listening port&amp;gt;ï¼ŒClientå°±æœƒå°‡ä»–è½‰é€åˆ°SSH Tunnelä¾†å‚³çµ¦Remote Serverï¼ŒRemote Serveræ”¶åˆ°æµé‡å¾Œï¼ŒæœƒæŠŠå°åŒ…è½‰é€åˆ°&amp;lt;application ip&amp;gt;:&amp;lt;application port&amp;gt;ï¼Œå› æ­¤å¾Clientç«¯åˆ°Remote Serverç«¯ä¹‹é–“çš„è·¯æ˜¯é€éSSHå‚³é€çš„(åŠ å¯†é€£ç·š)ã€‚Client &amp;lt;--SSH Tunnel--&amp;gt; Remote Server &amp;lt;--Internet--&amp;gt; Application Server  è«‹æ³¨æ„é€™é‚Šçš„&amp;lt;local listening  port&amp;gt;è·Ÿ&amp;lt;application port&amp;gt;èˆ‡SSHæœå‹™ä½¿ç”¨åˆ°çš„Portå®Œå…¨æ²’æœ‰ä»»ä½•é—œä¿‚ï¼Œé è¨­SSH Serverä½¿ç”¨çš„Porté‚„æ˜¯22ï¼Œç„¶å¾ŒClientç«¯æ˜¯äº‚æ•¸ç”¢ç”Ÿã€‚å¦‚æœRemote Serverçš„SSH Portä¸æ˜¯22çš„è©±ï¼Œé‚£å°±å¿…é ˆåœ¨æŒ‡ä»¤å¾Œé¢åŠ ä¸Š -p &amp;lt;port number&amp;gt;  Example:ssh -NfL localhost:1234:&amp;lt;web server ip&amp;gt;:80 user@&amp;lt;remote server ip&amp;gt; -p 3000  é€™é‚Šéœ€è¦æ³¨æ„çš„æ˜¯&amp;lt;local listening IP&amp;gt;å¯ä»¥æ‰“ä¹Ÿå¯ä»¥ä¸æ‰“ï¼Œé è¨­æ˜¯localhost(127.0.0.1)ï¼Œå¦‚æœè¦ç›£è½åœ¨ä¸åŒçš„IPï¼Œéœ€è¦é‡å°sshd_configåšè¨­å®šï¼Œåœ¨ç¨å¾Œæœƒåšèªªæ˜ã€‚æƒ…å¢ƒ1æƒ³è¦åœ¨å…¬å¸ä½¿ç”¨ptt(ssh bbsu@ptt.cc)ï¼Œä½†æ˜¯ä¸æƒ³è¢«ç¶²ç®¡ç™¼ç¾ã€‚è§’è‰²:  Client: å…¬å¸å€‹äººé›»è…¦orç­†é›»ï¼Œéœ€è¦å¯ä»¥ä½¿ç”¨SSHæŒ‡ä»¤ã€‚  Remote Server: ç•¶ä½œè·³æ¿çš„æ©Ÿå™¨ï¼Œéœ€è¦æœ‰SSH Serveræœå‹™ï¼Œä¸”å¿…é ˆä½æ–¼å…¬å¸ç¶²è·¯ä¹‹å¤–ã€‚Clientå¿…é ˆé€£å¾—åˆ°å®ƒã€‚  ptt.cc: è¦é€£ç·šçš„Application Serverã€‚Step  åœ¨Clientä¸ŠConsoleåŸ·è¡ŒLocal Tunnelã€‚    $ ssh -NfL 1234:ppt.cc:23 &amp;lt;Remote Server&amp;gt;            åœ¨Clientç«¯æª¢æŸ¥æ˜¯å¦æœ‰æˆåŠŸå»ºç«‹èµ·Tunnel    $ netstat -plnt $ ps -ef | grep ssh        æ¥ä¸‹ä¾†å°±å¯ä»¥é€éClienté€£åˆ°ptt    $ ssh bbsu@localhost -p 1234            å¦‚æœè¦é—œæ‰Tunnelï¼Œåªéœ€è¦åœ¨Clientä¸Šé¢åŸ·è¡Œä»¥ä¸‹æŒ‡ä»¤ï¼š    $ ps -ef | grep ssh$ kill &amp;lt;ssh tunnel é‚£æ¢æœå‹™çš„PID&amp;gt;        èªªæ˜åœ¨é€™å€‹æƒ…å¢ƒä¸­ï¼Œç•¶Clientæ”¶åˆ°è¦é€šå¾€localhost:1234çš„Requestæ™‚ï¼Œå°±æœƒå°‡å®ƒä¸Ÿåˆ°SSH Tunnelå‚³é€çµ¦Remote Serverï¼ŒRemote Serveræ”¶åˆ°å¾Œå†æŠŠå®ƒä¸Ÿåˆ°ptt.cc:22ï¼Œç•¶å°åŒ…å›ä¾†ä¹Ÿæ˜¯ä¸€æ¨£ï¼Œåªæ˜¯å°±åéä¾†ï¼ŒRemote Severå°‡Responseé€éSSH Tunnelä¸Ÿå›çµ¦Clientï¼ŒClientå†å°‡å°åŒ…å¾SSH Tunnelä¸Ÿçµ¦1234 portã€‚  æƒ…å¢ƒ2å…¬å¸é˜²ç«ç‰†æ“‹æ‰xxxç¶²ç«™ï¼Œè¦å¦‚ä½•æ‰èƒ½ç¹éé˜²ç«ç‰†é€£åˆ°ç¶²ç«™è§’è‰²:  Client: å…¬å¸å€‹äººé›»è…¦orç­†é›»ï¼Œéœ€è¦å¯ä»¥ä½¿ç”¨SSHæŒ‡ä»¤ã€‚  Remote Server: ç•¶ä½œè·³æ¿çš„æ©Ÿå™¨ï¼Œéœ€è¦æœ‰SSH Serveræœå‹™ï¼Œä¸”å¿…é ˆä½æ–¼å…¬å¸ç¶²è·¯ä¹‹å¤–ï¼ŒClientå¿…é ˆé€£å¾—åˆ°å®ƒã€‚  Web Server: è¦é€£ç·šçš„Application Serverã€‚Step  åœ¨Clientä¸ŠConsoleåŸ·è¡ŒLocal Tunnelã€‚    $ ssh -NfL 80:&amp;lt;web server&amp;gt;:80  &amp;lt;Remote Server User&amp;gt;@&amp;lt;Remote Server IP&amp;gt;        åœ¨Clientç«¯æª¢æŸ¥æ˜¯å¦æœ‰æˆåŠŸå»ºç«‹èµ·Tunnel    $ netstat -plnt $ ps -ef | grep ssh        æ¥ä¸‹ä¾†å°±å¯ä»¥é€éClientä¸Šçš„ç€è¦½å™¨é€£åˆ°ç¶²ç«™(è¼¸å…¥http://localhost)    #é™¤äº†ç€è¦½å™¨ä¹‹å¤–ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨curlæ¸¬è©¦$ curl http://localhost        å¦‚æœè¦é—œæ‰Tunnelï¼Œåªéœ€è¦åœ¨Clientä¸Šé¢åŸ·è¡Œä»¥ä¸‹æŒ‡ä»¤ï¼š    $ ps -ef | grep ssh$ kill &amp;lt;ssh tunnel é‚£æ¢æœå‹™çš„PID&amp;gt;      èªªæ˜åœ¨é€™å€‹æƒ…å¢ƒä¸­ï¼Œç•¶Clientæ”¶åˆ°è¦é€šå¾€localhost:80çš„Requestæ™‚ï¼Œå°±æœƒå°‡å®ƒä¸Ÿåˆ°SSH Tunnelå‚³é€çµ¦Remote Serverï¼ŒRemote Serveræ”¶åˆ°å¾Œå†æŠŠå®ƒä¸Ÿåˆ°&amp;lt;web server&amp;gt;:80ï¼Œå°åŒ…å›ä¾†å¾—æ™‚å€™ä¹Ÿæ˜¯ä¸€æ¨£ï¼Œåªæ˜¯é †åºåéä¾†ã€‚é€™é‚Šéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœæ˜¯è¦Redirect 443 portï¼Œå¯èƒ½æœƒå› ç‚ºæ†‘è­‰è¢«æ›æ‰è€Œå°è‡´æ†‘è­‰éŒ¯èª¤ï¼Œå› æ­¤é€™ç¨®æƒ…å¢ƒä¸å¤ªå»ºè­°ä½¿ç”¨åœ¨æœ‰TLSåŠ å¯†çš„Web Serverï¼Œç´”ç²¹æ‹¿ä¾†æ¸¬è©¦å°±å¥½ã€‚å¦å¤–å¦‚æœWeb Serveræ˜¯åœ¨Load Balancerå¾Œé¢ï¼Œé‚£é€™æ¨£å¯èƒ½ä¹Ÿæœƒå°è‡´Local Tunnelç„¡æ³•æˆåŠŸï¼Œé€™é‚Šä¸å¤ªç¢ºå®šç‚ºä»€éº¼ï¼Œæœ‰å¯èƒ½æ˜¯å› ç‚ºå°åˆ°å¾Œé¢å¾Œï¼ŒIPå°±ä¸æ˜¯åŸæœ¬è¨­å®šTunnelçš„é‚£å€‹Web Server IPï¼Œå› æ­¤æµé‡å°±ä¸æœƒæ­£å¸¸çš„èµ°SSH Tunnelã€‚Remote TunnelRemote Tunnelæ˜¯æˆ‘æ¯”è¼ƒå¸¸ç”¨çš„Tunnelæ–¹å¼ï¼Œå› ç‚ºå¯ä»¥é”åˆ°é¡ä¼¼æ–¼VPNçš„åŠŸèƒ½ï¼Œä¾†å­˜å–å…§ç¶²çš„æœå‹™ï¼Œå¯ä»¥æ‡‰ç”¨åœ¨å¾ˆå¤šç¨®æƒ…å¢ƒä¸Šã€‚Remote Tunnelæ˜¯æŒ‡å¾Remoteç«¯(Remote Serverç«¯)ï¼Œå°‡ç‰¹å®šæœå‹™çš„æµé‡é€éSSHå‚³å›çµ¦Clientç«¯ä¸Šçš„æœå‹™ã€‚æŒ‡ä»¤(æ­¤æŒ‡ä»¤éœ€åœ¨Clientä¸ŠåŸ·è¡Œ)ï¼š$ ssh -NfR &amp;lt;remote listening IP&amp;gt;:&amp;lt;remote listening port&amp;gt;:&amp;lt;client listening ip&amp;gt;:&amp;lt;client listening port&amp;gt; &amp;lt;Remote Server&amp;gt;# Example$ ssh -NfR localhost:1234:localhost:80 user@&amp;lt;remote server ip&amp;gt;  -N ä»£è¡¨ä¸è¦é–‹èµ·shell codeæ¨¡å¼-f ä»£è¡¨åœ¨èƒŒæ™¯åŸ·è¡Œ-R ä»£è¡¨Remote Tunnel&amp;lt;remote listening IP&amp;gt; è¦åœ¨Remote Serverä¸Šç›£è½çš„IP&amp;lt;remote listening port&amp;gt; è¦åœ¨Remote Serverä¸Šç›£è½çš„Portï¼Œå¯è‡ªè¡Œå®šç¾©ã€‚&amp;lt;client listening ip&amp;gt; Clientä¸Šé¢æœå‹™ç›£è½çš„IP&amp;lt;client listening port&amp;gt; Clientä¸Šé¢æœå‹™porté€™æ®µæŒ‡ä»¤æ„æ€æ˜¯ä»»ä½•é€åˆ°Remote Serverä¸Š&amp;lt;remote listening IP&amp;gt;:&amp;lt;remote listening port&amp;gt;çš„Requestï¼ŒRemote Serveréƒ½æœƒå°‡ä»–é€éSSH Tunnelå‚³é€åˆ°çµ¦Clientï¼ŒClientå†å°‡Requestä¸Ÿçµ¦è‡ªå·±çš„&amp;lt;client listening ip&amp;gt;:&amp;lt;client listening port&amp;gt;æœå‹™ã€‚å¤–éƒ¨ä¸»æ©Ÿ --SSH--&amp;gt; Remote Server &amp;lt;--SSH Tunnel--&amp;gt; Client  è«‹æ³¨æ„é€™é‚Šçš„&amp;lt;remote listening  port&amp;gt;è·Ÿ&amp;lt;client listening port&amp;gt;èˆ‡SSHæœå‹™ä½¿ç”¨åˆ°çš„Portå®Œå…¨æ²’æœ‰ä»»ä½•é—œä¿‚ï¼Œé è¨­SSH Serverä½¿ç”¨çš„Porté‚„æ˜¯22ï¼Œç„¶å¾ŒClientç«¯æ˜¯äº‚æ•¸ç”¢ç”Ÿã€‚å¦‚æœRemote Serverçš„SSH Portä¸æ˜¯22çš„è©±ï¼Œé‚£å°±å¿…é ˆåœ¨æŒ‡ä»¤å¾Œé¢åŠ ä¸Š -p &amp;lt;port number&amp;gt;  Example:ssh -NfR localhost:1234:localhost:80 user@&amp;lt;remote server ip&amp;gt; -p 3000  é€™é‚Šéœ€è¦æ³¨æ„çš„æ˜¯&amp;lt;remote listening IP&amp;gt;å¯ä»¥æ‰“ä¹Ÿå¯ä»¥ä¸æ‰“ï¼Œé è¨­æ˜¯localhost(127.0.0.1)ï¼Œå¦‚æœè¦ç›£è½åœ¨ä¸åŒçš„IPï¼Œéœ€è¦é‡å°sshd_configåšè¨­å®šï¼Œåœ¨ç¨å¾Œæœƒåšèªªæ˜ã€‚ä¸€èˆ¬æƒ…å¢ƒå…¬å¸çš„PCæ˜¯åœ¨å…§ç¶²è£¡é¢ï¼Œä¸”æ˜¯è™›æ“¬IPï¼Œæœ‰æ²’æœ‰è¾¦æ³•ä¸é€éVPNï¼Œå¾å…¬å¸å¤–é¢SSHé€£å›ä¾†è‡ªå·±çš„PCï¼Ÿorå…¬å¸çš„é˜²ç«ç‰†æ“‹æ‰å¤–å°å…§çš„é€£ç·šï¼Œå› æ­¤æ²’è¾¦æ³•å¾å¤–éƒ¨é€éSSHé€£å›å…¬å¸è£¡è‡ªå·±å»ºç½®çš„SSH Serverï¼Œæ˜¯å¦æœ‰è¾¦æ³•ä¸é€éVPNï¼Œå¾å…¬å¸å¤–é¢SSHé€£å›ä¾†SSH Serverï¼Ÿè§’è‰²:  Client: å…¬å¸å…§éƒ¨çš„ä¸»æ©Ÿï¼Œä¹Ÿå°±æ˜¯å¸Œæœ›èƒ½å¾å…¬å¸å¤–éƒ¨é€éSSHé€£å›çš„SSH Serverï¼Œéœ€è¦å¯ä»¥ä½¿ç”¨SSHæŒ‡ä»¤ã€‚  Remote Server: ç•¶ä½œè·³æ¿çš„æ©Ÿå™¨ï¼Œéœ€è¦æœ‰SSH Serveræœå‹™ï¼Œä¸”å¿…é ˆä½æ–¼å…¬å¸ç¶²è·¯ä¹‹å¤–ï¼ŒClientè¦èƒ½é€£å¾—åˆ°å®ƒã€‚  å¤–éƒ¨é›»è…¦: ä½æ–¼å…¬å¸å¤–éƒ¨çš„é›»è…¦ï¼Œå¿…é ˆèƒ½é€£å¾—åˆ°Remote Serverã€‚Step  åœ¨Clientç«¯åŸ·è¡ŒRemote SSH Tunnelã€‚    $ ssh -NfR 1234:localhost:22  &amp;lt;Remote Server User&amp;gt;@&amp;lt;Remote Server IP&amp;gt;            åœ¨Remote Serverç«¯ä»¥åŠClientç«¯æª¢æŸ¥æ˜¯å¦æœ‰æˆåŠŸå»ºç«‹èµ·Tunnel    Client     ps -ef | grep ssh        Remote Server     netstat -plnt         æ¥ä¸‹ä¾†å…ˆé€éå¤–éƒ¨é›»è…¦é€£åˆ°Remote Serverã€‚    # åœ¨å¤–éƒ¨é›»è…¦ä¸ŠåŸ·è¡Œ$ ssh &amp;lt;Remote Server User&amp;gt;@&amp;lt;Remote Server IP&amp;gt;        é€éRemote Serveråå‘é€£å›Clientã€‚    # åœ¨Remote Serverä¸ŠåŸ·è¡Œ$ ssh localhost -p 1234        å¦‚æœè¦é—œæ‰Tunnelï¼Œåªéœ€è¦åœ¨Clientä¸Šé¢åŸ·è¡Œä»¥ä¸‹æŒ‡ä»¤ï¼š    $ ps -ef | grep ssh$ kill &amp;lt;ssh tunnel é‚£æ¢æœå‹™çš„PID&amp;gt;      èªªæ˜åœ¨é€™å€‹æƒ…å¢ƒä¸­ï¼Œä¸»è¦æ˜¯å…ˆåœ¨Clienté–‹å•ŸRemote Tunnelï¼Œç„¶å¾ŒRemote Tunnelæœƒåœ¨Remote Serverä¸Šç›£è½1234 portï¼Œç•¶æœ‰Requestå¾1234 portä¾†çš„è©±ï¼ŒRemote Serverå°±æœƒé€éSSHè½‰é€å›Clientï¼ŒClientæ”¶åˆ°å¾Œå†å°‡é€™å€‹Requestè½‰é€çµ¦è‡ªå·±çš„22 Portã€‚è¨­å®šè®“å¤–éƒ¨èƒ½å­˜å–SSH Tunnelé è¨­SSH Tunnelæ˜¯ä¸èƒ½ç›£è½åœ¨localhostä»¥å¤–çš„IPï¼Œå› æ­¤æ¯æ¬¡ä½¿ç”¨Remote Tunnelå°±ä¸€å®šè¦å…ˆé€£åˆ°Remote Serveræ‰èƒ½åé€£å›å»ï¼Œé€™æ¨£ä¸å¤ªæ–¹ä¾¿ï¼Œå› æ­¤æˆ‘å€‘å¯ä»¥åœ¨SSH Serverä¸Šé¢å…è¨±SSH Tunnelå¯ä»¥ç›£è½åœ¨å…¶ä»–Portã€‚  åˆ°Remote Serverä¸Šé–‹å•Ÿsshd_config    $ vim /etc/ssh/sshd_config        æ‰¾åˆ°GatewayPortsé¸é …ä¸¦è¨­æˆyesï¼Œå¦‚æœæ²’æœ‰é€™å€‹é¸é …å¯ä»¥è‡ªå·±åŠ ä¸Šå»ã€‚    GatewayPorts yes        é‡å•ŸSSHæœå‹™    $ systemctl restart sshd.service        é€™æ¨£å°±å¯ä»¥å°‡SSH Tunnelç›£è½åœ¨ä»»ä½•IPä¸Š    # Local Tunnel$ ssh -NfL 0.0.0.0:1234:&amp;lt;web server ip&amp;gt;:80 user@&amp;lt;remote server ip&amp;gt;$ ssh -NfL xx.xx.xx.xx:1234:&amp;lt;web server ip&amp;gt;:80 user@&amp;lt;remote server ip&amp;gt;...# Remote Tunnel$ ssh -NfR 0.0.0.0:1234:localhost:80 user@&amp;lt;remote server ip&amp;gt;$ ssh -NfR xx.xx.xx.xx:1234:localhost:80 user@&amp;lt;remote server ip&amp;gt;...      è¨­å®šå¤–éƒ¨èƒ½å­˜å–å¾Œï¼Œå°±å¯ä»¥çµåˆå„å¼å„æ¨£çš„æ‡‰ç”¨ï¼Œä¾‹å¦‚ï¼šReverse Proxyé€éRemote Serveråå‘é€£å›å…¬å¸PCä¸Šçš„Web Serverã€‚$ ssh -NfR 0.0.0.0:80:localhost:80 user@&amp;lt;remote server ip&amp;gt;å¦‚æ­¤ä¸€ä¾†ä¸éœ€è¦é€£åˆ°Remote Serverï¼Œåªè¦åœ¨ä»»ä½•èƒ½å­˜å–åˆ°Remote Serverçš„ä¸»æ©Ÿä½¿ç”¨ç€è¦½å™¨é€£http://&amp;lt;remote server ip&amp;gt;æˆ–æ˜¯åŸ·è¡Œcurl http://&amp;lt;remote server ip&amp;gt;å°±å¯ä»¥é€£åˆ°å…¬å¸çš„web serverã€‚RDPé€éRemote Serveråå‘é€£å›å…¬å¸PCä¸Šçš„é ç«¯æ¡Œé¢æœå‹™ã€‚$ ssh -NfR 0.0.0.0:3389:localhost:3389 user@&amp;lt;remote server ip&amp;gt;å¦‚æ­¤ä¸€ä¾†ä¸éœ€è¦é€£åˆ°Remote Serverï¼Œåªè¦åœ¨ä»»ä½•èƒ½å­˜å–åˆ°Remote Serverçš„ä¸»æ©Ÿä¸Šä½¿ç”¨é ç«¯æ¡Œé¢é€£åˆ°&amp;lt;remote server ip&amp;gt;:3389ï¼Œå°±å¯åå‘é€£åˆ°å…¬å¸PCä¸Šçš„é ç«¯æ¡Œé¢æœå‹™ã€‚  é€™é‚Šéƒ½åªæœ‰ä½¿ç”¨Remote Tunnelä¾†ç•¶ä½œç¯„ä¾‹ï¼Œä½†æ˜¯å…¶å¯¦Local Tunnelä¹Ÿå¯ä»¥æŠŠ&amp;lt;local listening IP&amp;gt;è¨­å®šæˆç›£è½ä»»ä½•IPï¼Œåªæ˜¯ç›®å‰æ¯”è¼ƒå°‘ç¢°åˆ°éœ€è¦æŠŠLocal Tunnelé–‹æ”¾å¤–éƒ¨å­˜å–é€™ç¨®æƒ…æ³ï¼Œå› æ­¤é€™è£¡å°±ä¸ç‰¹åˆ¥é—¡è¿°ï¼Œæœ‰èˆˆè¶£å¯ä»¥è‡ªè¡Œæ¸¬è©¦çœ‹çœ‹ã€‚å¦‚ä½•é˜²æ­¢SSH TunnelSSH Tunnelé˜²ç¯„çš„æ–¹æ³•æœ‰å¾ˆå¤šï¼Œé€™é‚Šç›®å‰å…ˆåˆ—å‡ºå¹¾ç¨®æ¯”è¼ƒå¸¸è½åˆ°çš„ï¼Œä¹‹å¾Œå¦‚æœé‚„æœ‰å­¸ç¿’åˆ°åˆ¥çš„æ–¹æ³•å†è£œå……ä¸Šä¾†ã€‚  SSH Serveré—œé–‰SSH Tunnelæœå‹™ï¼Œé–‹å•Ÿsshd_configè¨­å®šAllowTcpForwarding noã€‚é€™æ¨£å¯ä»¥é˜²æ­¢åˆ¥äººç”¨ä½ çš„SSH Serverç•¶SSH Tunnelè·³æ¿æ©Ÿã€‚  åœ¨é˜²ç«ç‰†ç›´æ¥æ“‹æ‰SSHæœå‹™ï¼Œä¸ç®¡å…§å°å¤–ï¼Œå¤–å°å…§éƒ½æ“‹ã€‚(æ›¾ç¶“çœŸçš„æœ‰é‡åˆ°é¡ä¼¼çš„æ¡ˆä¾‹ï¼Œåªæ˜¯æ˜¯é™åˆ¶ç‰¹å®šçš„ä¸»æ©Ÿï¼Œä¾‹å¦‚çµ¦guestä½¿ç”¨çš„æˆ–æ˜¯ä¸€äº›éè³‡è¨ŠæŠ€è¡“ç›¸é—œçš„End Userç”¨çš„ï¼Œä¸¦ä¸æ˜¯çœŸçš„å…¨å…¬å¸çš„ä¸»æ©Ÿéƒ½æ“‹)ã€‚  ä½¿ç”¨ä¸€äº›ç«¯é»å®‰å…¨é˜²è­·çš„ç”¢å“ç›´æ¥ç¦æ­¢å®¢æˆ¶ä½¿ç”¨SSH TunnelæŒ‡ä»¤æˆ–æ˜¯SIEMç”¢å“å»traceå“ªå€‹ä½¿ç”¨è€…ä½¿ç”¨äº†Tunnelã€‚åƒè€ƒè³‡æ–™  SSH Tunnel - Local and Remote Port Forwarding Explained With Examples - https://blog.trackets.com/2014/05/17/ssh-tunnel-local-and-remote-port-forwarding-explained-with-examples.html  How to make ssh tunnel open to public? - https://superuser.com/questions/588591/how-to-make-ssh-tunnel-open-to-public  Securing Your SSH Server - http://download.asperasoft.com/download/docs/proxy/1.4.0/admin_linux/webhelp/dita/securing_ssh_server.html  æ–‡ç« å…§å®¹çš„è½‰è¼‰ã€é‡è£½ã€ç™¼ä½ˆï¼Œè«‹è¨»æ˜å‡ºè™•: https://pohsienshih.github.io"
  }
  
]

